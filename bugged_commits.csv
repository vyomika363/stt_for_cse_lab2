Hash,Message,Hashes of parents,Is it merge,Modified files list
f571b19d8a5fd3a19fdf679421fd55a8edbf5295,"sqlerrors() decorator catching and returning useful errors

Closes #8",de04d7a854d71003ffcf98028eab976a936c2dba,False,app.py
6a0c5de6154893eb4269dc7b1f160726ec6395f2,"ensure_build_metadata() function for metadata

This will be run at compile time - the goal is to generate a build-
metadata.json file with a bunch of useful facts about the databases that could
be expensive to generate at run-time.

Example metadata:

    {
        ""flights"": {
        ""file"": ""flights.db"",
        ""tables"": {
            ""airlines"": 6048,
            ""airports"": 8107,
            ""routes"": 67663
        },
        ""hash"": ""07d1283e07786b1235bb7041ea445ae103d1571565580a29eab0203c555725fd""
    }

So far we have a sha256 hash of the database file itself, plus a row count for
each table.

Fixes #11",f571b19d8a5fd3a19fdf679421fd55a8edbf5295,False,.gitignore;app.py;templates/index.html
b2372605d63248f422b6e67cb5c392236a3aa612,"Implemented multi-db support plus initial URL structure

Refs #24

Fixes #15",6a0c5de6154893eb4269dc7b1f160726ec6395f2,False,.gitignore;app.py;templates/database.html;templates/index.html;templates/table.html
12f7e1dc5624d14f644abead18bd90b420b6d97e,"Hashed URLs now have far-future cache expiry

Since the URL now includes a hash of the database, we can return a Cache-
Control: max-age=31536000 header for every response.

The exception is our 302 redirects. These we now serve with a Link: header
that tells any HTTP/2 server-push aware fronting proxies (such as Cloudfront)
to push the target of the redirect.

Closes #4",9d219140694551453bfa528e0624919eb065f9d6,False,app.py
b20d7119e4f6506cdb9d5d11322e28130823adfd,Implemented template inheritance and brought back errors,0fa177269767e5e55c863382333fde627d2b7074,False,app.py;templates/base.html;templates/database.html;templates/index.html;templates/table.html
f643f7aee1b3d29df82b93a6560887a35b7a2f13,"base64 encode bytestrings from DB in JSON

Fixes #29",b46e370ee6126aa2fa85cf789a31da38aed98496,False,app.py;test_helpers.py
02b1814fcfdc61b1b69b5955f2b60252ff10cde9,"Redirects now preserve query string

Fixes #28",5f806880c9766daf09fc9535171637ebb8224cab,False,app.py
4c7379a898df426af0c31159e5cb06d672189301,"Don't crash on weird character encodings

Expecting SQLite columns to all be valid utf8 doesn't work, because we are
deailing with all kinds of databases. Instead, we now use the 'replace'
encoding mode to replace any non-UTF8 characters with a [X] character.",c371f06fdea413cfb00aa8f81b7a5535a7ecdbc4,False,app.py
2c625e31ed018f929223918240603bf2a80e665c,"Fixed bug on Row page with tables containing spaces

We were attempting to run this SQL:

    select * from ""Order%20Details"" where ...

On this page:

    http://0.0.0.0:8877/northwind-40d049b/Order%20Details/10250,41",1592fd0419f374de201926d3ba67fbf1522eed13,False,datasite/app.py
186c513a61a091b9f83d788e25b08f41a84ed9a3,"Support parameterized SQL and block potentially harmful queries

You can now call arbitrary SQL like this:

    /flights?sql=select%20*%20from%20airports%20where%20country%20like%20:c&c=iceland

Unescaped, those querystring params look like this:

    sql = select * from airports where country like :c
    c = iceland

So SQL can be constructed with named parameters embedded in it, which will
then be read from the querystring and correctly escaped.

This means we can aggressively filter the SQL parameter for potentially
dangerous syntax. For the moment we enforce that it starts with a SELECT
statement and we ban the sequence ""pragma"" from it entirely.

If you need to use pragma in a query, you can use the new named parameter
mechanism.

Fixes #39",31b21f5c5e15fc3acab7fabb170c1da71dc3c98c,False,datasite/app.py;test_helpers.py
9e9e9613907b6a2a8a051fdda93c0d26344ee110,Fixed error in RowView,25c241fa5a0f8868e3c1bc5be4f5888caa47d864,False,immutabase/app.py
abb591d83264bbf11a5eb9daf03011d051e8f833,"Added --reload argument to 'immutabase serve' command

Uses hupper to restart the server when the code changes. Useful for development.

Depends on https://pypi.python.org/pypi/hupper",8af7bc100c681975894f49f4ffd6d26a06e93f60,False,immutabase/cli.py;setup.py
bc9871c93583f3cdcca191b7fa05b255be7275c8,"gt/lt/gte/lte now treat numeric arguments as numeric

This now works:

    https://immutabase-dlmggyoepw.now.sh/northwind-40d049b/Products?UnitsInStock__gt=100

Previously the input value of 100 would be treated as a string.

Also fixed a bug where filter arguments had stopped working entirely.

Refs #23",d9fa2bf7ba2f9d3dcb2beb303f772c86344b4bcf,False,immutabase/app.py
e9fce441956642bef3548e3181d72a88317efa65,Don't serve cache headers in debug or refresh modes,a8a293cd71f7529aff374be5ca01f2ebd5e71ee4,False,datasette/app.py;datasette/cli.py
3280972c891633c6015fa55bbfd094420b4f0233,"Fixed tests I broke earlier

Broke these tests in 21c9c04310dffcdb8cf6fee0f74fc9e7ac1ecf19",3863a30b5d18204b4c77518f1880a1f705e929db,False,tests/test_utils.py
b51836f8463ef65bc947f0a7b6e60167cb7154cf,"Fixed bug with tables with spaces in their name

The new database index page was erroring.",59580d02da80eb963d5bce897c539c6489042025,False,datasette/app.py
666aa032530189d585dd61d0e9851e9fe63ee598,"Improved error handling

Invalid SQL now shows a special error.html template, and is covered by tests.",ff2ab9dc7d82f70daae10f5b0cde87d74704f910,False,datasette/app.py;datasette/templates/base.html;datasette/templates/error.html;tests/test_app.py
efecae5a11617eb576d475192384339fcdb03189,"Full path to database now works

e.g. datasette /tmp/blah.db

Previously this failed because it did not open with full path.",db3fa4abfac366184e97fb313b36d3429e5b937a,False,datasette/app.py
ff2fb573cd8773206a6df83229620928056e2ee2,"datasette publish --name=now-accepts-name

Fixes #72",2bbe9ca34a701191e3bf4e97943b7503a50ab548,False,datasette/cli.py
8252e71da461c425e625e1c3e4ee0bd92ea4cbf0,"Limit on max rows returned, controlled by --max_returned_rows option

If someone executes 'select * from table' against a table with a million rows
in it, we could run into problems: just serializing that much data as JSON is
likely to lock up the server.

Solution: we now have a hard limit on the maximum number of rows that can be
returned by a query. If that limit is exceeded, the server will return a
`""truncated"": true` field in the JSON.

This limit can be optionally controlled by the new `--max_returned_rows`
option. Setting that option to 0 disables the limit entirely.

Closes #69",6b3b05b6db0d2a7b7cec8b8dbb4ddc5e12a376b2,False,README.md;datasette/app.py;datasette/cli.py;datasette/templates/database.html;datasette/templates/error.html;tests/test_app.py
44a199a0625b695492b2a8605030dc61191f39cb,"Stop using sqlite WITH RECURSIVE in our tests

The version of Python 3 running in Travis CI doesn't support this.",d75f423b6fcfc074b7c6f8f7679da8876f181edd,False,tests/test_app.py
bdfb6d4f1359e98e127a3514248fd19b27b574e9,Fixed package output example,06a826c3188af82f27bb6b4e09cc89b782d30bd6,False,README.md
50e817801f90d07468ea394ef562d55d8940d124,"Fixed #83

Turns out we had a redirect bug as well.",bdfb6d4f1359e98e127a3514248fd19b27b574e9,False,datasette/app.py;tests/test_app.py
075d422c0a1c70259188dfbd940538c67419694a,Fixed typo,98ae6d6a4085d67a62c129e69e2a9a611f26502d,False,README.md
f45ca30f91b92ac68adaba893bf034f13ec61ced,"Fixed bug with datasette package --metadata

Closes #84",ea183b2ae3d557a370628e236fe606717c704e2a,False,datasette/utils.py
5d8084a28578da2aefa79ad81df9d82e2c265666,"Added a UI for editing named parameters

Fixes #96",9f47b6e4d80f0f393cf0167a6f48280de6847d1d,False,datasette/app.py;datasette/static/app.css;datasette/templates/database.html
82261a638bd35c9d69a9582a898cf4dab374f76c,"Turn on auto-escaping in Jinja

We had XSS holes! Since we don't do cookies or authentication
they shouldn't cause any actual harm, but still really not good.

https://github.com/pallets/jinja/issues/528",a4af532a31ece7095d710a1f5abb39ea93fe003f,False,datasette/app.py
9199945a1bcec4852e1cb866eb3642614dd32a48,"Fixed 500 on views page

Bug introduced in a4af532a31ece7095d710a1f5abb39ea93fe003f

Refs 85",82261a638bd35c9d69a9582a898cf4dab374f76c,False,datasette/app.py
e6ca88588395a9b8266c0e14121668990d34ff67,"Added initial docs, including a changelog

Docs initialized using this helpful guide:

http://docs.readthedocs.io/en/latest/getting_started.html

I used https://pypi.python.org/pypi/gitchangelog to kick-start the changelog.

Closes #99

Refs #109",9199945a1bcec4852e1cb866eb3642614dd32a48,False,docs/.gitignore;docs/Makefile;docs/changelog.rst;docs/conf.py;docs/index.rst
01e0c3fa18cd0dd7970e208790ffd683a420c924,"Fixed &nbsp; bug

&nbsp; was showing for all None values in table cells, thanks to the
autoescaping change introduced in 82261a638bd35c9",228bce83a37b4bee633f674b802aee13fe5b2f44,False,datasette/templates/table.html
51bdd67691bd69082ae7690af8b905f06050ee80,Changelog for 0.12 release,01e0c3fa18cd0dd7970e208790ffd683a420c924,False,docs/changelog.rst
a9138f044a4d73256c2244243d4e2908d77d218e,Added date to most recent changelog entry,51bdd67691bd69082ae7690af8b905f06050ee80,False,docs/changelog.rst
b9af49be6c68d6e551c1ae23132711f22cb7c63c,"Fix case for Sanic dependency

On PyPI it has a capital letter: https://pypi.python.org/pypi/Sanic

I think this is why the list of ""Requires Distributions"" on https://pypi.python.org/pypi/datasette links to all of the other dependencies but does not link to Sanic.",8b4c600d98b85655b3a1454ebf64f858b5fe54c8,False,setup.py
03572ae35573c2ea802a540624ce116f540ba1ac,"Allow --load-extension to be set via environment variable

I tesed this by first building and running a container using the new
Dockerfile from #114:

    docker build .
    docker run -it -p 8001:8001 6c9ca7e29181 /bin/sh

Then I ran this inside the container itself:

    apt update && apt-get install wget -y \
        && wget http://www.gaia-gis.it/spatialite-2.3.1/test-2.3.sqlite.gz \
        && gunzip test-2.3.sqlite.gz \
        && mv test-2.3.sqlite test23.sqlite \
        && datasette -h 0.0.0.0 test23.sqlite

I visited this URL to confirm I got an error due to spatialite not being
loaded:

http://localhost:8001/test23-c88bc35?sql=select+ST_AsText%28Geometry%29+from+HighWays+limit+1

Then I checked that loading it with `--load-extension` worked correctly:

    datasette -h 0.0.0.0 test23.sqlite \
        --load-extension=/usr/lib/x86_64-linux-gnu/mod_spatialite.so

Then, finally, I tested it with the new environment variable option:

    SQLITE_EXTENSIONS=/usr/lib/x86_64-linux-gnu/mod_spatialite.so \
        datasette -h 0.0.0.0 test23.sqlite

Running it with an invalid environment variable option shows an error:

    $ SQLITE_EXTENSIONS=/usr/lib/x86_64-linux-gnu/blah.so datasette \
        -h 0.0.0.0 test23.sqlite
    Usage: datasette -h [OPTIONS] [FILES]...

    Error: Invalid value for ""--load-extension"": Path ""/usr/lib/x86_64-linux-gnu/blah.so"" does not exist.

Closes #112",ed2b3f25beac720f14869350baacc5f62b065194,False,datasette/cli.py
e16ca1169cc49fbb5b0325564d248becad3a4b7f,"Refactored table column/row display logic

Simplified the template and made the way for upcoming foreign key work.

Refs #85

Also fixed &nbsp; bug on database page - closes #113",084350b0f1343d988928cae63cfedbeb6205e25e,False,datasette/app.py;datasette/templates/database.html;datasette/templates/table.html
45e502aace6cc1198cc5f9a04d61b4a1860a012b,"Added unit tests for inspect() foreign key detection

Used them to fix a bug with it.

Refs #85",e16ca1169cc49fbb5b0325564d248becad3a4b7f,False,datasette/utils.py;tests/test_inspect.py
0b702f3679a2ffd4e3efb5c34b9fe30221172ccb,"Fixed weird edge-case with foreign key detection

It turns out it is possible for a SQLite table to define a foreign key
relationship to a table that does not actually exist

We should still be able to handle these databases.",45e502aace6cc1198cc5f9a04d61b4a1860a012b,False,datasette/utils.py
7feb746efe8c5ed80f477475acc546370bae89e4,Fixed bug where 0 values were showing up blank,6d39429daa4655e3cf7a6a7671493292a20a30a1,False,datasette/templates/database.html
523c6f9e3a2cb9a9b5627ee2951147110e91d499,Fixed bug with FTS against tables with hyphens in the name,a5881e105a02830d26f07e98177248d5910893da,False,datasette/app.py
1f79be7e4e203c7d494df21224f77e6a83d63879,More error checking and docs,54d58ef690f6123415d3a250951946e4431ecfb0,False,datasette/cli.py
de42240afd1e3829fd21cbe77a89ab0eaab20d78,Some bug fixes.,75450abbe8c08526619798aef62133334c935ae9,False,datasette/cli.py;datasette/utils.py
fb505de11c882fa7f2522160509172561b5b8270,"Back-ported format strings for compatibility with Py 3.5

Also fixed a encoding error where Heroku --json return needs to be treated as UTF8",a9b9d427915adc133814a022e554f042d5d82d4d,False,datasette/cli.py;datasette/utils.py
f96e55bce55d26c4d5b198edc536e1b8e9bbea43,"Fix pytest version conflict

https://travis-ci.org/simonw/datasette/jobs/305929426

    pkg_resources.VersionConflict: (pytest 3.2.1 (/home/travis/virtualenv/python3.5.3/lib/python3.5/site-packages), 
    Requirement.parse('pytest==3.2.3'))",fa8eb0bf1b113ab17ede9cd107b7c3bd5cde39c3,False,setup.py
a30c5b220c15360d575e94b0e67f3255e120b916,"Fixed bug on rows page, added unit test

Rows page for rows that linked to the same table in more
than one columns were display incorrectly. Fixed that and added a test.

Also introduced /db/table/row-pk.json?_extras=foreign_key_tables

This is used by the new unit test, but is the first example of a new
?_extras=comma-separated-list pattern I am introducing.",77088876813fea833b6fc3eb588ecc9b02f0a7d7,False,datasette/app.py;tests/test_app.py
4b7596ee5caf68c9b1acd17866f88a57b23db3c4,"Row page now resolves foreign keys

Closes #132",a30c5b220c15360d575e94b0e67f3255e120b916,False,datasette/app.py;datasette/templates/_rows_and_columns.html;datasette/templates/row.html;datasette/templates/table.html
ab32bd64272886440c92c2fff846faa35b761158,"Fixed bug with params other than p0

p1 and upwards were not correctly extracted.",b45077839100a57adbc284ad5bf555002da819e8,False,datasette/app.py
e3dd2483bb78f3d4b80db6de5475ceb163155b80,Fixed quoting on foreign-key links to tables with spaces in name,c5c923d93c26f312b713b81c8d08db5c3279a23a,False,datasette/app.py
7ff51598c468deb1d2c0d4c23a808458c9b1e3a2,"git commit -m ""datasette --template-dir=mytemplates/"" argument

You can now pass an additional argument specifying a directory to look for
custom templates in.

Datasette will fall back on the default templates if a template is not
found in that directory.

Refs #12, #153",ffa77f62b46e1ddf2f848f5da10a1e958323a084,False,datasette/app.py;datasette/cli.py
1ecac1a4389b85f7acfad513bf6ab20899862d0b,Fix display of select boxes in Firefox,1feb5735dad538312fac8b76705c05516250967b,False,datasette/static/app.css
0cfd7ce59d9018eb07af8f9e20f7d04308c9d01d,"Allow WITH query (previously we required SELECT at start)

Fixes #161",e981ac7d4d1e1603257369eb5edba0fc4fdf5ae9,False,datasette/utils.py;tests/test_app.py;tests/test_utils.py
709f4f2798d0490ae048094536bed7e973ea29f4,"Fixed bug with detecting FTS tables

Closes #135",67ad77a307c7c264c68d768fa8290997e3b75e77,False,datasette/utils.py;tests/test_utils.py
52a5e95d21c9b2b7b50f5bc423e3746ae0538734,"Fixed bug with filter columns

Closes #162",709f4f2798d0490ae048094536bed7e973ea29f4,False,datasette/app.py;datasette/templates/table.html
198b8b2955b9d8a8a80ce850a92a99426c5f161f,"Fixed row page for tables with a primary key

Closes #152",52a5e95d21c9b2b7b50f5bc423e3746ae0538734,False,datasette/app.py
a2b954e82818d5aa4b4c313d9a687d6a7bdd04b5,Fixed #155,198b8b2955b9d8a8a80ce850a92a99426c5f161f,False,datasette/app.py
515eaa8ccba0603de5b14679b74402f3ddf02bd7,--reload now reloads on metadata changes too,32cf5a4a72c1c8d46dd302566fdcbf4793f2f927,False,datasette/cli.py
cbfd6b745eabf51295e5a5e0ea57a0f93d63b37d,"Publish should now work if /tmp is on different device

Fixes #141",9af2964f6fd4ae876ef8ecd2c14c2ffa61542fdb,False,datasette/utils.py;tests/test_utils.py
16dfccb1c569359fa2a03639ada233e7661156af,"Include sha1 hash in /static/app.css URL

This means that when Datasette's CSS changes the new CSS will be loaded
even though browsers may have cached the previous version.

Closes #154",446f4b832272b2286f6f65af19714eb64afb7aa6,False,datasette/app.py;datasette/templates/base.html
3459ab91665d956ff6a25f8e94dcb9c325dd10e5,Formatting fixes,c195ee4d46f2577b1943836a8270d84c8341d138,False,docs/custom_templates.rst
1c0d93c39b194103e729aed2496d2d24f5ad4850,Fix Python 3.5 test failure,b01304d7070df5a02870ebd204ea093f3742029e,False,datasette/app.py
3f2fed109395179de4145ca1a2675360f1717225,"Fixed bug with HTML labels

loop.counter is incorrect - loop.index outputs the correct loop value.",7126d08f10d637c9f1af346324f6f7c0fece8be4,False,datasette/templates/query.html
7a7e4b2ed8c76c6d002a9d707dbc840f6a2abf7f,"Started unit tests for row/table HTML pages

Refs #167

Thanks to the new tests, spotted and fixed a bug where pages that were
supposed to have 100 things on them were actually displaying 101.",3f2fed109395179de4145ca1a2675360f1717225,False,datasette/app.py;setup.py;tests/test_app.py
794c3bfcfc03087bbebffb7b228e81aaa8b72183,"Cleaned up row/column display logic, fixed bug

Closes #167",7a7e4b2ed8c76c6d002a9d707dbc840f6a2abf7f,False,datasette/app.py;tests/test_app.py
1aad396c9ef46837b224607086c09f48ac921165,"Fixed bug with .json path regular expression

I had a table called ""geojson"" and it caused an exception because the regex
was matching .json and not \.json",4f08fc092f59b434c11f77b6fb2d29b3255227e5,False,datasette/app.py
012fc7c5cd3e9160c9a4c19cc964253e97fb054a,Fix for FTS virtual table counting error,56623e48da5412b25fb39cc26b9c743b684dd968,False,datasette/app.py
31f63d1672a9214962cd7335a2daeabab7c0000e,"Fixed bug with keyset pagination over compound primary keys

Closes #190",89d9fbb91bfc0dd9091b34dbf3cf540ab849cc44,False,datasette/app.py;datasette/utils.py;tests/fixtures.py;tests/test_api.py;tests/test_utils.py
dd0566ff8eda7fa2f0d92e51809581fae62cffed,"Utility for writing test database fixtures to a .db file

	python tests/fixtures.py /tmp/hello.db

This is useful for making a SQLite database of the test fixtures for
interactive exploration.",8f0d44d6468a96e9b78487c36da20ddc2ae9d937,False,tests/fixtures.py
a87df963a08054ad7a652f0218e70ddb7f9cc8bd,"Error handling for ?_sort and ?_sort_desc

Verifies that they match an existing column, and only one or the other option
is provided - refs #189

Eses a new DatasetteError exception that closes #193",bfb19e3a178ba9b2dab2f90f90a398b54a73d34e,False,datasette/app.py;tests/test_api.py
c1d37fdf2be84fb07155bb1b1f61057444b03300,"Fixed bug with human filter description, refs #189

We were showing this:

    201 rows where sorted by sortable_with_nulls

We now show this:

    201 rows sorted by sortable_with_nulls",23e0fdb0f3196ffa4d8bc4944c8bc9cb0f89129b,False,datasette/templates/table.html;datasette/utils.py;tests/test_api.py
9f28bbe43dc277a3963a12aaae37b5ee3c277207,"Better mechanism for handling errors; 404s for missing table/database

New error mechanism closes #193

404s for missing tables/databesse closes #184

Makes pull request #202 unnecessary.",ad6142b67c8f137b001770339510979c5df43d85,False,datasette/app.py;datasette/templates/500.html;datasette/templates/base.html;datasette/templates/error.html;tests/test_api.py;tests/test_html.py
fb988ace7c7e2bee5ac142a0eab22431d0675a77,"Release 0.17 to fix issues with PyPI

See https://twitter.com/simonw/status/984862976447414272",b6539ff04502536bd1fa96e3b1430bdafc456826,False,datasette/version.py
1cc5161089e559c8b16049b20f7a5b3a43290c21,"Fix sqlite error when loading rows with no incoming FKs

This fixes `ERROR: conn=<sqlite3.Connection object at 0x10bbb9f10>, sql
= 'select ', params = {'id': '1'}` caused by an invalid query when
loading incoming FKs.

The error was ignored due to async but it still got printed to the
console.",ec6abc81e433c9bac1b9f085111785fc227e9e34,False,datasette/app.py
f2b940d6026677f6859d46a4f16fa402745d261d,"Link foreign keys which don't have labels

This renders unlabeled FKs as simple links. I can't see why this would
cause any major problems.

Also includes bonus fixes for two minor issues:

* In foreign key link hrefs the primary key was escaped using HTML
  escaping rather than URL escaping. This broke some non-integer PKs.
* Print tracebacks to console when handling 500 errors.",d72201e883c0612d14dfb8ffdd61aa0fe223d94a,False,datasette/app.py
efbb4e83374a2c795e436c72fa79f70da72309b8,"Return HTTP 405 on InvalidUsage rather than 500

This also stops it filling up the logs. This happens for HEAD requests
at the moment - which perhaps should be handled better, but that's a
different issue.",8d394586f55bc4b8ab70476968d08fb6ec8339e5,False,datasette/app.py
92396ae5bacedfcb3d7c81319ccdd04483fd7fd4,Better fix for setup.py version,33c7c53ff87c25445c68088ede49d062d9c31fe8,False,setup.py
2abe539a0f9f967ec0de6894774cb7ee83c4b3b9,Fixed #216 - paginate correctly when sorting by nullable column,1652a9707e325b387ab9550e78eefd48029be44f,False,datasette/app.py;tests/fixtures.py;tests/test_api.py
07fc2d113e462bfd8d7d56152c0d1fc55e0fdbe9,"Fix for _sort_desc=sortable_with_nulls test, refs #216",2abe539a0f9f967ec0de6894774cb7ee83c4b3b9,False,tests/test_api.py
5364fa7f3357f2de24fd45c85832205377642f19,"Revert #216 until I can get tests to pass in Travis

Revert ""Fix for _sort_desc=sortable_with_nulls test, refs #216""

This reverts commit 07fc2d113e462bfd8d7d56152c0d1fc55e0fdbe9.

Revert ""Fixed #216 - paginate correctly when sorting by nullable column""

This reverts commit 2abe539a0f9f967ec0de6894774cb7ee83c4b3b9.",07fc2d113e462bfd8d7d56152c0d1fc55e0fdbe9,False,datasette/app.py;tests/fixtures.py;tests/test_api.py
5ebc7137d736d8fa47b24cc799fb93909f49cabb,"Use application/octet-stream for downloadable databses

I'd also like to send the Content-Length here but that's not currently
possible in Sanic - see bug report here:

https://github.com/channelcat/sanic/issues/1194",1f384e662b58e2eb43ce20842976b677e4478f43,False,datasette/app.py
aaf59db570ab7688af72c08bb5bc1edc145e3e07,"Longer time limit for test_paginate_compound_keys

It was failing intermittently in Travis - see #209",5ebc7137d736d8fa47b24cc799fb93909f49cabb,False,tests/fixtures.py;tests/test_api.py
4586aa506a054d07e674cde8143a3008e6bc5d78,"Don't duplicate simple primary keys in the link column

When there's a simple (single-column) primary key, it looks weird to
duplicate it in the link column.

This change removes the second PK column and treats the link column as
if it were the PK column from a header/sorting perspective.",b231d4243d748facf1897e7756c2b578bb448edc,False,datasette/app.py
ca588b6a30e50212f6ac233121745a4216d878f9,Fixed example HTML in CSS docs,0bb483ca5bee61c9f7d148b5755d2eed56001aca,False,docs/custom_templates.rst
4be6deb94776744071311777f0b18efb993c0cfa,"Fix for plugins in Python 3.5 (#222)

ModuleNotFoundError is not a thing in Python 3.5, so catch KeyError/ImportError instead.",1c36d07dd432b9960f4f2d096739460b4fcf8877,False,datasette/app.py
1e4c29501289f7bc7b3b7daf60f1ddd9f66ee338,Fixed out-dated template in documentation,b52171db1e97e2be1ff2dc505ccf29107288b27b,False,docs/custom_templates.rst
a971718d2a5e1b61b5e5c27b0ef6c4ec65616e35,Fix a typo (#232),05bdf53358ec6ea81a7dce17290f3db0cd94d23d,False,README.md
f3f42957128c1e7ece584d45d9167f2ac003a3b8,"label_column now defined on the table-being-linked-to, fixes #234",f27cabbaf3d834f47bc6bea1de7e27c11fcfa5e7,False,datasette/app.py;tests/fixtures.py;tests/test_api.py;tests/test_html.py
4504d5160b2d86d4dae17b7c2f72bc3b02509c2c,"If max_returned_rows==page_size, increment max_returned_rows

Fixes #230, where if the two were equal pagination didn't work correctly.",02ee31c8b45b872fff91e2059c15a20532e2d035,False,datasette/app.py;tests/fixtures.py;tests/test_api.py
a4cc5dc81364a7300f0ba0bd5711633e803c250a,"New ?_shape=array option + tweaks to _shape, closes #245

* Default is now ?_shape=arrays (renamed from lists)
* New ?_shape=array returns an array of objects as the root object
* Changed ?_shape=object to return the object as the root
* Updated docs",2565d623af6222f3ed1c630f753b5f95ad749d49,False,datasette/app.py;docs/json_api.rst;tests/test_api.py
690736436bac599ca042d1caa465c6d66d2651f9,"Bump up time limit for test_paginate_tables_and_views

It was intermittently failing in Travis CI on Python 3.5:

https://travis-ci.org/simonw/datasette/jobs/373713476",349e262bb1c8f225cf86a5e8542253282809a0eb,False,tests/test_api.py
801381b7657dd084c11ac2fb6e3d0194cfaa3455,"Default tests to using a longer timelimit

Every now and then a test will fail in Travis CI on Python 3.5 because it hit
the default 20ms SQL time limit.

Test fixtures now default to a 200ms time limit, and we only use the 20ms time
limit for the specific test that tests query interruption. This should make
our tests on Python 3.5 in Travis much more stable.",1259b8ac0bb25fc8af61c1948e2cc16860dca7ff,False,tests/fixtures.py;tests/test_api.py
62c08d0d7197264af678c2f6e0c6403196217184,"Revert ""Travis should now deploy new tags to PyPI if tests pass""

This reverts commit d39b2e357e34469728f300273ab07c3904ea7a2b.

It failed with this error: https://travis-ci.org/simonw/datasette/jobs/375398977

	Uploading distributions to https://upload.pypi.org/legacy/
	Uploading datasette-0.21-py3-none-any.whl
	100% 182k/182k [00:00<00:00, 694kB/s]
	HTTPError: 403 Client Error: Invalid or non-existent authentication information. for url: https://upload.pypi.org/legacy/",403211de632cd15f0820cc9399305fc43c187b47,False,.travis.yml
4301a8f3ac69f2f54916e73cc90fcf216a9a3746,"Case insensitive querystring comparison, fix Python 3.5",eaaa3ea1498df0d4790f814e3d2f3fcc5ea28429,False,tests/test_html.py
ddef2298509e3027a44971a681ad7855bf07b51a,"Initial implementation of suggested facets

Causes tests to break at the moment",8a4ed052a5034d3f12daf5eedabb0808a0bf20fc,False,datasette/templates/table.html;datasette/views/table.py
514873c6295dcd467d806064a549e46b4ea3279a,Fix bug with toggle_url on integer facets,1dc94f6eaa98431da9c61e803e2b05b082f9c6e8,False,datasette/views/table.py
b263da78e329853ceea41c4ecabe7e8bb08d20a7,"Reliable sort order for facets in Python 3.5, fixing test - refs #255",062303419cef9bbf72927c4ac4efdb185829c03b,False,datasette/templates/table.html;datasette/views/table.py;tests/test_html.py
858d79fe938afbe04e2b249da71860e812869ec8,Typo fix,566f2d31d6f4950200b64424f6f9cfdd06343f4e,False,docs/facets.rst
08f4b7658fec97419eb34118a2cd5c8be805673f,"Show facets that timed out using new InterruptedError

If the user requests some _facet= options that do not successfully execute in
the configured facet_time_limit_ms, we now show a warning message like this:

    These facets timed out: rowid, Title

To build this I had to clean up our SQLite interrupted logic. We now raise a
custom InterruptedError exception when SQLite terminates due to exceeding a
time limit.

In implementing this I found and fixed a logic error where invalid SQL was
being generated in some cases for our faceting calculations but the resulting
sqlite3.OperationalError had been incorrectly captured and treated as a
timeout.

Refs #255
Closes #269",cef9a9a8701af86cc7df8b7939398185f0a76f5f,False,datasette/templates/table.html;datasette/utils.py;datasette/views/base.py;datasette/views/table.py
0b8e5981a37c0da75ce4f4e6b6b5275681e2e0c5,Typo fix,bd3353a31f930c2e504094d79513cadbade43cda,False,docs/introspection.rst
2bfd111d65c892e54b06c2c9498ce2b4cc3e67ff,"Faceting no longer breaks pagination, fixes #282",49f317752cfe89c5641165a490eef49e025752a7,False,datasette/views/table.py;tests/test_api.py
5d6252788230d168ba09f379d1d2af867e3302ab,0.22.1 bugfix release,2bfd111d65c892e54b06c2c9498ce2b4cc3e67ff,False,README.md;docs/changelog.rst
f98e62fe5ac48cd31362b7e2001b0262fa68ef3b,Fix for 500 error on /db?sql=x,b9b93583467986a72f34732fc87a201157ad83ea,False,datasette/views/base.py
df71e8cea87542aa7a7be84fabca0adc1177728d,Fixed documentation typo,37f8361c6f7b3eeaa351c0cd93b6db1fdd2744ab,False,docs/spatialite.rst
a4d6acc23943759b46fa90ec68e500016b933410,"Use scope='session' for all fixtures

This means they will only be executed once which makes sense
since the database they create is immutable.",76d11eb768e2f05f593c4d37a25280c0fcdf8fd6,False,tests/test_api.py;tests/test_html.py;tests/test_inspect.py
b0a95da96386ddf99816911e08df86178ffa9a89,"Show more useful error message for SQL interrupted, closes #142",98c8f0e7285fb58b7cbb38304e2ed4576774ad91,False,datasette/app.py;datasette/views/base.py;tests/test_html.py
1a8b0213e0152234b25f2777d5c6f61a41834c8a,Fixed broken test introduced in b0a95da96,27eff1809c21b7c1ae2ba33ebde1dac7f8bc8fbc,False,tests/test_api.py
d69ebce53385b7c6fafb85fdab3b136dbf3f332c,Fixed broken :ref:,1a8b0213e0152234b25f2777d5c6f61a41834c8a,False,docs/spatialite.rst
969771770fcf795daace72e2310804e699067cfe,"Upgrade pytest to 3.6.0

https://github.com/pytest-dev/pytest/issues/1875 made it impossible to declare
a function as a fixture multiple times, which we were doing across different
modules. The fix was to move our @pytest.fixture calls into decorators in the
tests/fixtures.py module.",16398641d95db7374fddccc79d0f08e4d4c96ee1,False,setup.py;tests/fixtures.py;tests/test_api.py;tests/test_html.py;tests/test_plugins.py
a80e1d50b9394feee267d76398b5ab249817156c,"Show error on 'datasette publish heroku --spatialite', refs #301",b18e4515855c3f1eeca3dfcccdbb6df05869084a,False,datasette/cli.py
9277c6236a8216450d4ebe3242ce6d56c1a7e437,Fixed tests I broke in b18e45158,7381af85e6e8a2aa13cb308d37ebfe7550dd7331,False,tests/test_utils.py
3a79ad98eafb9da527a3b9d9d8fbeb81936b02e7,"Basic CSV export, refs #266

Tables and custom SQL query results can now be exported as CSV.

The easiest way to do this is to use the .csv extension, e.g.

	/test_tables/facet_cities.csv

By default this is served as Content-Type: text/plain so you can see it in
your browser. If you want to download the file (using text/csv and with an
appropriate Content-Disposition: attachment header) you can do so like this:

	/test_tables/facet_cities.csv?_dl=1

We link to the CSV and downloadable CSV URLs from the table and query pages.

The links use ?_size=max and so by default will return 1,000 rows.

Also fixes #303 - table names ending in .json or .csv are now detected and
URLs are generated that look like this instead:

	/test_tables/table%2Fwith%2Fslashes.csv?_format=csv

The ?_format= option is available for everything else too, but we link to the
.csv / .json versions in most cases because they are aesthetically pleasing.",a246f476b4fe490f5450836b22961bc607e6b4b0,False,datasette/app.py;datasette/templates/query.html;datasette/templates/table.html;datasette/utils.py;datasette/views/base.py;datasette/views/index.py;datasette/views/special.py;datasette/views/table.py;tests/test_api.py;tests/test_csv.py;tests/test_html.py;tests/test_utils.py
5bda4a477c52b6d1cd7d0ca25382dbb20bda40ea,"Fixed CSV tests - Python 3.6.5 and 3.6.3 apparently differ

The test used to expect CSV to come back like this:

	hello
	world
	""""

With the final blank value encoded in quotes.

Judging by Travis failures, this behaviour changed between Python 3.6.3 and
3.6.5:

	https://travis-ci.org/simonw/datasette/jobs/392586661",3a79ad98eafb9da527a3b9d9d8fbeb81936b02e7,False,tests/test_csv.py
d0a578c0fc07b9d9208cd9de981bdf7385a26c49,"Switch back from python:3.6-slim-stretch to python:3.6

Turns out slim-stretch doesn't include gcc which means it can't build various
Sanic dependencies. So `datasette publish now ...` was broken.

Fixes #310",5bda4a477c52b6d1cd7d0ca25382dbb20bda40ea,False,datasette/utils.py
0357774c946b7a35871715d7fc23b3f04f519af8,Renamed test_tables.db to fixtures.db in unit tests,ed631e690b81e34fcaeaba1f16c9166f1c505990,False,tests/fixtures.py;tests/test_api.py;tests/test_csv.py;tests/test_html.py;tests/test_inspect.py;tests/test_plugins.py
6a32df334de1a7e3579879dd7ee073613be9b91b,"Improved fixtures to support publication

The fixtures database created by our unit tests makes for a good ""live"" demo
of Datasette in action.

I've improved the metadata it ships with to better support this use-case.

I've also improved the mechanism for writing out fixtures: you can do this:

	python tests/fixtures.py fixtures.db

To get just the fixtures database written out... or you can do this:

	python tests/fixtures.py fixtures.db fixtures.json

To get metadata which you can then serve like so:

	datasette fixtures.db -m fixtures.json

Refs #313",0357774c946b7a35871715d7fc23b3f04f519af8,False,tests/fixtures.py;tests/test_html.py
db1e6bc182d11f333e6addaa1a6be87625a4e12b,"--version-note for datasette, datasette publish and datasette package

This is a relatively obscure new command-line argument that helps solve the
problem of showing accurate version information in deployed instances of
Datasette even if they were deployed directly from source code.

You can pass --version-note to datasette publish and package and it will then
in turn be passed to datasette when it starts:

    datasette --version-note=hello fixtures.db

Now if you visit /-/versions.json you will see this:

    {
        ""datasette"": {
            ""note"": ""hello"",
            ""version"": ""0+unknown""
        },
        ""python"": {
            ""full"": ""3.6.5 (default, Jun  6 2018, 19:19:24) \n[GCC 6.3.0 20170516]"",
            ""version"": ""3.6.5""
        },
        ...
    }

I plan to use this in some Travis CI configuration, refs #313",538565de3a126a6aa1cdb4b4ba91135507411af0,False,README.md;datasette/app.py;datasette/cli.py;datasette/utils.py;tests/test_utils.py
f0c17229b7a7914d3da02e087dfd0e25d8321448,"Deploy latest.datasette.io on commit to master - #313

If the tests pass in Travis CI, deploy an instance containing Datasette's test
fixtures to https://latest.datasette.io/

Also set up an alias of truncated-commit-hash.datasette.io",db1e6bc182d11f333e6addaa1a6be87625a4e12b,False,.travis.yml
aeeb50f61b7b1bf8ccb61448f8b8253db457d350,"Correctly display facets with value of 0 - fixes #318

Also added comprehensive unit test for facet display HTML.",fdfbbbb9ee0d02fd4d43dfc42382252fa2287d6d,False,datasette/templates/table.html;tests/fixtures.py;tests/test_api.py;tests/test_csv.py;tests/test_html.py
3b53eea38267420bb78a2a604e23e5f816eccce2,"Fixed incorrect display of compound primary keys with foreign key references

Closes #319",3683a6b626b2e79f4dc9600d45853ca4ae8de11a,False,datasette/utils.py;tests/fixtures.py;tests/test_api.py;tests/test_html.py;tests/test_utils.py
dea86b9fba78e032ad09673e884e764387daf209,Changelog for 0.23.1,0104dccca9d04916a9a5ba03874c92d9a9704096,False,docs/changelog.rst
64c2fea8dfcecb06a3f9c674a96948e7366985fc,"CSV export now respects --cors, fixes #326",e7566cc59d4b02ef301054fd35fdde6c925a8e38,False,datasette/views/base.py;tests/fixtures.py;tests/test_csv.py
47e689a89b3f5f0969595b17d2ec59ea3caffb3b,"Speed up Travis by reusing pip wheel cache across builds (#324)

* Cache pip wheels between runs in Travis, refs #323
* Run pytest manually - ""python setup.py test"" appeared to still download a bunch of stuff: https://travis-ci.org/simonw/datasette/jobs/395306188

* Use extras_require so pip can install test dependencies: https://github.com/pypa/pip/issues/1197#issuecomment-228939212",64c2fea8dfcecb06a3f9c674a96948e7366985fc,False,.travis.yml;setup.py
d08faa89872d9ec8d3c8e76d85164ccd84596811,"Fix for weird nested exception in RequestTimeout

I saw this error:

    sanic.exceptions.RequestTimeout: Request Timeout

    During handling of the above exception, another exception occurred:

    Traceback (most recent call last):
      File ""/Users/simonw/Dropbox/Development/datasette/venv/lib/python3.6/site-packages/sanic/handlers.py"", line 82, in response
        response = handler(request=request, exception=exception)
      File ""/Users/simonw/Dropbox/Development/datasette/datasette/app.py"", line 512, in on_exception
        if request.path.split(""?"")[0].endswith("".json""):
    AttributeError: 'NoneType' object has no attribute 'path'

Strangely ""if request and request.path..."" did not work here, because the
Sanic Request class extends builtins.dict and hence evaluates to False if it
has no headers.",24af1004a42029f5a2f1a50541780814e9e2578a,False,datasette/app.py
6541ce633ebf56770106221b0984751270adb2c7,"Fix for row pages for tables with / in, closes #325",8ac71a61278d2d1b24ad3f3ab68048dac31467bc,False,datasette/views/base.py;datasette/views/table.py;tests/test_api.py;tests/test_html.py
2db2ae4f21d0ba5b84359f611da7b123262d92c7,"Show custom error message if SpatiaLite needed, closes #331",17863d108b9c8672b5e102d97858a96ca715a9d6,False,datasette/app.py
31a5d8fa77be68d4f837f0a80a611675dce49f4b,"Bump aiohttp to fix compatibility with Python 3.7

Tests failed here: https://travis-ci.org/simonw/datasette/jobs/403223333",130dc8823ebdcc1834fc7c4a03c996b13fc1e444,False,setup.py
6e37f091edec35e2706197489f54fff5d890c63c,"Support title/description for canned queries, closes #342

Demo here: https://latest.datasette.io/fixtures/neighborhood_search",58fec99ab0a31bcf25968f2aa05d37de8139b83c,False,datasette/app.py;datasette/templates/database.html;datasette/templates/query.html;datasette/views/base.py;datasette/views/database.py;datasette/views/table.py;docs/sql_queries.rst;tests/fixtures.py;tests/test_html.py
700d83d8adfeb3859ebc93828951e5048cb0e425,?_json_infinity=1 for handling Infinity/-Infinity - fixes #332,b320f58d13e510d51e07187c8a75db856205b88f,False,datasette/utils.py;datasette/views/base.py;docs/json_api.rst;tests/fixtures.py;tests/test_api.py
74ad3ff4af4ebb499b07c6ce984def7d88fcbbb7,"Ensure --help examples in docs are always up to date, closes #336

Unit tests now check that docs/*.txt help examples are all up-to-date.

I ran into a problem here in that the terminal_width needed to be more
accurately defined - so I replaced update-docs-help.sh with update-docs-
help.py which hard-codes the terminal width.",3a46d5e3c4278e74c3694f36995ea134bff800bc,False,docs/datasette-package-help.txt;docs/datasette-publish-help.txt;docs/datasette-serve-help.txt;tests/test_docs.py;update-docs-help.py;update-docs-help.sh
ba64cfb4bc8ff79086e3f61d9be3eaf35cc44c84,"Fix for Python 3.5

https://stackoverflow.com/a/42694113/6083",9b85c599079e7dc37e7be125839711c982afc526,False,tests/test_docs.py
dbbe707841973b50a76d2703003ae2c40e7ad1fd,"publish_subcommand hook + default plugins mechanism, used for publish heroku/now (#349)

This change introduces a new plugin hook, publish_subcommand, which can be
used to implement new subcommands for the ""datasette publish"" command family.

I've used this new hook to refactor out the ""publish now"" and ""publish heroku""
implementations into separate modules. I've also added unit tests for these
two publishers, mocking the subprocess.call and subprocess.check_output
functions.

As part of this, I introduced a mechanism for loading default plugins. These
are defined in the new ""default_plugins"" list inside datasette/app.py

Closes #217 (Plugin support for datasette publish)
Closes #348 (Unit tests for ""datasette publish"")
Refs #14, #59, #102, #103, #146, #236, #347",3ac21c749881d0fb1c35b0f9b7a819e29f61c5c1,False,datasette/app.py;datasette/cli.py;datasette/hookspecs.py;datasette/publish/__init__.py;datasette/publish/common.py;datasette/publish/heroku.py;datasette/publish/now.py;datasette/utils.py;docs/datasette-publish-heroku-help.txt;docs/datasette-publish-now-help.txt;docs/plugins.rst;docs/publish.rst;tests/test_docs.py;update-docs-help.py
1fb518618c1c246c58daf5085247b430f2aea29f,"""datasette publish heroku"" improvements

* Fixed bug where --title= didn't work if -m not provided
* Now using Python 3.6.6 instead of Python 3.6.3",dbbe707841973b50a76d2703003ae2c40e7ad1fd,False,datasette/utils.py
e8625695a3b7938f37b64dff09c14e47d9428fe5,"xfail documentation unit tests for view classes, refs #299

More documentation unit tests. These ones check that every single **View class
imported into the datasette/app.py module are covered by our documentation.

Just one problem: they aren't documented yet. So I'm using the xfail pytest
decorator to mark these tests as allowed-to-fail. When you run the test suite
you now get a report of how many views still need to be documented, but it
doesn't fail the tests.

The output looks something like this:

    $ pytest tests/test_docs.py
    collected 31 items

    tests/test_docs.py ..........................XXXxx.                [100%]

    ============ 26 passed, 2 xfailed, 3 xpassed in 1.06 seconds ============

Once I have documented all the views I will remove the xfail so any future
views that are added without documentation will cause a test failure.

We can detect that a view is documented by looking for ReST label in the docs,
for example:

    .. _IndexView:

Some view classes can be used to power multiple URLs - the JsonDataView class
for example is used to power /-/metadata and /-/config and /-/plugins

In this case, the second part of the label can indicate the variety of page, e.g:

    .. _JsonDataView_metadata:

The test will pass as long as there is at least one label that starts with
_JsonDataView.",3b68314d8f59d92fe7b2150cf747a082192ef9b7,False,tests/test_docs.py
788a542d3c739da5207db7d1fb91789603cdd336,"Docs for IndexView, TableView, RowView, closes #299

Also removed xfail from test_view_classes_are_documented, so any future *View
classes that are added without documentation will cause the tests to fail.",8da6b0d542c7ea276df8b5467d4be6cd08cf867f,False,docs/config.rst;docs/index.rst;docs/json_api.rst;docs/pages.rst;docs/sql_queries.rst;tests/test_docs.py
8128497b7946ab68fff703e207fc7c5b26b6e9c9,"Only run documented_views() fixture once per session

Speeds up tests, because previously it ran once per view class.",788a542d3c739da5207db7d1fb91789603cdd336,False,tests/test_docs.py
b7257a21bf3dfa7353980f343c83a616da44daa7,"Fix json.loads in Python 3.5

3.5 requires a str, not a bytes

https://travis-ci.org/simonw/datasette/jobs/421660555",1f54e092306b208125f39d06712b02895eb75168,False,tests/test_plugins.py
1bcd54a834a2f9730d21095df855f6708c85c200,Fix small doc typo - thanks @jaywgraves (#365),b7257a21bf3dfa7353980f343c83a616da44daa7,False,docs/sql_queries.rst
b6546da53516e148e6aa34ad94f3452da30040f8,"Use Zeit cloud v1 to avoid 100MB image limit

Closes #366 - thanks @slygent",5debabd3fba1f0669081cefe55b67d333470bbd4,False,datasette/publish/now.py
d0393e821e5914a7c1d659eaf0a5d612a1aa8e01,"Travis to use Python 3.7-dev for a little longer

3.7 produces a 403 forbidden error: https://travis-ci.org/simonw/datasette/jobs/450716231#L6",c2c03f8e7be6973ef3cbdb3ca424e55a81a956d7,False,.travis.yml
3de8fac1d322cbab6c8c55899e0e8511b36337d0,"New make_app_client() pattern

Because next version of pytest discourages calling fixture factories as functions",5e3a432a0caa23837fa58134f69e2f82e4f632a6,False,tests/fixtures.py;tests/test_api.py;tests/test_html.py
eac08f0dfc61a99e8887442fc247656d419c76f8,--reload now also reloads if databases change on disk,48d24c6589f214c7e1bab21d32e2f35a0038e71f,False,datasette/cli.py;docs/datasette-serve-help.txt
a2bfcfc1b1c60dac3526364af17c2fa2f3d41a0a,Fix some regex DeprecationWarnings (#392),eac08f0dfc61a99e8887442fc247656d419c76f8,False,datasette/app.py;tests/test_html.py
996e8822d2cb551c0ed821ff1fda24af905332d3,"Fix CSV export hidden form fields, closes #393",8b8ae55e7c8b9e1dceef53f55a330b596ca44d41,False,datasette/templates/table.html;datasette/views/base.py;tests/test_html.py
c4c970f3c90fa79a6c6527fe963baf9e07b023c8,Bump aiohttp to 3.5.3 to fix a warning,8ce7866312f9b7c873541d6e3662ada3e850fa85,False,setup.py
c3a78eb05c0b146b2eb37b50c1668b9430b8f50a,app_client() fixture doesn't need to take **kwargs,4722acc73ce761556b18f5dcbe36b7fef2ee2c69,False,tests/fixtures.py
195a5b36349d0d24a6bbb758cebb719b6de303b6,"Heroku --include-vcs-ignore (#407)

Means `datasette publish heroku` can work under Travis, unlike this failure:

https://travis-ci.org/simonw/fivethirtyeight-datasette/builds/488047550

```
2.25s$ datasette publish heroku fivethirtyeight.db -m metadata.json -n fivethirtyeight-datasette
tar: unrecognized option '--exclude-vcs-ignores'
Try 'tar --help' or 'tar --usage' for more information.
 ▸    Command failed: tar cz -C /tmp/tmpuaxm7i8f --exclude-vcs-ignores --exclude
 ▸    .git --exclude .gitmodules . >
 ▸    /tmp/f49440e0-1bf3-4d3f-9eb0-fbc2967d1fd4.tar.gz
 ▸    tar: unrecognized option '--exclude-vcs-ignores'
 ▸    Try 'tar --help' or 'tar --usage' for more information.
 ▸    
The command ""datasette publish heroku fivethirtyeight.db -m metadata.json -n fivethirtyeight-datasette"" exited with 0.
```

The fix for that issue is to call the heroku command like this:

    heroku builds:create -a app_name --include-vcs-ignore",436b8bc1d17c2ab415800ab209204f94e7f7929e,False,datasette/publish/heroku.py;tests/test_publish_heroku.py
285566790879b31d2fdd2a8c6f56825162eb71b9,Fix for test failure with Click 7.0,b3e739332624c2d4f2668a105afd727af774100b,False,tests/test_publish_heroku.py
6f6d0ff2b41f1cacaf42287b1b230b646bcba9ee,"URL hashing is now off by default - closes #418

Prior to this commit Datasette would calculate the content hash of every
database and redirect to a URL containing that hash, like so:

    https://v0-27.datasette.io/fixtures => https://v0-27.datasette.io/fixtures-dd88475

This assumed that all databases were opened in immutable mode and were not
expected to change.

This will be changing as a result of #419 - so this commit takes the first step
in implementing that change by changing this default behaviour. Datasette will
now only redirect hash-free URLs under two circumstances:

* The new `hash_urls` config option is set to true (it defaults to false).
* The user passes `?_hash=1` in the URL",afe9aa3ae03c485c5d6652741438d09445a486c1,False,datasette/app.py;datasette/templates/database.html;datasette/templates/query.html;datasette/templates/row.html;datasette/templates/table.html;datasette/utils.py;datasette/views/base.py;datasette/views/database.py;datasette/views/index.py;datasette/views/table.py;docs/config.rst;tests/fixtures.py;tests/test_api.py;tests/test_html.py;tests/test_utils.py
82fec6048148b58748040a7e2caa163387e982a3,"Fix for TypeError

    File ""../datasette/app.py"", line 138, in __init__
      self.files = files + immutables
    TypeError: can only concatenate tuple (not ""list"") to tuple",47032636b55718dd711670f19b753f4ada9e8f2f,False,datasette/app.py
3a208a41d4dce35b97eca8b25f37055c3fda5aed,"TableView.data() no longer uses .inspect, refs #420

BUT... it does a count(*) against the whole table which may take unbounded time.

Fixing this is part of #422",36bd6558b00be027bb4b7dba0c8d200da0ca95df,False,datasette/views/table.py
f2c767c2221b06c0fb4962cfa430e038359019d3,Fixed broken link in documentation,bc6a9b45646610f362b4287bc4110440991aa4d6,False,docs/json_api.rst
9d73e3c8bd5f3aae24a75b62c420de166992b30c,"Note that trace data format is very likely to change, refs #435",e4e73a537add40b92a02e55af004b0d26a3ccdce,False,docs/json_api.rst
11b352b4d52fd02a422776edebb14f12e4994d3b,"Fix for Python 3.5, refs #435",9d73e3c8bd5f3aae24a75b62c420de166992b30c,False,datasette/app.py
bac4e01f40ae7bd19d1eab1fb9349452c18de8f5,"Ensure sqlite_timelimit correctly clears handler

If an error occurred inside the block the progress handler (used to
enforce a time limit) was not being correctly cleared, resulting in
timeout errors potentially occurring during subsequent SQL queries.

The fix is described here: https://docs.python.org/3/library/contextlib.html#contextlib.contextmanager",11b352b4d52fd02a422776edebb14f12e4994d3b,False,datasette/utils.py
cf406c075433882b656e340870adf7757976fa4c,"New plugin hook: register_output_renderer hook (#441)

Thanks @russss!

* Add register_output_renderer hook

This changeset refactors out the JSON renderer and then adds a hook and
dispatcher system to allow custom output renderers to be registered.

The CSV output renderer is untouched because supporting streaming
renderers through this system would be significantly more complex, and
probably not worthwhile.

We can't simply allow hooks to be called at request time because we need
a list of supported file extensions when the request is being routed in
order to resolve ambiguous database/table names. So, renderers need to
be registered at startup.

I've tried to make this API independent of Sanic's request/response
objects so that this can remain stable during the switch to ASGI. I'm
using dictionaries to keep it simple and to make adding additional
options in the future easy.

Fixes #440",bac4e01f40ae7bd19d1eab1fb9349452c18de8f5,False,datasette/app.py;datasette/hookspecs.py;datasette/renderer.py;datasette/templates/query.html;datasette/templates/row.html;datasette/templates/table.html;datasette/utils.py;datasette/views/base.py;datasette/views/database.py;datasette/views/index.py;datasette/views/table.py;docs/plugins.rst;tests/test_utils.py
50d2d1aac985f440b36e6847e3ddacb4a6bf4d4b,Fixed bug where metadata.json hidden tables were ignored,e7151ccccf4a0d10e1fcf3832e18c5199c16dea0,False,datasette/app.py;datasette/views/index.py;tests/test_api.py
ea66c45df96479ef66a89caa71fff1a97a862646,"Extract facet code out into a new plugin hook, closes #427 (#445)

Datasette previously only supported one type of faceting: exact column value counting.

With this change, faceting logic is extracted out into one or more separate classes which can implement other patterns of faceting - this is discussed in #427, but potential upcoming facet types include facet-by-date, facet-by-JSON-array, facet-by-many-2-many and more.

A new plugin hook, register_facet_classes, can be used by plugins to add in additional facet classes.

Each class must implement two methods: suggest(), which scans columns in the table to decide if they might be worth suggesting for faceting, and facet_results(), which executes the facet operation and returns results ready to be displayed in the UI.",efc93b8ab5a21e3802f75f08d5e41409f5684b5d,False,datasette/app.py;datasette/facets.py;datasette/hookspecs.py;datasette/plugins.py;datasette/templates/table.html;datasette/views/table.py;docs/plugins.rst;tests/test_api.py;tests/test_facets.py;tests/utils.py
470cf0b05d4fda0d2563f81c7e32af13fe346ccc,"Add a max-line-length setting for flake8 (#444)

This stops my automatic editor linting from flagging lines which are too
long. It's been lingering in my checkout for ages.

160 is an arbitrary large number - we could alter it if we have any
opinions (but I find the line length limit to be my least favourite part
of PEP8).",53d2f00b732488e0204332da181fc256aa00f41c,False,setup.cfg
93c65d29ba372fa2262a641c0fecb7a071d998d6,Fixed 500 error on /-/metadata page,f853d5592ec7f901a50381de22a26a9ab098f885,False,datasette/views/special.py;tests/test_html.py
66c87cee0c7344c7877373c60b180c766c206101,"Mark codemirror files as vendored (#367)

This should stop GitHub from incorrectly stating that Datasette is 46% JavaScript.",93c65d29ba372fa2262a641c0fecb7a071d998d6,False,.gitattributes
35d6ee2790e41e96f243c1ff58be0c9c0519a8ce,"Apply black to everything, enforce via unit tests (#449)

I've run the black code formatting tool against everything:

    black tests datasette setup.py

I also added a new unit test, in tests/test_black.py, which will fail if the code does not
conform to black's exacting standards.

This unit test only runs on Python 3.6 or higher, because black itself doesn't run on 3.5.",66c87cee0c7344c7877373c60b180c766c206101,False,datasette/__init__.py;datasette/_version.py;datasette/app.py;datasette/cli.py;datasette/facets.py;datasette/filters.py;datasette/inspect.py;datasette/publish/cloudrun.py;datasette/publish/common.py;datasette/publish/now.py;datasette/renderer.py;datasette/utils.py;datasette/version.py;datasette/views/base.py;datasette/views/index.py;datasette/views/special.py;datasette/views/table.py;setup.py;tests/conftest.py;tests/fixtures.py;tests/test_api.py;tests/test_black.py;tests/test_csv.py;tests/test_docs.py;tests/test_filters.py;tests/test_html.py;tests/test_inspect.py;tests/test_plugins.py;tests/test_publish_cloudrun.py;tests/test_publish_heroku.py;tests/test_utils.py
831515b834b1bf465a5c64e69ce505d22f75b35b,"Respect --cors for error pages, closes #453",55643430f7ac8d27e99b00e7cf79db741003e811,False,datasette/app.py;tests/test_api.py
ec2db345e9465ee4ce3880dc62dcd453e66bcbca,Fixed crash on /:memory: page,9617e92aa819ec7d7f09b9e44656ebba90c67f67,False,datasette/app.py;tests/test_html.py
bfa2ae0d16d39bb82dbe4da4f3fdc3c7f6257418,"Promote Glitch instead of Datasette Publish

Datasette Publish is currently broken due to Zeit API and platform changes.",ec2db345e9465ee4ce3880dc62dcd453e66bcbca,False,README.md
9fdb47ca952b93b7b60adddb965ea6642b1ff523,"New encode/decode_path_component functions

ASGI cannot differentiate between / and %2F in a URL, so we need an
alternative scheme for encoding the names of tables that contain special
characters such as /

For background, see
    https://github.com/django/asgiref/issues/51#issuecomment-450603464

Some examples:

    ""table/and/slashes"" => ""tableU+002FandU+002Fslashes""
    ""~table"" => ""U+007Etable""
    ""+bobcats!"" => ""U+002Bbobcats!""
    ""U+007Etable"" => ""UU+002B007Etable""",bfa2ae0d16d39bb82dbe4da4f3fdc3c7f6257418,False,datasette/utils.py;tests/test_utils.py
2db977d8f30e0eb8b7cda1481a4a8852b414915d,"tests/fixtures.py can now write out plugins too

This command:

    python tests/fixtures.py \
        fixtures.db \
        metadata.json \
        fixtures-plugins/

Will now create the fixtures.db and metadata.json files, AND create
a folder called fixtures-plugins/ containing two test plugins.

You can then run it like this:

    datasette fixtures.db \
        -m metadata.json --plugins-dir=fixtures-plugins/",9fdb47ca952b93b7b60adddb965ea6642b1ff523,False,tests/fixtures.py
de005b9b7d3db72375e6b8b048d1616a98e6347a,Fixed 500 error on homepage,ad789eaaea069046d3b293d2c650a60acd72ced7,False,datasette/views/index.py
e7b31ae8c1a28cab9db8e165b3f21407c2e581e6,"Use now --target production instead of now alias

Fix for this error:

    $ now alias --token=$NOW_TOKEN
    > WARN! The `now alias` command (no arguments) was deprecated in favour of `now --target production`.
    > Error! Couldn't find a deployment to alias. Please provide one as an argument.
    The command ""now alias --token=$NOW_TOKEN"" exited with 1.

https://travis-ci.org/simonw/datasette/jobs/530597261",de005b9b7d3db72375e6b8b048d1616a98e6347a,False,.travis.yml
37adf3229038137de82a4e7331075212e7e94367,Changelog for 0.27.1,e7b31ae8c1a28cab9db8e165b3f21407c2e581e6,False,docs/changelog.rst
a0d444837f6ce3fdaf6b0664605f74dd4a7f8215,"Finished implementation of ?_trace=1 debug tool

I redesigned the JSON output and added a handy ""traceback"" key showing
three relevant lines of the current traceback for each logged query.

Closes #435",37adf3229038137de82a4e7331075212e7e94367,False,datasette/app.py;datasette/tracer.py;tests/test_api.py
09ef305c687399384fe38487c075e8669682deb4,"Fixed ""datasette publish now ... --alias=x""

The --alias argument can now be passed more than once.

Also updated our Travis configuration to use this.

Fixes #459",a0d444837f6ce3fdaf6b0664605f74dd4a7f8215,False,.travis.yml;datasette/publish/now.py;tests/test_publish_heroku.py;tests/test_publish_now.py
ce09e5d2d392634eced44c3c8d603d7c628e2822,Fixed tests relating to #459,05cabaebd99b4aa388096de0a03fb52d08f6c117,False,tests/test_publish_now.py
c0d1b4c32297453adaa4c159edee9be0a9617f2b,"""datasette inspect foo.db"" now just calculates table counts

Refs #462

* inspect command now just outputs table counts
* test_inspect.py is now only tests for that CLI command
* Updated some relevant documentation
* Removed docs for /-/inspect since that is about to change",ce09e5d2d392634eced44c3c8d603d7c628e2822,False,datasette/cli.py;docs/full_text_search.rst;docs/introspection.rst;tests/test_inspect.py
a187c81e0caf92ed52a380f262b6b5eabb399897,Black + fix broken test,c0d1b4c32297453adaa4c159edee9be0a9617f2b,False,tests/conftest.py;tests/test_inspect.py
c692cd291111050483a32bea1ee08e994a0b781b,Fix test ordering,a187c81e0caf92ed52a380f262b6b5eabb399897,False,tests/conftest.py
24bf79d2f01f373eafcb41eaa1279a13711eff25,"Run sanity checks, not .inspect(), on startup

Also fixes tests that did NOT like a call to run_until_complete in the Datasette() constructor.",da0b3ce2b76227f1cd0cfdd3df361712c17ddcd0,False,datasette/app.py;datasette/cli.py;tests/conftest.py
5d6b2c30f15c36bcf49906acda7f15ec6232c984,"Include views on homepage, fix table counts

If we have less than 5 tables we now also show one or more views in the
summary on the homepage.

Also corrected the logic for the row counts - we now count hidden and
visible tables separately.

Closes #373, Refs #460",e04511410f57e88c806455b9182a853bf07122a2,False,datasette/templates/index.html;datasette/views/index.py;tests/fixtures.py;tests/test_api.py;tests/test_html.py
79303163b249829182f2e8d8c2d45e4526aa174f,"Row count fix + sort index page databases alphabetically

Sorting alphabetically should fix a test failure in Python 3.5

Refs #460",5d6b2c30f15c36bcf49906acda7f15ec6232c984,False,datasette/views/index.py;tests/test_html.py
2ad9d15cd6901654e6801e2faa29e6fc08bae5fa,"Table counts now handles SQL Logic Error too

I tried running Datasette against 22 database files at once and ran into
a weird error where the table counts broke with an SQL Logic Error
exception. Easy fix: catch that exception too and treat it the same as a
regular Interrupted error.",b7fe722f0541c8c026e93dc59cfcff6c6201ddfd,False,datasette/app.py
12350e8b8a5e55f0fba14bb37ca725d751056c92,Fixed broken link to global-power-plants demo,8461b930d5d4d3a282289b6663b252037ebd45d3,False,docs/pages.rst
cccea85be6aaaeadb31f3b588ec7f732628815f5,"/-/databases sorts alphabetically

Should fix test failure in Python 3.5",0dad111d24856ee6012850dac19929a48dc0a59f,False,datasette/app.py
260085838887ee343f4d3b177c422e7aef5ade9d,Fixed some links,870f6dd55fc5e7bc2f9db4ab22f90b7a734e402a,False,docs/publish.rst
4246e138f9512686413e97878659ef953337e57b,Typo fix,e513a80afba30bca9eeebd71c5e6aa6d8a811f33,False,docs/performance.rst
70d2858067d3c4da0e17c1d39e03de89190e94b6,Doc typo fix (#479),4246e138f9512686413e97878659ef953337e57b,False,docs/performance.rst
de4503a136617697648473bc37780c6799eb4d98,Fix ?col__date= for columns with spaces,70d2858067d3c4da0e17c1d39e03de89190e94b6,False,datasette/filters.py
c902590ada636098a705502d78f51b2f92973350,Stack Overflow survey added to news,f12220b17de426a356a716c58768071fce1f741a,False,README.md
172da009d890aa029cff7138b4dcfd4f60948525,"Added ?_through= table argument, closes #355

Also added much more interesting many-to-many fixtures - roadside attractions!",c902590ada636098a705502d78f51b2f92973350,False,datasette/views/table.py;docs/json_api.rst;tests/fixtures.py;tests/test_api.py
bd4dbc8519c24c2799dfa5e69bb3dc37a3f3092e,"Rename InterruptedError => QueryInterrupted, closes #490",edb36629e7356f70f42b9d37fea5dfe9cc3c364a,False,datasette/app.py;datasette/database.py;datasette/facets.py;datasette/utils.py;datasette/views/base.py;datasette/views/table.py;docs/plugins.rst
de92c0513409e72af78e6796c47c8954fd47576e,Fixed duplicate function name,839e55bf0a5cc2ef4d47074b7d804f7f2d5accb3,False,tests/test_database.py
9c58d048ec4af8a35b680a5654c2a18985704f8b,"Fix pagination when sorted by expanded foreign key

Closes #489",f069950a143b97b384ec39a86db28e6f2830947d,False,datasette/views/table.py;tests/test_api.py
aa911122feab13f8e65875c98edb00fd3832b7b8,Fix typo in install step: should be install -e (#500),6ccfcefb782bbf86b87bf047d01b979782aa6d97,False,docs/contributing.rst
d4df640d187d01a0ee81c238082a690bbefd0800,"Refactored view class hierarchy, refs #272

See https://github.com/simonw/datasette/issues/272#issuecomment-502393107",aa911122feab13f8e65875c98edb00fd3832b7b8,False,datasette/views/base.py;datasette/views/database.py;datasette/views/index.py;datasette/views/special.py;datasette/views/table.py
ba8db9679f3bd2454c9e76e7e6c352126848b57a,"Port Datasette from Sanic to ASGI + Uvicorn (#518)

Datasette now uses ASGI internally, and no longer depends on Sanic.

It now uses Uvicorn as the underlying HTTP server.

This was thirteen months in the making... for full details see the issue:

https://github.com/simonw/datasette/issues/272

And for a full sequence of commits plus commentary, see the pull request:

https://github.com/simonw/datasette/pull/518",35429f90894321eda7f2db31b9ea7976f31f73ac,False,datasette/app.py;datasette/cli.py;datasette/renderer.py;datasette/tracer.py;datasette/utils/__init__.py;datasette/utils/asgi.py;datasette/views/base.py;datasette/views/database.py;datasette/views/index.py;datasette/views/special.py;datasette/views/table.py;pytest.ini;setup.py;tests/fixtures.py;tests/test_api.py;tests/test_csv.py;tests/test_html.py;tests/test_utils.py
a5591236c46f507b9e46b1b52e51d5f46ffd6913,"Install test dependencies so deploy can work

python tests/fixtures.py needs asgiref or it fails with an error",ba8db9679f3bd2454c9e76e7e6c352126848b57a,False,.travis.yml
f0d32da0a9af87bcb15e34e35424f0c0053be83a,"Switch to ~= dependencies, closes #532 (#536)

* Switch to ~= dependencies, closes #532
* Bump click and click-default-group
* imp. is deprecated, use types.ModuleType instead - thanks https://stackoverflow.com/a/32175781
* Upgrade to pytest 5",4d2fdafe39159c9a8aa83f7e9bfe768bbbbb56a3,False,datasette/utils/__init__.py;setup.py
25ff0a8ba6b2e3247a66048ad173ba5ed8a38b80,"Fix for accidentally leaking secrets in /-/metadata, closes #538",a2d45931935f6bb73605a94afedf9e78308c95d6,False,datasette/app.py;tests/test_plugins.py
fcfcae21e67cc15090942b1d2a47b5f016279337,"extra_template_vars plugin hook (#542)

* extra_template_vars plugin hook

Closes #541

* Workaround for cwd bug

Based on https://github.com/pytest-dev/pytest/issues/1235#issuecomment-175295691",a18e0964ecd04593f227616538a80dee08768057,False,datasette/hookspecs.py;datasette/views/base.py;datasette/views/index.py;datasette/views/special.py;docs/plugins.rst;tests/conftest.py;tests/fixtures.py;tests/test_plugins.py;tests/test_templates/show_json.html
912ce848b9fa8b1642c800b446f504518bc39f2a,"Fix nav display on 500 page, closes #545",787dd427de97dcbd0843611f1aef6d157d8bb0b6,False,datasette/templates/500.html
973f8f139df6ad425354711052cfc2256de2e522,"--plugin-secret option for datasette publish

Closes #543

Also added new --show-files option to publish now and publish cloudrun - handy for debugging.",2d04986c4438cdfd3bb9d156d9dfcf830cb87b49,False,datasette/publish/cloudrun.py;datasette/publish/common.py;datasette/publish/heroku.py;datasette/publish/now.py;datasette/utils/__init__.py;docs/datasette-publish-cloudrun-help.txt;docs/datasette-publish-heroku-help.txt;docs/datasette-publish-nowv1-help.txt;docs/plugins.rst;docs/publish.rst;tests/test_publish_cloudrun.py;tests/test_publish_heroku.py;tests/test_publish_now.py
fb7ee8e0ad59a15083234a48e935525f6e7257dd,Changelog for 0.29 release,973f8f139df6ad425354711052cfc2256de2e522,False,docs/changelog.rst;docs/custom_templates.rst;docs/performance.rst;docs/publish.rst
74ecf8a7cc45cabf369e510c7214f5ed85c8c6d8,"Fix static mounts using relative paths and prevent traversal exploits (#554)

Thanks, @abdusco! Closes #555",9ca860e54fe480d0a365c0c1d8d085926d12be1e,False,datasette/utils/__init__.py;datasette/utils/asgi.py;tests/test_html.py
5ed450a3328bd6a6a918474eeb5446d8a704df1c,Fixed breadcrumbs on custom query page,afc2e4260ab8b28e132c834185c5294fb27543f1,False,datasette/templates/query.html
90d4f497f9b3f6a5882937c91fddb496ac3e7368,"Fix plus test for unicode characters in custom query name, closes #558",5ed450a3328bd6a6a918474eeb5446d8a704df1c,False,datasette/utils/asgi.py;tests/fixtures.py;tests/test_api.py
a9453c4dda70bbf5122835e68f63db6ecbe1a6fc,"Fixed CodeMirror on database page, closes #560",6abe6faff6b035e9334dd05f8c741ae9b7a47440,False,datasette/templates/database.html
27cb29365c9f5f6f1492968d1268497193ed75a2,"Fix numerous typos (#561)

Thanks, @minho42!",a9453c4dda70bbf5122835e68f63db6ecbe1a6fc,False,datasette/_version.py;datasette/views/base.py;docs/changelog.rst;docs/metadata.rst;docs/performance.rst;versioneer.py
2dc5c8dc259a0606162673d394ba8cc1c6f54428,"detect_fts now works with alternative table escaping (#571)

Fixes #570. See also https://github.com/simonw/sqlite-utils/pull/57",f04deebec4f3842f7bd610cd5859de529f77d50e,False,datasette/utils/__init__.py;tests/test_utils.py
0fc8afde0eb5ef677f4ac31601540d6168c8208d,Changelog for 0.29.3 release,2dc5c8dc259a0606162673d394ba8cc1c6f54428,False,docs/changelog.rst
a314b761866d250c16f1ff6dd682010cf4181eb4,Added /-/threads debugging page,0fc8afde0eb5ef677f4ac31601540d6168c8208d,False,datasette/app.py;docs/introspection.rst
b6ad1fdc7068cb8248787843e7438d1f19fa2e3a,"Fixed bug returning non-ascii characters in CSV, closes #584",3e864b1625f3142e6ff084f9b41247f2f9f60f80,False,datasette/utils/asgi.py;tests/test_csv.py
b647b5efc29300f715ba656e41b0591f342938e1,"Fix for /foo v.s. /foo-bar issue, closes #597

Pull request #599",b6ad1fdc7068cb8248787843e7438d1f19fa2e3a,False,datasette/views/base.py;tests/fixtures.py;tests/test_api.py
3ca290e0db03bb4747e24203c445873f74512107,Fixed dumb error,f5f6cbe03cbf05737d848f44779372b5daa79a25,False,datasette/views/table.py
2bf7ce5f517d772a16d7855a35a8a75d4456aad7,"Fix CSV export for nullable foreign keys, closes #612",c3181d9a840dff7be8c990b21f5749db393a4ea0,False,datasette/views/base.py;tests/test_csv.py
ee330222f4c3ee66c2fe41ebc76fed56b9cb9a00,"Offer to format readonly SQL (#602)

Following discussion in #601, this PR adds a ""Format SQL"" button to
read-only SQL (if the SQL actually differs from the formatting result).

It also removes a console error on readonly SQL queries.

Thanks, @rixx!",2bf7ce5f517d772a16d7855a35a8a75d4456aad7,False,datasette/templates/_codemirror_foot.html
1c063fae9dba70f70244db010d55a18846640f07,"Test against Python 3.8 in Travis (#623)

* Test against Python 3.8 in Travis
* Avoid current_task warnings in Python 3.8",28c4a6db5b5e512db630d7ba6127196185de67c7,False,.travis.yml;datasette/tracer.py
42ee3e16a9ba7cc513b8da944cc1609a5407cf42,"Bump pint to 0.9 (#624)

This fixes 2 deprecation warnings in Python 3.8 - refs #623 #622",1c063fae9dba70f70244db010d55a18846640f07,False,setup.py
cf7776d36fbacefa874cbd6e5fcdc9fff7661203,"Support Python 3.8, stop supporting Python 3.5 (#627)

* Upgrade to uvicorn 0.10.4
* Drop support for Python 3.5
* Bump all dependencies to latest releases
* Update docs to reflect we no longer support 3.5
* Removed code that skipped black unit test on 3.5

Closes #622",5bc2570121aea8141ff88790e214765472882b08,False,.travis.yml;README.md;docs/contributing.rst;docs/installation.rst;setup.py;tests/test_black.py
f554be39fc14ddc18921ca29d3920d55aad03d46,ReST fix,1c518680e9692a9a77022af54f3de3e77fb1aaf4,False,docs/changelog.rst
a22c7761b61baa61b8e3da7d30887468d61d6b83,Fixed typo in release notes,16265f6a1a7c547e3925e0fc2d6b88754afb0435,False,docs/changelog.rst
848dec4deb0d3c140a4e0394cac45fbb2593349b,"Fix for datasette publish with just --source_url (#631)

Closes #572",bbd00e903cdd49067ecdbdb60a4d225833a44b05,False,datasette/templates/_description_source_license.html
f52451023025579ae9a13de4a7f00d69200184cd,"Fix ""publish heroku"" + upgrade to use Python 3.8.0

Closes #633. Closes #632.",848dec4deb0d3c140a4e0394cac45fbb2593349b,False,datasette/publish/heroku.py;tests/test_publish_heroku.py
a9909c29ccac771c23c2ef22b89d10697b5256b9,"Move .execute() from Datasette to Database

Refs #569 - I split this change out from #579",8fc9a5d877d26dbf2654e125f407ddd2fd767335,False,datasette/app.py;datasette/database.py
fd137da7f83c117b18e189707a1039e319dd5c91,"Suggest column facet only if at least one count > 1

Fixes #638",c16be14517414a94e1fdbd888e8a3ad0669e3bca,False,datasette/facets.py;tests/fixtures.py;tests/test_api.py;tests/test_csv.py
d6b6c9171f3fd945c4e5e4144923ac831c43c208,Include asyncio task information in /-/threads debug page,2039e78e589ae7c60f404fe84fb75eda1630104e,False,datasette/app.py;datasette/templates/show_json.html;datasette/views/special.py;docs/introspection.rst;tests/test_api.py
d54318fc7f2565e6121920ce1ea9cb8b700e629a,"Added template_debug setting, closes #654",ceef5ce684214a9b55d242043206cb10b13c878a,False,.travis.yml;datasette/app.py;datasette/views/base.py;docs/config.rst;tests/test_api.py;tests/test_html.py
3c861f363df02a59a67c59036278338e4760d2ed,"_search= queries now correctly escaped, fixes #651

Queries with reserved words or characters according to the SQLite
FTS5 query language could cause errors.

Queries are now escaped like so:

    dog cat => ""dog"" ""cat""",59e7014c8a0f4102d7dc79f517540c55c49e1554,False,datasette/plugins.py;datasette/sql_functions.py;datasette/utils/__init__.py;datasette/views/table.py;tests/test_api.py;tests/test_utils.py
0091dfe3e5a3db94af8881038d3f1b8312bb857d,"More reliable tie-break ordering for facet results

I was seeing a weird bug where the order of results running tests
on my laptop was inconsistent, causing pytest failures even though
the order of tests in Travis CI was fine.

I think the fix is to explicitly state how facet ordering ties on
the count should be resolved.",298a899e792ebd0cd82a5f01b613c31f19082e51,False,datasette/facets.py
be2265b0e811d0ac2875c2f748125c17b0f9289e,"Fix db-to-sqlite command in ecosystem doc page (#669)

Thanks, @adipasquale",7c6a9c35299f251f9abfb03fd8e85143e4361709,False,docs/ecosystem.rst
411056c4c43e74f2b3d0e3bc1175e7998516b1b3,"Only --reload on changes to immutable databases, closes #494",b031fe97636b80b05fec409ee1dffb7d044fd4e9,False,datasette/cli.py
78198df668e189d2c9afe5f922fe4277d84b2f30,Fixed incorrect target name,3041c6b6412bbe317f8b9afd6529a15954f2c47e,False,docs/internals.rst
1a77f30d3c40b1a6812da5d27ab35fa1acbd988b,Fixed typo,c9e6841482b299fceadc5ad548c2dbf58a8f1227,False,docs/internals.rst
0f8e91c68f2d2ad48efc8324b12762bf8b58facd,Documentation fix,1a77f30d3c40b1a6812da5d27ab35fa1acbd988b,False,docs/internals.rst
4933035b75607e60dc63f7977e2bd4fa771d8898,RST fix,613f6fad7249da547c06ebc46616aba0f74259a4,False,docs/plugins.rst
b796519da27dc6c30d490321bb449091974d3d38,Print exceptions if they occur in the write thread,dc80e779a2e708b2685fc641df99e6aae9ad6f97,False,datasette/database.py
be20e6991eac2baa9b43e9b26ae209bae805ede5,Changelog for 0.37.1,b796519da27dc6c30d490321bb449091974d3d38,False,docs/changelog.rst
af9cd4ca64652fae262e6f7b5d201f6e0adc989b,"Fixes for new --memory option, refs #694",ddd11b3ddd886d16867c134d73105895c5726cc7,False,datasette/publish/cloudrun.py;docs/datasette-publish-cloudrun-help.txt
e1a817411a20e3120943ee407503e53a7445c0db,Bump to click 7.1.1 to fix flaky tests,3d656f4b31e95047e0ffc1eaa7417a303ccce3c1,False,setup.py;tests/test_publish_cloudrun.py;tests/test_publish_heroku.py;tests/test_publish_now.py
a498d0fe6590f9bdbc4faf9e0dd5faeb3b06002c,"Fix bug with over-riding default sort, closes #702",236aa065b2ecfbe5a77870689bae432b89a48b23,False,datasette/views/table.py;tests/test_html.py
2a36dfa2a892122029f379722913469d71367925,"Fix for input type=search Webkit styling, closes #701",5f4aeb1f198e2e866a1eed6a7194842d77313ea8,False,datasette/static/app.css
a351d353bc0d6b0f737f789a0c2953e2531ed92d,"Fixed typo in GitHub Action configuration, refs #705",90015b26895fd2bd29676bc375f096102b0587ed,False,.github/workflows/deploy-latest.yml
99b1e919651c4be781aea162fe517e45f1f2a9c3,Fixed RST bug,dedd775512daee49925882654f252df61a9e3b6d,False,docs/config.rst
6aa516d82dea9885cb4db8d56ec2ccfd4cd9b840,"Run base_url tests against /fixtures/facetable too, refs #712",99b1e919651c4be781aea162fe517e45f1f2a9c3,False,tests/test_html.py
b07312c2b3bc7e4a9298c1f291f420bd92b6f842,"dedent SQL for neighborhood_search fixture

Makes this page a little prettier:
https://latest.datasette.io/fixtures/neighborhood_search",6717c719dd36dc2adc0f9da38a8c8e08129e96b4,False,tests/fixtures.py
09253817dea3c131553494f9b2eb9c03f94ae761,"Fix for missing view_name bug, closes #716",e0e7a0facfc935a835cd73c720bc46661462f0b1,False,datasette/views/base.py;datasette/views/database.py;tests/test_plugins.py
d55fe8cdfc2ce7bc6960bf2507766c1fcd1d31a7,"Fixed bug with Templates considered comment, closes #689",e89b0ef2f9ae89eb3bde83b694f21452ea4858da,False,datasette/app.py;datasette/views/base.py;tests/test_html.py
8da108193b08abf140716f8ac499f32309dfe9cf,Fixed a couple of spelling errors,edb39c91f75c97b6b55f1db6b7626e66cb8f2d45,False,docs/changelog.rst
d18086ae016caf14be0da7154ad92cf9d7bec060,Changelog badge,e37f4077c0f1cd09d4102213d4e2a512af471b8d,False,README.md
109c5a430d53fe38b1300e0daa20f5cef047a08e,"Update janus requirement from ~=0.4.0 to >=0.4,<0.6 (#734)

Updates the requirements on [janus](https://github.com/aio-libs/janus) to permit the latest version.
- [Release notes](https://github.com/aio-libs/janus/releases)
- [Changelog](https://github.com/aio-libs/janus/blob/master/CHANGES.rst)
- [Commits](https://github.com/aio-libs/janus/compare/v0.4.0...v0.5.0)

Signed-off-by: dependabot-preview[bot] <support@dependabot.com>

Co-authored-by: dependabot-preview[bot] <27856297+dependabot-preview[bot]@users.noreply.github.com>",e232f77055880b38cc0b738607cd50cde9188eaf,False,setup.py
aa064de3f400899dbf61f2d33a035fba4017596c,"Update jinja2 requirement from ~=2.10.3 to >=2.10.3,<2.12.0 (#722)

Updates the requirements on [jinja2](https://github.com/pallets/jinja) to permit the latest version.
- [Release notes](https://github.com/pallets/jinja/releases)
- [Changelog](https://github.com/pallets/jinja/blob/master/CHANGES.rst)
- [Commits](https://github.com/pallets/jinja/compare/2.10.3...2.11.1)

Signed-off-by: dependabot-preview[bot] <support@dependabot.com>

Co-authored-by: dependabot-preview[bot] <27856297+dependabot-preview[bot]@users.noreply.github.com>",109c5a430d53fe38b1300e0daa20f5cef047a08e,False,setup.py
c91fb9e3d4f0632d4ef25a21165739ab88a9d491,"Update pytest requirement from ~=5.2.2 to >=5.2.2,<5.5.0 (#721)

Updates the requirements on [pytest](https://github.com/pytest-dev/pytest) to permit the latest version.
- [Release notes](https://github.com/pytest-dev/pytest/releases)
- [Changelog](https://github.com/pytest-dev/pytest/blob/master/CHANGELOG.rst)
- [Commits](https://github.com/pytest-dev/pytest/compare/5.2.2...5.4.1)

Signed-off-by: dependabot-preview[bot] <support@dependabot.com>

Co-authored-by: dependabot-preview[bot] <27856297+dependabot-preview[bot]@users.noreply.github.com>",aa064de3f400899dbf61f2d33a035fba4017596c,False,setup.py
450d2e2896e07a8ce27f1cf143febe280c97301b,Fixed pytest warning about TestClient class,b314e088c59425122fb2b2abde8741010d9d274a,False,tests/test_config_dir.py;tests/test_plugins.py
cc872b1f50f1d2c0bc2d930c86a6644f154459dc,"Fixed rogue output in tests, closes #755",9424687e9e94401438896116898a071702b09d40,False,tests/test_database.py
5ab848f0b87ad2030088a7259fc1802316b90200,RST fix,545c71b6044bbf30caef04976cbd73d519d278a5,False,docs/internals.rst
9e6075d21facbfef565ffcdf160a558744fc1c2d,rST fixes for register_output_renderer docs,2d099ad9c657d2cab59de91cdb8bfed2da236ef6,False,docs/plugins.rst
da87e963bff24e47878a5bc2025c8bfc63d4bc93,"Test that plugin hooks are unit tested (xfail)

This currently fails using xfail. Closes 771.",41a0cd7b6afe0397efbbf27ad822679fc574811a,False,tests/test_plugins.py
50652f474b94e83d49ee15f219820cdbfc450f11,"Stop using .raw_args, deprecate and undocument it - refs #706",6d7cb02f00010d3cb4b4bac0460d41277652b80e,False,datasette/utils/asgi.py;datasette/views/database.py;datasette/views/table.py;docs/internals.rst
510c1989d43cd9b7c9f116ad161b7380220ac5d5,"Removed xfail, refs #773",6d95cb4f9146a5c4584a147bdf243c778a0f23f5,False,tests/test_plugins.py
21a8ffc82dcf5e8e5f484ce39ee9713f959e0ad5,Tip about referencing issues in release notes commit,7bb30c1f11f7246baf7bb6a229f6b93572c4cbe3,False,docs/contributing.rst
ca56c226a9f1b02e871d7d7b392619a805b7f1ed,"Renamed test_database.py to test_internals_database.py

Also added a db fixture to remove some boilerplate.",31fb006a9b05067a8eb2f774ad3a3b15b4565924,False,tests/test_internals_database.py
012c76901af65442e90eac4b36db43455e3c922f,"_ prefix for many private methods of Datasette, refs #576",ca56c226a9f1b02e871d7d7b392619a805b7f1ed,False,datasette/app.py;datasette/database.py
dfdbdf378aba9afb66666f66b78df2f2069d2595,"Added /-/permissions debug tool, closes #788

Also started the authentication.rst docs page, refs #786.

Part of authentication work, refs #699.",57cf5139c552cb7feab9947daa949ca434cc0a66,False,datasette/app.py;datasette/default_permissions.py;datasette/plugins.py;datasette/templates/permissions_debug.html;datasette/views/special.py;docs/authentication.rst;docs/index.rst;tests/test_auth.py
84a9c4ff75460f91c049bd30bba3cee1fd89d9e2,"CSRF protection (#798)

Closes #793.

* Rename RequestParameters to MultiParams, refs #799
* Allow tuples as well as lists in MultiParams, refs #799
* Use csrftokens when running tests, refs #799
* Use new csrftoken() function, refs https://github.com/simonw/asgi-csrf/issues/7
* Check for Vary: Cookie hedaer, refs https://github.com/simonw/asgi-csrf/issues/8",d96ac1d52cacf34bae09705eb8f9a0e3f81c426b,False,datasette/app.py;datasette/templates/messages_debug.html;datasette/templates/query.html;datasette/utils/__init__.py;datasette/views/base.py;setup.py;tests/fixtures.py;tests/test_canned_write.py;tests/test_utils.py
f786033a5f0098371cb1df1ce83959b27c588115,"Fixed 'datasette plugins' command, with tests - closes #802",033a1bb22c70a955d9fd1d3b4675a0e2e5c8b8cd,False,datasette/app.py;datasette/cli.py;tests/fixtures.py;tests/test_api.py;tests/test_cli.py;tests/test_utils.py
75c143a84cee2fad878c6318755582522b9afff3,"Fixed /-/plugins?all=1, refs #802",f786033a5f0098371cb1df1ce83959b27c588115,False,datasette/app.py;tests/test_api.py;tests/test_cli.py
9c563d6aed072f14d3d25f58e84659f9caa1a243,"Bump asgi-csrf to 0.5.1 for a bug fix

Refs https://github.com/simonw/asgi-csrf/issues/10",75c143a84cee2fad878c6318755582522b9afff3,False,setup.py
5ed2853cf3432a0f5a3511df8d2ffe9c6c79a584,Fix permissions documenation test,a1e801453aaeb540d2aea8cccb90b425af737c44,False,docs/authentication.rst
cd92e4fe2a47039a8c780e4e7183a0d2e7446884,"Fixed test name, this executes view-query, not execute-sql - refs #811",8571ce388a23dd98adbdc1b7eff6c6eef5a9d1af,False,tests/test_permissions.py
613fa551a1be31645deb0ece4b46638c181827e0,"Removed view-row permission, for the moment - refs #811

https://github.com/simonw/datasette/issues/811#issuecomment-640338347",cd92e4fe2a47039a8c780e4e7183a0d2e7446884,False,datasette/views/table.py;docs/authentication.rst;tests/test_html.py
dcec89270a2e3b9fabed93f1d7b9be3ef86e9ed2,"View list respects view-table permission, refs #811

Also makes a small change to the /fixtures.json JSON:

    ""views"": [""view_name""]

Is now:

    ""views"": [{""name"": ""view_name"", ""private"": true}]",9ac27f67fe346e753b562b711a2086e4c616d51d,False,datasette/templates/database.html;datasette/views/database.py;tests/test_permissions.py
e0a4664fbab5556454dac7f3c798253a34db2928,"Better example plugin for permission_allowed

Also fixed it so default permission checks run after plugin permission checks, refs #818",8205d58316ced1d5ae589b29a5a1b5ecb6257ab0,False,datasette/default_permissions.py;docs/authentication.rst;docs/plugins.rst
647c5ff0f3e8140f40d7f41f0874ce4e1f4df65c,"Fixed broken CSS on 404 page, closes #777",49d6d2f7b0f6cb02e25022e1c9403811f1fa0a7c,False,datasette/app.py;tests/test_html.py
d392dc1cfaeb8d2d7138d3d1d6aa0881f2f30589,Fixed test_table_not_exists_json test,647c5ff0f3e8140f40d7f41f0874ce4e1f4df65c,False,datasette/app.py
f5e79adf26d0daa3831e3fba022f1b749a9efdee,"register_routes() plugin hook (#819)

Fixes #215",d392dc1cfaeb8d2d7138d3d1d6aa0881f2f30589,False,datasette/app.py;datasette/hookspecs.py;datasette/utils/__init__.py;datasette/utils/asgi.py;docs/index.rst;docs/plugins.rst;tests/fixtures.py;tests/plugins/my_plugin.py;tests/test_plugins.py
f240970b834d595947c8d27d46d1f19b9119376d,"Fixed tests/fixtures.py, closes #804",56eb80a45925d804b443701e2c86315f194b5f7d,False,docs/contributing.rst;tests/fixtures.py
f3951539f1750698976359411e19c1ccb79210ed,Hopefully fix horizontal scroll with changelog on mobile,d94fc39e33b5eccae853e62f54bd8cc8e74688ff,False,docs/changelog.rst
d828abaddec0dce3ec4b4eeddc3a74384e52cf34,"Fix horizontal scrollbar on changelog, refs #828",f3951539f1750698976359411e19c1ccb79210ed,False,docs/_static/css/custom.css;docs/conf.py
57e812d5de9663a3c177e0344f4d1e552a74d484,"ds_author cookie can now expire, closes #829

Refs https://github.com/simonw/datasette-auth-github/issues/62#issuecomment-642152076",d828abaddec0dce3ec4b4eeddc3a74384e52cf34,False,datasette/actor_auth_cookie.py;datasette/views/special.py;docs/authentication.rst;docs/internals.rst;setup.py;tests/fixtures.py;tests/test_auth.py;tests/test_canned_write.py;tests/test_permissions.py
9f236c4c00689a022fd1d508f2b809ee2305927f,"Warn that register_facet_classes may change, refs #830

Also documented policy that plugin hooks should not be shipped without a real example. Refs #818",57e812d5de9663a3c177e0344f4d1e552a74d484,False,docs/contributing.rst;docs/plugins.rst
198545733b7a34d7b36ab6510ed30fb7687bcc7e,"Document that ""allow"": {} denies all

https://github.com/simonw/datasette/issues/831#issuecomment-642324847",9f236c4c00689a022fd1d508f2b809ee2305927f,False,docs/authentication.rst;tests/test_utils.py
29c5ff493ad7918b8fc44ea7920b41530e56dd5d,"view-instance permission for debug URLs, closes #833",09bf3c63225babe8e28cde880ca4399ca7dbd78b,False,datasette/views/special.py;tests/test_permissions.py
f39f11133126158e28780dee91bb9c7719ef5875,"Fixed actor_matches_allow bug, closes #836",29c5ff493ad7918b8fc44ea7920b41530e56dd5d,False,datasette/utils/__init__.py;tests/test_utils.py
308bcc8805236b8eb5a08d8045c84f68bd0ddf0e,Fixed test_permissions_debug,fba8ff6e76253af2b03749ed8dd6e28985a7fb8f,False,datasette/views/special.py;tests/test_permissions.py
ae99af25361c9248c721153922c623bd5f440159,"Fixed rST code formatting, refs #834",72ae975156a09619a808cdd03fddddcf62e6f533,False,docs/plugins.rst
a4ad5a504c161bc3b1caaa40b22e46d600f7d4fc,"Workaround for 'Too many open files' in test runs, refs #846",0c27f10f9d2124f0f534c25612b58be20441c9d8,False,tests/fixtures.py;tests/test_api.py
b59b92b1b0517cf18fa748ff9d0a0bf86298dd43,"Fix for tests - order was inconsistent, refs #852",0807c4200f6b31c804c476eb546ead3f875a2ecc,False,tests/test_canned_write.py;tests/test_html.py
64cc536b89b988b17e3ab853e4c64d9706543116,Don't include prereleases in changelog badge,b59b92b1b0517cf18fa748ff9d0a0bf86298dd43,False,README.md
d1640ba76b8f10830c56d8289f476fefde3bd1fb,Don't show prereleases on changelog badge,55a6ffb93c57680e71a070416baae1129a0243b8,False,docs/index.rst
e4216ff5035f57f2fb66031f105e41c3b9728bc1,Fixed rST warning,84cbf1766083a785f5ce5154d0805654a5314d10,False,docs/ecosystem.rst
1a5b7d318fa923edfcefd3df8f64dae2e9c49d3f,Fixed test I broke in #863,c5916cbffbf366d945cb2fed7b9fd8c5140e96d7,False,docs/changelog.rst;tests/test_plugins.py
335f26a0f7f00134f02ae0f001946580b0edecf5,"/fixtures/magic_parameters demo, refs #842",563f5a2d3ab30ad08daee38f5ec3ed6429ac9206,False,tests/fixtures.py;tests/test_html.py
b28657672f1023d32c4afbecd0e7232ab417bc88,"Added register_magic_plugins hook to changelog, refs #842",1f55a4a2b68fa65e56a28baeb7f44122fdeca7e7,False,docs/changelog.rst
35aee82c60b2c9a0185b934db5528c8bd11830f2,"Fixed 500 error with /favicon.ico, closes #874",22d932fafc3fa9af5a8f5eeab908688eaeb177ea,False,datasette/app.py;tests/test_html.py
9ac6292614a332ddc5d0868abe4a72f8f48bc7ac,"_header_x now defaults to empty string

Prior to this a request to e.g. https://latest.datasette.io/fixtures/magic_parameters
which did not include a User-Agent header would trigger a 500 error.",2115d7e3457b48b3cf9c81551b9fed2d0e9cd111,False,datasette/default_magic_parameters.py;tests/test_canned_queries.py
f7c3fc978ca787e9bbd49357c649d93042396b44,"datasette-auth-tokens improved description

Refs https://github.com/simonw/datasette-auth-tokens/issues/1",676bb64c877d73f8ff496cef4632f5a8a5a9283c,False,docs/ecosystem.rst
4691228a81550818fe7d4b43f67c76da2640687f,"Fix for version color in nav, refs #892",ee0ef016523a765b6ef6eaa43cad9ad568f78ae4,False,docs/_static/css/custom.css
12c0bc09cc4bf9addde20f3d46613de11f27c641,"/-/allow-debug tool, closes #908",6be5654ffab282e8cf39cc138ba2d4496ebc7407,False,datasette/app.py;datasette/templates/allow_debug.html;datasette/views/special.py;docs/authentication.rst;tests/test_permissions.py
092874202c8748d6e0d4800eaf707c0145d95ffe,"Improvements to allow block logic and debug tool

true and false allow block values are now supported, closes #906

Added a bunch of demo links to the documentation, refs #908",88065fb74fb2ca66ebb0c1a0a5a75ca13c25405f,False,datasette/templates/allow_debug.html;datasette/utils/__init__.py;docs/authentication.rst;tests/test_utils.py
c5c12a797f0b81cd5862dcd50354b4b571e9bf5a,"Update pytest requirement from <5.5.0,>=5.2.2 to >=5.2.2,<6.1.0 (#910)

Updates the requirements on [pytest](https://github.com/pytest-dev/pytest) to permit the latest version.
- [Release notes](https://github.com/pytest-dev/pytest/releases)
- [Changelog](https://github.com/pytest-dev/pytest/blob/master/CHANGELOG.rst)
- [Commits](https://github.com/pytest-dev/pytest/compare/5.2.2...6.0.0)

Signed-off-by: dependabot-preview[bot] <support@dependabot.com>

Co-authored-by: dependabot-preview[bot] <27856297+dependabot-preview[bot]@users.noreply.github.com>",3c33b421320c0be81a625ca7307b2e4416a9ed5b,False,setup.py
0748a65a22302640ec7520a19aaba280b5615930,"Fixed content-disposition header on DB download, closes #909",c5c12a797f0b81cd5862dcd50354b4b571e9bf5a,False,datasette/utils/asgi.py;datasette/views/base.py;tests/test_csv.py;tests/test_html.py
2d7fa8b9058dfbf9c7c371cdeec115d32a177dc9,"Use None as a default arg (#901)

Thanks, @fcatus!

* Use None as a default arg
* Black formatting fix

Co-authored-by: Simon Willison <swillison@gmail.com>",d71b0c0cb951e973d2d1d1a2540961f19aa9eb00,False,datasette/filters.py;datasette/utils/__init__.py
de90b7568c5db7bbd5979b2551758ab857ad342d,Fixed incorrect link reference,602390081c3aba7635cd4aa3d06a2f0a8821e17f,False,docs/publish.rst
7f10f0f7664d474c1be82bf668829e3b736a3d2b,Fix for security issue #918,de90b7568c5db7bbd5979b2551758ab857ad342d,False,datasette/templates/query.html;tests/test_canned_queries.py
b597aa07e6dd95216f240cbc4ac76d03ae2e841e,"Fixed link in release notes, refs #918",f25391de1f107db3c70ae3e298bd1145ec487671,False,docs/changelog.rst
fca723ab2ab7c162a5e62d85d28d73f73cf40bcb,Fixed order of master and main in release notes,2955e7ea51f49e4353bda0c4eeb67537cfd06996,False,docs/changelog.rst
be1fcd34b33d32e2276ceb81e2abef4a82cda1f8,"Link to GitHub Discussions

Also fixed a couple of master => main",fca723ab2ab7c162a5e62d85d28d73f73cf40bcb,False,README.md
f7fddc9019516c4702416fe4cdb05a07ac214b61,"Fixed typo in help text, refs #925",01fe5b740171bfaea3752fc5754431dac53777e3,False,datasette/cli.py
83eda049af3f38d4289118d3576f96b2535084b1,Fixed rST bug,afdeda8216d4d3027f87583ccdbef17ad85022ef,False,docs/installation.rst
309d7191a1e4e321b4f44345105a696001d65593,Fixed broken rST link,cd8c79d30ac38639a7904a0fd01518121bcaadf1,False,docs/plugin_hooks.rst
e3e387fae78ea6c4c60d30303dc5a010d73c68d1,"Fixed URLs to SpatiaLite files, refs #931",b8c09a9334faabeeba728a64fb28226ccf163400,False,Dockerfile
13b3b51087964d5e1a8c1cdd2495e07bdbe176b8,"Release 0.47.3

Refs #934, https://github.com/simonw/latest-datasette-with-all-plugins/issues/3",45414f8412a8333d70a11bf8f0677ed9efc3c1fc,False,docs/changelog.rst
b86f94883b1d827f85b07009e8346b8e9c6eeefa,"Don't hang in db.execute_write_fn() if connection fails

Closes #935

Refs https://github.com/simonw/latest-datasette-with-all-plugins/issues/3",13b3b51087964d5e1a8c1cdd2495e07bdbe176b8,False,datasette/database.py;setup.py;tests/test_internals_database.py
8e7e6458a6787a06a4488798bd643dd7728b8a5b,"Fix bug with ?_nl=on and binary data, closes #914",3a4c8ed36aa97211e46849d32a09f2f386f342dd,False,datasette/renderer.py;tests/fixtures.py;tests/test_api.py;tests/test_html.py
86aefc39c5aca01b00dbc57ba386a6743c21fb46,Fixed undefined reference in index.rst,69033c6ec4a76d720e5c866aaa43b175c5ec1d8b,False,docs/index.rst
d0c752d50c9ddd1d094a26837347c970a9b34872,"Fixed a couple of tiny HTML bugs, thanks curlylint

    curlylint datasette/templates

https://github.com/thibaudcolas/curlylint",a648bb82bac201c7658f6fdb499ff8ac17ebd2e8,False,datasette/templates/patterns.html;datasette/templates/row.html
d02f6151dae073135a22d0123e8abdc6cbef7c50,"datasette --get status code for error pages, closes #947",77521c6cd7828433f9e71dabcceb9455b28593c5,False,datasette/cli.py;docs/getting_started.rst;tests/test_cli_serve_get.py
20b1de86a1e95e3f98215f17a247cba5311007ae,Fix for test I broke in #947,d02f6151dae073135a22d0123e8abdc6cbef7c50,False,tests/conftest.py
3817152e310e2cdb67908686bac730ab802f037d,"Rename default error template to error.html, refs #965",699be7dea9499355d576c16e330b85b90e1aca2a,False,datasette/app.py;datasette/templates/error.html
1552ac931e4d2cf516caac3ceeab4fd24da1510a,"Documented custom error pages, closes #965",3817152e310e2cdb67908686bac730ab802f037d,False,docs/custom_templates.rst
26de3a18bc47bdb152ab5909b2475a1ea202917b,tmate debugging tool,c0249525d7df64471900f93ceb23e63463c46dd0,False,.github/workflows/tmate.yml
853c5fc37011a7bc09ca3a1af287102f00827c82,"Fixed incorrect canned query example, closes #966",cb515a9d75430adaf5e545a840bbc111648e8bfd,False,docs/sql_queries.rst
65ca17d729182277b8fbf81825ec90814ef24d6e,Fix for DeprecationWarning: invalid escape sequence,853c5fc37011a7bc09ca3a1af287102f00827c82,False,datasette/app.py
448d13ea6b15a9c5c9165a4f6049d073f1524a5e,"Fix for MagicParameters error with no POST body, closes #967",65ca17d729182277b8fbf81825ec90814ef24d6e,False,datasette/views/database.py;tests/test_canned_queries.py
a258339a935d8d29a95940ef1db01e98bb85ae63,Fixed typo,368be14c8bbb4cec607b89dcf677d089d743b649,False,docs/changelog.rst
cac051bb8aab88431c596d5ca321086df273164c,"Fix for 'open' bug, closes #973",a980199e61fe7ccf02c2123849d86172d2ae54ff,False,datasette/cli.py;tests/test_cli.py
1f021c37110fc9019b0ef70062c28c335e568ae2,"Update pytest requirement from <6.1.0,>=5.2.2 to >=5.2.2,<6.2.0 (#977)

Updates the requirements on [pytest](https://github.com/pytest-dev/pytest) to permit the latest version.
- [Release notes](https://github.com/pytest-dev/pytest/releases)
- [Changelog](https://github.com/pytest-dev/pytest/blob/master/CHANGELOG.rst)
- [Commits](https://github.com/pytest-dev/pytest/compare/5.2.2...6.1.0)

Signed-off-by: dependabot-preview[bot] <support@dependabot.com>

Co-authored-by: dependabot-preview[bot] <27856297+dependabot-preview[bot]@users.noreply.github.com>",9a6d0dce282e7fb58c5610e24c74098c923abfdc,False,setup.py
c11383e6284e000b2641569457efa16ac9e0d6ae,"Fix rendering glitch with columns on mobile, closes #978",1f021c37110fc9019b0ef70062c28c335e568ae2,False,datasette/utils/__init__.py;tests/test_utils.py
97c71c3a3b2916bffa6081995ebccc2fa137c6d5,"Fixed test for column sorting, refs #981",ae1f7c3870001561392be85d2f4cd4d2aaf32d59,False,tests/test_html.py
ca5ba6b77b4c973fa7ba91008a2e99debfa306b4,"Document setting Google Cloud SDK properties (#995)

Document setting Google Cloud SDK properties to avoid having to respond to interactive prompts when running `datasette publish cloudrun`.

Thanks, @ghing!",5a184a5d211d3226e0417ee5cf8476cd887cd35e,False,docs/publish.rst
507042581794a48b71b5a4b5e0f1ddcde6783c00,"Fix handling of nested custom page wildcard paths, closes #996",b37431976cdc39ad46ae4fc60b12be6e1f993bd2,False,datasette/app.py;tests/test_custom_pages.py;tests/test_templates/pages/topic_{topic}.html;tests/test_templates/pages/topic_{topic}/{slug}.html
8f97b9b58e77f82fef1f10e9c9f6754b993544b6,"datasette.client internal requests mechanism

Closes #943

* Datasette now requires httpx>=0.15
* Support OPTIONS without 500, closes #1001
* Added internals tests for datasette.client methods
* Datasette's own test mechanism now uses httpx to simulate requests
* Tests simulate HTTP 1.1 now
* Added base_url in a bunch more places
* Mark some tests as xfail - will remove that when new httpx release ships: #1005",7249ac5ca04b5ddc6517750326ee7e522cc49145,False,datasette/app.py;datasette/cli.py;datasette/templates/_table.html;datasette/templates/query.html;datasette/templates/row.html;datasette/templates/table.html;datasette/utils/testing.py;datasette/views/base.py;setup.py;tests/fixtures.py;tests/test_api.py;tests/test_auth.py;tests/test_cli.py;tests/test_config_dir.py;tests/test_html.py;tests/test_internals_datasette_client.py;tests/test_messages.py;tests/test_plugins.py
6421ca2b22a8ebd801ca17b2ea38a98d353f1faa,"Use actions/setup-python@v2 to deploy latest

This should fix an error with Python 3.9.",896cc2c6acfefa65c54a162831e7f09159603988,False,.github/workflows/deploy-latest.yml
c13d184704a74654befe061500f55ca61f29ef1b,"Emergency fix for broken links in 0.50, closes #1010",549a007683e38fd13da72be7b2f5ee1adb1484c5,False,datasette/templates/row.html;datasette/templates/table.html;tests/test_html.py
9f6dd985bc0eff70f8a9ce65c6578bc43d2e172b,"Fix broken CSV/JSON export on query page, refs #1010",c13d184704a74654befe061500f55ca61f29ef1b,False,datasette/templates/query.html;tests/test_html.py
7239175f63d150356a7f795cc4cabf7764d2cf68,"Fixed broken column header links, closes #1011",6fe30c348c58a0bc312552fd7a889731427b86e5,False,datasette/templates/_table.html;tests/test_html.py;tests/test_plugins.py
7e7064385270dda09dc2aa396d290369a667a03f,"Removed --debug option, which didn't do anything - closes #814",822260fb30c9a6726a36975c9b8b26148bd66818,False,README.md;datasette/cli.py;docs/changelog.rst;docs/datasette-serve-help.txt;tests/test_cli.py
b4a8e70957517ff44d6a9121422d266a3c5fd664,"Update asgiref requirement from ~=3.2.10 to >=3.2.10,<3.4.0 (#1018)

Updates the requirements on [asgiref](https://github.com/django/asgiref) to permit the latest version.
- [Release notes](https://github.com/django/asgiref/releases)
- [Changelog](https://github.com/django/asgiref/blob/master/CHANGELOG.txt)
- [Commits](https://github.com/django/asgiref/compare/3.2.10...3.3.0)

Signed-off-by: dependabot-preview[bot] <support@dependabot.com>

Co-authored-by: dependabot-preview[bot] <27856297+dependabot-preview[bot]@users.noreply.github.com>",f3a087a578ae2c418103ad144b08c2fc8ad9c31d,False,setup.py
7f2edb5dd2074dce0090659021991695a984844b,"Update janus requirement from <0.6,>=0.4 to >=0.4,<0.7 (#1017)

Updates the requirements on [janus](https://github.com/aio-libs/janus) to permit the latest version.
- [Release notes](https://github.com/aio-libs/janus/releases)
- [Changelog](https://github.com/aio-libs/janus/blob/master/CHANGES.rst)
- [Commits](https://github.com/aio-libs/janus/compare/v0.4.0...v0.6.0)

Signed-off-by: dependabot-preview[bot] <support@dependabot.com>

Co-authored-by: dependabot-preview[bot] <27856297+dependabot-preview[bot]@users.noreply.github.com>",b4a8e70957517ff44d6a9121422d266a3c5fd664,False,setup.py
4f7c0ebd85ccd8c1853d7aa0147628f7c1b749cc,"Fix table name in spatialite example command (#1022)

The example query for creating a new point geometry seems to be using a table called 'museums' but at one point it instead uses 'events'. I *believe* it is intended to be museums.",7f2edb5dd2074dce0090659021991695a984844b,False,docs/spatialite.rst
568bd7bbf590861687db8c318f3d8cfcd1dfb47a,Fix broken link in publish docs (#1029),4f7c0ebd85ccd8c1853d7aa0147628f7c1b749cc,False,docs/publish.rst
b0b04bb7c185bed9bdbb9a3f3f24f264999296b6,"Delete .readthedocs.yml

It worked fine without configuration, and my attempt to build the xml version failed with an error message:

    Problem in your project's configuration. Invalid ""formats"": expected one of (htmlzip, pdf, epub), got xml",a0e9ae3c258c62221f8603e2944265f27ba07c14,False,.readthedocs.yml
091441a4449beae559a8c0d007376dc85d3aa624,"Fixed remaining places that needed datasette.urls, closes #1025",0d1763fb2fdabcdde321646721703df1dfcb8597,False,datasette/app.py;datasette/cli.py;datasette/templates/logout.html;datasette/templates/messages_debug.html;datasette/views/base.py;datasette/views/special.py;docs/config.rst;tests/test_html.py
6e26b057996c6f3fefa8ad528e2759e53c738844,"Fix syntax error in register_routes docs (#1038)

Thanks, @gerrymanoim",bf82b3d6a605c9ddadd5fb739249dfe6defaf635,False,docs/plugin_hooks.rst
d0cc6f4c32e1f89238ddec782086b3122f445bd4,"Use sphinx-to-sqlite==0.1a1

To address this bug: https://github.com/simonw/sphinx-to-sqlite/issues/2",20f8659e2a6cc6fce82cd52d282ddaf798063eb0,False,.github/workflows/deploy-latest.yml
29a977a74e19f8f03c3620786ef007430a3d112b,New app_client_base_url_prefix fixture,d3e9b0aecb6f8e9b2befd9c654ccb7ce852db3e7,False,tests/fixtures.py;tests/test_html.py
a96ad967e4b2adf3d0e056a6f785eefbb1a13620,Cleaned up some rogue full-stops,5a1519796037105bc20bcf2f91a76e022926c204,False,docs/internals.rst
105a2c10fdb5134e7ba141e872636aee47cdcf1d,"Fix z-index issue with dropdown menu, closes #1052",42f4851e3e7885f1092f104d6c883cea40b12f02,False,datasette/static/app.css
f49d15a7583fafb94e7a7fcfe504d333812139f3,word-break: break-word;,dab4b73f7d76f43e67ae1e2b74921f62db71925c,False,datasette/static/app.css
e5f5034bcdc71e4bc62a6a155ca60eb41910c335,Fixed broken footer test,e7dd3434e1f3f20129798bcea1a629717eec1649,False,tests/test_html.py
89519f9a3765bce7544d83d872db987c75757d9a,"Fixed bug with download of BLOB null, refs #1050",cefd058c1c216a184bb63c79abba66893977c18e,False,datasette/views/table.py;tests/fixtures.py;tests/test_api.py;tests/test_html.py
1a861be19e326e0c88230a711a1b6536366697d7,"Fixed test_max_csv_mb test that I just broke, refs #1063",178b7e8749f14300363af5961e9f8964595264d9,False,tests/test_csv.py
222f79bb4c6e2aa5426cc5ff25f1b2461e18a300,"debug-menu permission, closes #1068

Also added tests for navigation menu logic.",9f0987cb57a82a7d2fe0c679fc909e5b39593ee4,False,datasette/default_menu_links.py;datasette/default_permissions.py;datasette/views/special.py;docs/authentication.rst;tests/test_html.py;tests/test_permissions.py
0cb29498c796267c5e4a5545ede8058b7ca03a94,"Fixed bug with python tests/fixtures.py

https://github.com/simonw/datasette/runs/1333357885?check_suite_focus=true",a7d9e24ece665eef7c6dfc5f32855c98bd45d335,False,datasette/views/base.py
7a67bc7a569509d65b3a8661e0ad2c65f0b09166,"datasette.urls methods will not apply base_url prefix twice, refs #1026",c1d386ef67786f07d69e566b8e054e92949a844f,False,datasette/url_builder.py;datasette/utils/__init__.py;docs/internals.rst;tests/test_internals_urls.py
bf18b9ba175a7b25fb8b765847397dd6efb8bb7b,"Stop using plugin-example.com, closes #1074",84bc7244c106ab6175b8315a2d917cf29ea53c4d,False,tests/plugins/my_plugin.py;tests/plugins/my_plugin_2.py;tests/test_html.py;tests/test_plugins.py
a4ca26a2659d21779adf625183061d8879954c15,Address PrefixedUrlString bug in #1075,bf18b9ba175a7b25fb8b765847397dd6efb8bb7b,False,datasette/app.py;datasette/utils/__init__.py;tests/fixtures.py;tests/test_api.py;tests/test_cli_serve_get.py;tests/test_html.py
6bb41c4b33dbd1015c181cd43465b645298c3c88,Fix for test_paginate_using_link_header,a4ca26a2659d21779adf625183061d8879954c15,False,tests/test_api.py
e8e0a6f284ca953b2980186c4356594c07bd1929,"Use FTS4 in fixtures

Closes #1081",2a981e2ac1d13125973904b777d00ea75e8df4e6,False,tests/fixtures.py;tests/test_api.py;tests/test_internals_database.py
253f2d9a3cc96edcb47b33c6971300d0ff15d4dc,"Use correct QueryInterrupted exception on row page, closes #1088",e8e0a6f284ca953b2980186c4356594c07bd1929,False,datasette/views/table.py
6fd35be64de221eba4945ca24e8e1678f6142a73,Fixed invalid JSON in exampl,200284e1a7541af62c7df5467acfb7edd0ee934a,False,docs/plugins.rst
4bac9f18f9d04e5ed10f072502bcc508e365438e,"Fix off-screen action menu bug, refs #1084",30e64c8d3b3728a86c3ca42a75322cc3feb5b0c8,False,datasette/static/app.css
bbde835a1fec01458e8d00929e7bab6d6a5ba948,"Fix --metadata doc usage (#1112)

Thanks, @jefftriplett.",37d18a5bce08c9ee53c080f613bae84fc2ccc853,False,docs/changelog.rst;docs/settings.rst
50cc6af01672526791900df7c8834a62fa094852,"Fixed some broken internal links, refs #1106",bbde835a1fec01458e8d00929e7bab6d6a5ba948,False,docs/changelog.rst;docs/csv_export.rst;docs/deploying.rst;docs/pages.rst;docs/performance.rst
deb0be4ae56f191f121239b29e83dd53b62d6305,"Fix bug where compound foreign keys produced broken links, closes #1098",e800ffcf7cc6a915eb554b369c654f87162575e5,False,datasette/utils/__init__.py;tests/fixtures.py;tests/test_api.py;tests/test_csv.py;tests/test_html.py;tests/test_internals_database.py
4777362bf2692bc72b221ec47c3e6216151d1b89,"Work around CI bug with ensure_eventloop, refs #1115",09033c08bec8555e0e893e077afa10a7a75d7d35,False,tests/test_cli.py
dea3c508b39528e566d711c38a467b3d372d220b,"Revert ""Support for generated columns, closes #1116"" - it failed CI

This reverts commit 37f87b5e52e7f8ddd1c4ffcf368bd7a62a406a6d.",37f87b5e52e7f8ddd1c4ffcf368bd7a62a406a6d,False,datasette/utils/__init__.py;tests/test_api.py;tests/test_internals_database.py
49b6297fb7513291110d86688c688700e6f6d9cc,"Typo fix: messagge_is_html, closes #1118",dea3c508b39528e566d711c38a467b3d372d220b,False,datasette/app.py;datasette/views/base.py
17cbbb1f7f230b39650afac62dd16476626001b5,"generated_columns table in fixtures.py, closes #1119",461670a0b87efa953141b449a9a261919864ceb3,False,datasette/utils/__init__.py;datasette/utils/sqlite.py;tests/fixtures.py;tests/test_api.py;tests/test_internals_database.py;tests/test_plugins.py
daae35be46ec5cb8a207aa20986a4fa62e94777e,"Fix misaligned table actions cog

Closes #1121. Thanks, @abdusco",88ac538b41a4753c3de9b509c3a0e13077f66182,False,datasette/static/app.css
a45a3dff3ea01a2382dcedae5923a7b821a12aec,"Fix for OPTIONS request against /db, closes #1100",daae35be46ec5cb8a207aa20986a4fa62e94777e,False,datasette/utils/testing.py;datasette/views/base.py;tests/test_api.py
6b4c55efea3e9d34d92cbe5f0066553ad9b14071,"Fix for Amazon Linux static assets 404ing, refs #1124",e048791a9a2686f47d81a2c8aa88aa1966d82521,False,datasette/utils/asgi.py
42efb799ea9b362f0c7598f3ff3c4bf46c18e53f,"Fixed invalid test for generated columns, refs #1119",49d8fc056844d5a537d6cfd96dab0dd5686fe718,False,tests/test_api.py
eae103a82b92949189cf718794d2ad0424005460,"Write errors to stderr, closes #1131",42efb799ea9b362f0c7598f3ff3c4bf46c18e53f,False,datasette/database.py;datasette/renderer.py;datasette/views/base.py;tests/test_cli.py
705d1a1555c4791e9be3b884285b047223ab184f,"Fix startup error on windows (#1128)

Fixes https://github.com/simonw/datasette/issues/1094

This import isn't used at all, and causes error on startup on Windows.",eae103a82b92949189cf718794d2ad0424005460,False,datasette/utils/asgi.py
e5930e6f889617320454ab53ecc1c438377d49e6,Typo fix in release notes,2dc281645a76c550789ede80c1bc6f733fa9a82e,False,docs/changelog.rst
62a6f70c64e4d04c15d9f386dcdf9cd465bbb0f6,"Fixed Markdown indentation of news

To make it easier to programmatically extract.",e3143700a245d87bc532d44867b2e380b4225324,False,README.md
8ae0f9f7f0d644b0161165a1084f53acd2786f7c,Fixed spelling of Janary,62a6f70c64e4d04c15d9f386dcdf9cd465bbb0f6,False,README.md
6000d1a724d0e28cdb102e7be83eac07a00b41e8,"Fix for combining ?_search_x and ?_searchmode=raw, closes #1134",fe86d853089f324f92daa950cc56f4052bf78f98,False,datasette/views/table.py;tests/test_api.py
4c6407cd74070237fdad0dd6df4d016740806fbd,"Releasing bug fixes from a branch, closes #1136",387b471b88788069191bc845224b7712d92e9c0b,False,docs/contributing.rst
6119bd797366a899119f1bba51c1c8cba2efc8fc,"Update pytest requirement from <6.2.0,>=5.2.2 to >=5.2.2,<6.3.0 (#1145)

Updates the requirements on [pytest](https://github.com/pytest-dev/pytest) to permit the latest version.
- [Release notes](https://github.com/pytest-dev/pytest/releases)
- [Changelog](https://github.com/pytest-dev/pytest/blob/master/CHANGELOG.rst)
- [Commits](https://github.com/pytest-dev/pytest/compare/5.2.2...6.2.0)

Signed-off-by: dependabot-preview[bot] <support@dependabot.com>

Co-authored-by: dependabot-preview[bot] <27856297+dependabot-preview[bot]@users.noreply.github.com>",0c616f732cee79db80cad830917666f41b344262,False,setup.py
a882d679626438ba0d809944f06f239bcba8ee96,"Modernize code to Python 3.6+ (#1158)

* Compact dict and set building
* Remove redundant parentheses
* Simplify chained conditions
* Change method name to lowercase
* Use triple double quotes for docstrings

Thanks, @eumiro!",90eba4c3ca569c57e96bce314e7ac8caf67d884e,False,datasette/app.py;datasette/cli.py;datasette/facets.py;datasette/filters.py;datasette/hookspecs.py;datasette/inspect.py;datasette/renderer.py;datasette/utils/__init__.py;datasette/utils/asgi.py;datasette/views/base.py;datasette/views/table.py;tests/fixtures.py;tests/plugins/my_plugin.py;tests/test_api.py;tests/test_auth.py;tests/test_cli.py;tests/test_docs.py;tests/test_permissions.py;tests/test_plugins.py
a93a65b02759e297f5dc0e1039f52d20023d6e9c,"Fixed Prettier formatting, closes #1166",80870911de95738254d13354622b4bdcfbe0aae3,False,datasette/static/table.js
1e8fa3ac7cb2d6e516c47c306c86ed2334fc3dc0,"Only run prettier on changes to datasette/static

Refs #1166",a93a65b02759e297f5dc0e1039f52d20023d6e9c,False,.github/workflows/prettier.yml
3054e0f7307da4c31850b74bd73238b33d6c750a,"Install Prettier via package.json (#1170)

* Error if Prettier isn't already installed
* Temporarily run Prettier check on every commit
* Install and run Prettier via package.json
* Trigger another prettier check on CI",1e8fa3ac7cb2d6e516c47c306c86ed2334fc3dc0,False,.github/workflows/prettier.yml;package-lock.json;package.json
ab7767acbe021ed6ab0a8d4b56ec8b4af6ae9e86,"tmate session mac

So I can test https://github.com/simonw/datasette/issues/93",3054e0f7307da4c31850b74bd73238b33d6c750a,False,.github/workflows/tmate-mac.yml
4c0995ed60034c687c6464e7abdbd6f45eb6d5a2,"Fixed bug in example nginx config, refs #1091",97fb10c17dd007a275ab743742e93e932335ad67,False,docs/deploying.rst
faa76390a02cf35e507ad5381d388295565e9a89,"Fixed bug introduced in e1efa9b7,  refs #1178",4c0995ed60034c687c6464e7abdbd6f45eb6d5a2,False,tests/test_publish_cloudrun.py
640ac7071b73111ba4423812cd683756e0e1936b,"Better PRAGMA error message, closes #1185",8e8fc5cee5c78da8334495c6d6257d5612c40792,False,datasette/utils/__init__.py;docs/sql_queries.rst;tests/test_html.py
5378f023529107ff7edbd6ee4ecab6ac170a83db,Better tool for extracting issue numbers,57f4d7b82f9c74298c67c5640207241925b70c02,False,docs/contributing.rst
a5ede3cdd455e2bb1a1fb2f4e1b5a9855caf5179,"Fixed bug loading database called 'test-database (1).sqlite'

Closes #1181.

Also now ensures that database URLs have special characters URL-quoted.",07e163561592c743e4117f72102fcd350a600909,False,datasette/url_builder.py;datasette/views/base.py;docs/changelog.rst;tests/test_api.py;tests/test_cli.py;tests/test_html.py;tests/test_internals_urls.py
382e9ecd1d429102417b17a1bd75f066cb904e24,Removed a rogue full-stop,0b9ac1b2e9c855f1b823a06a898891da87c720ef,False,docs/changelog.rst
dde3c500c73ace33529672f7d862b76753d309cc,"Using pdb for errors thrown inside Datasette

Closes #1207",1600d2a3ec3ada1f6fb5b1eb73bdaeccb5f80530,False,docs/testing_plugins.rst
beb98bf45488dcb7b8f0a70e13dbf7b2473c998c,Fixed typo in code example,dde3c500c73ace33529672f7d862b76753d309cc,False,docs/testing_plugins.rst
7a2ed9f8a119e220b66d67c7b9e07cbab47b1196,"Fixed bug with ?_sort= and ?_search=, closes #1214",beb98bf45488dcb7b8f0a70e13dbf7b2473c998c,False,datasette/views/table.py;tests/test_html.py
d2d53a5559f3014cccba2cba7e1eab1e5854c759,"New :issue: Sphinx macro, closes #1227",9603d893b9b72653895318c9104d754229fdb146,False,docs/changelog.rst;docs/conf.py
42caabf7e9e6e4d69ef6dd7de16f2cd96bc79d5b,Fixed typo,1f9cca33b41cc93357f9eb347d70ff20b2a4d0d5,False,docs/testing_plugins.rst
726f781c50e88f557437f6490b8479c3d6fabfc2,"Fix for arraycontains bug, closes #1239",42caabf7e9e6e4d69ef6dd7de16f2cd96bc79d5b,False,datasette/filters.py;tests/test_filters.py
cc6774cbaaba2359e0a92cfcc41ad988680075d6,"Upgrade httpx and remove xfail from tests, refs #1005",afed51b1e36cf275c39e71c7cb262d6c5bdbaa31,False,setup.py;tests/test_api.py;tests/test_html.py
4f9a2f1f47dcf7e8561d68a8a07f5009a13cfdb3,"Fix small typo (#1243)

Thanks, @UtahDave",7c87532acc4e9d92caa1c4ee29a3446200928018,False,docs/deploying.rst
d0fd833b8cdd97e1b91d0f97a69b494895d82bee,"Add compile option to Dockerfile to fix failing test (fixes #696) (#1223)

This test was failing when run inside the Docker container:
`test_searchable[/fixtures/searchable.json?_search=te*+AND+do*&_searchmode=raw-expected_rows3]`,

with this error:

```
    def test_searchable(app_client, path, expected_rows):
        response = app_client.get(path)
>       assert expected_rows == response.json[""rows""]
E       AssertionError: assert [[1, 'barry c...sel', 'puma']] == []
E         Left contains 2 more items, first extra item: [1, 'barry cat', 'terry dog', 'panther']
E         Full diff:
E         + []
E         - [[1, 'barry cat', 'terry dog', 'panther'],
E         -  [2, 'terry dog', 'sara weasel', 'puma']]
```

The issue was that the version of sqlite3 built inside the Docker
container was built with FTS3 and FTS4 enabled, but without the
`SQLITE_ENABLE_FTS3_PARENTHESIS` compile option passed, which adds
support for using `AND` and `NOT` within `match` expressions (see
https://sqlite.org/fts3.html#compiling_and_enabling_fts3_and_fts4 and
https://www.sqlite.org/compile.html).

Without this, the `AND` used in the search in this test was being
interpreted as a literal string, and so no matches were found. Adding
this compile option fixes this.

Thanks, @bobwhitelock",4f9a2f1f47dcf7e8561d68a8a07f5009a13cfdb3,False,Dockerfile
6ad544df5e6bd027a8e27317041e6168aee07459,"Fixed master -> main in a bunch of places, mainly docs",c4f1ec7f33fd7d5b93f0f895dafb5351cc3bfc5b,False,datasette/cli.py;datasette/publish/common.py;datasette/templates/patterns.html;docs/contributing.rst;docs/custom_templates.rst;docs/datasette-package-help.txt;docs/datasette-publish-cloudrun-help.txt;docs/datasette-publish-heroku-help.txt;docs/plugin_hooks.rst;docs/publish.rst;docs/spatialite.rst;tests/fixtures.py;tests/test_html.py
3fcfc8513465339ac5f055296cbb67f5262af02b,"Fix links in SpatiaLite tutorial, closes #1278",8ebdcc916d556f7fb7fc2bbbb56904a6d8e1936c,False,docs/spatialite.rst
48d5e0e6ac8975cfd869d4e8c69c64ca0c65e29e,"Fix for no such table: pragma_database_list, refs #1276",3fcfc8513465339ac5f055296cbb67f5262af02b,False,datasette/database.py
e72397d65b06b019521b6411243687464ac8d8ca,"Add styling to lists within table cells (fixes #1141) (#1252)

This overrides the Datasette reset (see
https://github.com/simonw/datasette/blob/d0fd833b8cdd97e1b91d0f97a69b494895d82bee/datasette/static/app.css#L35-L38),
to add back the default styling of list items displayed within Datasette
table cells.",c96a3826cf50cb347f6a415b56d8105ba6d8dcb0,False,datasette/static/app.css
d579fcf4f713f98c7365453ce94f36b91ce98c98,Applied some fixes suggested by @withshubh in #1260,f92d823766872a6fd7e76c5249a6b2de1ab0f447,False,datasette/app.py;tests/plugins/my_plugin.py
8291065b13bf2a4af27d61a971a9ba96aff59417,"Hopeful fix for Docker tag error, refs #1281",849c4f06ea766ccdb664eab4e82b80be574a0f03,False,.github/workflows/push_docker_tag.yml
7b1a9a1999eb9326ce8ec830d75ac200e5279c46,Fix little typo (#1282),0486303b60ce2784fd2e2ecdbecf304b7d6e6659,False,datasette/static/app.css
87b583a128986982552421d2510e467e74ac5046,"Clearer help text for --reload

Immutable databases are not commonly used, but it's useful to clarify
that --reload will pick up on changes to metadata.",7b1a9a1999eb9326ce8ec830d75ac200e5279c46,False,README.md;datasette/cli.py;docs/datasette-serve-help.txt
1b697539f5b53cec3fe13c0f4ada13ba655c88c7,"Bump black from 20.8b1 to 21.4b2 (#1313)

Bumps [black](https://github.com/psf/black) from 20.8b1 to 21.4b2.
- [Release notes](https://github.com/psf/black/releases)
- [Changelog](https://github.com/psf/black/blob/master/CHANGES.md)
- [Commits](https://github.com/psf/black/commits)

Signed-off-by: dependabot-preview[bot] <support@dependabot.com>

Co-authored-by: dependabot-preview[bot] <27856297+dependabot-preview[bot]@users.noreply.github.com>",5e60bad40460f68122006ce704cfc163d6076f34,False,setup.py
9b3b7e280ca718254b4ca15d40864297146a85b3,"Update jinja2 requirement from <2.12.0,>=2.10.3 to >=2.10.3,<3.1.0 (#1324)

Updates the requirements on [jinja2](https://github.com/pallets/jinja) to permit the latest version.
- [Release notes](https://github.com/pallets/jinja/releases)
- [Changelog](https://github.com/pallets/jinja/blob/main/CHANGES.rst)
- [Commits](https://github.com/pallets/jinja/compare/2.10.3...3.0.0)

Signed-off-by: dependabot[bot] <support@github.com>

Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",1b697539f5b53cec3fe13c0f4ada13ba655c88c7,False,setup.py
459259175eddeed727fd8f08dc19a332779a4f6b,Fix small typo (#1335),9b3b7e280ca718254b4ca15d40864297146a85b3,False,docs/settings.rst
b64d87204612a84663616e075f542499a5d82a03,"Update itsdangerous requirement from ~=1.1 to >=1.1,<3.0 (#1325)

Updates the requirements on [itsdangerous](https://github.com/pallets/itsdangerous) to permit the latest version.
- [Release notes](https://github.com/pallets/itsdangerous/releases)
- [Changelog](https://github.com/pallets/itsdangerous/blob/main/CHANGES.rst)
- [Commits](https://github.com/pallets/itsdangerous/compare/1.1.0...2.0.0)

Signed-off-by: dependabot[bot] <support@github.com>

Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",593d3e8173b45e20ff3c95afb3df7ceb85bf7fef,False,setup.py
5c3b3ef97eed55895cf48d4a9ee0635c1c4d03b8,"Update click requirement from ~=7.1.1 to >=7.1.1,<8.1.0 (#1323)

Updates the requirements on [click](https://github.com/pallets/click) to permit the latest version.
- [Release notes](https://github.com/pallets/click/releases)
- [Changelog](https://github.com/pallets/click/blob/main/CHANGES.rst)
- [Commits](https://github.com/pallets/click/compare/7.1.1...8.0.0)

Signed-off-by: dependabot[bot] <support@github.com>

Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",b64d87204612a84663616e075f542499a5d82a03,False,setup.py
5e9672c9bb33e41686472db4aa427168f9e67dbe,"Bump black from 21.4b2 to 21.5b1 (#1321)

Bumps [black](https://github.com/psf/black) from 21.4b2 to 21.5b1.
- [Release notes](https://github.com/psf/black/releases)
- [Changelog](https://github.com/psf/black/blob/main/CHANGES.md)
- [Commits](https://github.com/psf/black/commits)

Signed-off-by: dependabot[bot] <support@github.com>

Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",5c3b3ef97eed55895cf48d4a9ee0635c1c4d03b8,False,setup.py
2bd9d54b2762c991e11950c22c88c0336158d49b,"Fix Jinja warnings, closes #1338, refs #1331",a443dba82f43c22b03402a4f86c85558ccb526b8,False,datasette/app.py;datasette/views/database.py;datasette/views/table.py;docs/plugin_hooks.rst;tests/plugins/my_plugin_2.py
eae3084b46e2c3931db12cdef79093ad0e644bce,"Fixed another Jinja warning, refs #1338",2bd9d54b2762c991e11950c22c88c0336158d49b,False,datasette/app.py
c0a748e5c3f498fa8c139b420d07dd3dea612379,"Markup fix, refs #1320",56af118fc158a59a98688f2caa6f01db6b68da83,False,docs/installation.rst
f1c29fd6a184254aa68efadf096bcf21e848f921,"?_col=/?_nocol= to show/hide columns on the table page

Closes #615

* Cog icon for hiding columns
* Show all columns cog menu item
* Do not allow hide column on primary keys
* Allow both ?_col= and ?_nocol=
* De-duplicate if ?_col= passed multiple times
* 400 error if user tries to ?_nocol= a primary key
* Documentation for ?_col= and ?_nocol=",c0a748e5c3f498fa8c139b420d07dd3dea612379,False,datasette/static/table.js;datasette/views/table.py;docs/json_api.rst;tests/test_api.py
f7d3e76fb3d1fa5aabe339251e4a930610643822,"Facets now execute ignoring ?_col and ?_nocol, fixes #1345",7b106e106000713bbee31b34d694b3dadbd4818c,False,datasette/views/table.py;tests/test_api.py
03b35d70e281ea48bd9b8058738ed87b13cea2de,"Bump black from 21.5b1 to 21.5b2 (#1352)

Bumps [black](https://github.com/psf/black) from 21.5b1 to 21.5b2.
- [Release notes](https://github.com/psf/black/releases)
- [Changelog](https://github.com/psf/black/blob/main/CHANGES.md)
- [Commits](https://github.com/psf/black/commits)

Signed-off-by: dependabot[bot] <support@github.com>

Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",0539bf0816b58c7f0ba769331f1509656bff3619,False,setup.py
0f1e47287cf2185e140bd87a03c985c2a7afb450,"Fixed bug with detect_fts for table with single quote in name, closes #1257",807de378d08752a0f05bb1b980a0a62620a70520,False,datasette/utils/__init__.py;tests/test_utils.py
9552414e1f968c6fc704031cec349c05e6bc2371,"Re-display user's query with an error message if an error occurs (#1346)

* Ignore _shape when returning errors",0f1e47287cf2185e140bd87a03c985c2a7afb450,False,datasette/renderer.py;datasette/templates/query.html;datasette/views/base.py;datasette/views/database.py;tests/test_canned_queries.py
ea5b2378007ef524f7a17989c8df54a76a001e49,"Show error message on bad query, closes #619",9552414e1f968c6fc704031cec349c05e6bc2371,False,datasette/templates/query.html;tests/test_html.py
f40d1b99d67b0da4f3aff5b3483f4e09db7e8e6b,"Don't show '0 results' on error page, refs #619",ea5b2378007ef524f7a17989c8df54a76a001e49,False,datasette/templates/query.html;tests/test_html.py
0f41db1ba8a8a49a4adc1046a25ccf32790e863f,"Avoid error sorting by relationships if related tables are not allowed

Refs #1306",f40d1b99d67b0da4f3aff5b3483f4e09db7e8e6b,False,datasette/views/index.py
80d8b0eb415faf5caadd7cc7036407e6ee55bd44,"Test demonstrating fixed #1305, refs #1306",0f41db1ba8a8a49a4adc1046a25ccf32790e863f,False,tests/test_html.py
a63412152518581c6a3d4e142b937e27dabdbfdb,"Make custom pages compatible with base_url setting

Closes #1238

- base_url no longer causes custom page routing to fail
- new route_path key in request.scope storing the path that was used for routing with the base_url prefix stripped
- TestClient used by tests now avoids accidentally double processing of the base_url prefix",6e9b07be92905011211d8df7a872fb7c1f2737b2,False,datasette/app.py;datasette/utils/testing.py;tests/test_custom_pages.py;tests/test_html.py
368aa5f1b16ca35f82d90ff747023b9a2bfa27c1,"Update docs: explain allow_download setting (#1291)

* Update docs: explain allow_download setting

This fixes one possible source of confusion seen in #502 and clarifies
when database downloads will be shown and allowed.",a63412152518581c6a3d4e142b937e27dabdbfdb,False,docs/settings.rst
ff29dd55fafd7c3d27bd30f40945847aa4278309,"?_trace=1 now depends on trace_debug setting, closes #1359",368aa5f1b16ca35f82d90ff747023b9a2bfa27c1,False,.github/workflows/deploy-latest.yml;datasette/app.py;docs/json_api.rst;docs/settings.rst;tests/fixtures.py;tests/test_api.py;tests/test_csv.py
030deb4b25cda842ff7129ab7c18550c44dd8379,"Try to handle intermittent FileNotFoundError in tests

Refs #1361",0dfb9241718139f8ad626d22aac25bcebd3a9c9c,False,tests/conftest.py
f4c5777c7e4ed406313583de09a3bf746552167f,"Fix visual glitch in nav menu, closes #1367",03ec71193b9545536898a4bc7493274fec48bdd7,False,datasette/static/app.css
e7975657656ce02717f03703bb8ec17f2fe9b717,"Bump black from 21.5b2 to 21.6b0 (#1374)

Bumps [black](https://github.com/psf/black) from 21.5b2 to 21.6b0.
- [Release notes](https://github.com/psf/black/releases)
- [Changelog](https://github.com/psf/black/blob/main/CHANGES.md)
- [Commits](https://github.com/psf/black/commits)

---
updated-dependencies:
- dependency-name: black
  dependency-type: direct:development
...

Signed-off-by: dependabot[bot] <support@github.com>

Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",cd7678fde65319d7b6955ce9f4678ba4b9e64b66,False,setup.py
5335f360f4d57d70cab3694b08f15729c4ca2fe2,"Update pytest-xdist requirement from <2.3,>=2.2.1 to >=2.2.1,<2.4 (#1378)

Updates the requirements on [pytest-xdist](https://github.com/pytest-dev/pytest-xdist) to permit the latest version.
- [Release notes](https://github.com/pytest-dev/pytest-xdist/releases)
- [Changelog](https://github.com/pytest-dev/pytest-xdist/blob/master/CHANGELOG.rst)
- [Commits](https://github.com/pytest-dev/pytest-xdist/compare/v2.2.1...v2.3.0)

---
updated-dependencies:
- dependency-name: pytest-xdist
  dependency-type: direct:development
...

Signed-off-by: dependabot[bot] <support@github.com>

Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",83e9c8bc7585dcc62f200e37c2daefcd669ee05e,False,setup.py
7bc85b26d6b9c865caf949ff4660d855526c346e,"Deploy stable-docs.datasette.io on publish

Refs https://github.com/simonw/datasette.io/issues/67",a6c55afe8c82ead8deb32f90c9324022fd422324,False,.github/workflows/publish.yml
403e370e5a3649333812edbbcba8467e6134cc16,Fixed reference to default publish implementation,7bc85b26d6b9c865caf949ff4660d855526c346e,False,docs/plugin_hooks.rst
953a64467d78bca29fe6cc18bdb2baa7848e53ff,"Only publish stable docs on non-preview release

Refs https://github.com/simonw/datasette.io/issues/67",ff17970ed4988a80b699d417bbeec07d63400e24,False,.github/workflows/publish.yml
baf986c871708c01ca183be760995cf306ba21bf,"New get_metadata() plugin hook for dynamic metadata

The following hook is added:

    get_metadata(
      datasette=self, key=key, database=database, table=table,
      fallback=fallback
    )

This gets called when we're building our metdata for the rest
of the system to use. We merge whatever the plugins return
with any local metadata (from metadata.yml/yaml/json) allowing
for a live-editable dynamic Datasette.

As a security precation, local meta is *not* overwritable by
plugin hooks. The workflow for transitioning to live-meta would
be to load the plugin with the full metadata.yaml and save.
Then remove the parts of the metadata that you want to be able
to change from the file.

* Avoid race condition: don't mutate databases list

This avoids the nasty ""RuntimeError: OrderedDict mutated during
iteration"" error that randomly happens when a plugin adds a
new database to Datasette, using `add_database`. This change
makes the add and remove database functions more expensive, but
it prevents the random explosion race conditions that make for
confusing user experience when importing live databases.

Thanks, @brandonrobertz",953a64467d78bca29fe6cc18bdb2baa7848e53ff,False,.gitignore;datasette/app.py;datasette/hookspecs.py;datasette/utils/__init__.py;docs/plugin_hooks.rst;tests/test_permissions.py;tests/test_plugins.py
089278b8dbe0cb3d41f27666d97b0096b750fbe2,"rST fix, refs #1384",05a312caf3debb51aa1069939923a49e21cd2bd1,False,docs/plugin_hooks.rst
2e8d924cdc2274eb31fb76332bc5269f65c0ad90,"Refactored generated_columns test, no longer in fixtures.db - refs #1391",83f6799a96f48b5acef4911c0273973f15efdf05,False,tests/fixtures.py;tests/test_api.py;tests/test_internals_database.py
e0064ba7b06973eae70e6222a6208d9fed5bd170,"Fixes for test_generated_columns_are_visible_in_datasette, refs #1391",2e8d924cdc2274eb31fb76332bc5269f65c0ad90,False,tests/test_api.py
f83c84fd51d144036924ae77d99f12b0a69e7e6f,"Update asgiref requirement from <3.4.0,>=3.2.10 to >=3.2.10,<3.5.0 (#1386)

Updates the requirements on [asgiref](https://github.com/django/asgiref) to permit the latest version.
- [Release notes](https://github.com/django/asgiref/releases)
- [Changelog](https://github.com/django/asgiref/blob/main/CHANGELOG.txt)
- [Commits](https://github.com/django/asgiref/commits)

---
updated-dependencies:
- dependency-name: asgiref
  dependency-type: direct:production
...

Signed-off-by: dependabot[bot] <support@github.com>

Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",d792fc7cf5fde8fa748168e48c3183266a3a419f,False,setup.py
7f4c854db1ed8c15338e9cf42d2a3f0c92e3b7b2,rST fix,d71cac498138ddd86f18607b9043e70286ea884a,False,docs/deploying.rst
7ea678db228504004b8d32f813c838b1dcfd317a,"Warn about potential changes to get_metadata hook, refs #1384",a6c8e7fa4cffdeff84e9e755dcff4788fd6154b8,False,docs/plugin_hooks.rst
721a8d3cd4937f888efd2b52d5a61f0e25b484e1,Hopeful fix for publish problem in #1396,084cfe1e00e1a4c0515390a513aca286eeea20c2,False,.github/workflows/publish.yml
c00f29affcafce8314366852ba1a0f5a7dd25690,"Fix for race condition in refresh_schemas(), closes #1231",dd5ee8e66882c94343cd3f71920878c6cfd0da41,False,datasette/app.py;datasette/utils/internal_db.py
96b1d0b7b42928e657b1aebcc95d55e4685690e0,Attempted fix for too-long UDS bug in #1407,b46856391de5a819a85d1dd970428cbc702be94a,False,tests/conftest.py
a679d0de87031e3de9013fc299ba2cbd75808684,Fixed spelling of 'receive' in a bunch of places,4adca0d85077fe504e98cd7487343e76ccf25be5,False,docs/internals.rst;docs/plugin_hooks.rst;tests/plugins/my_plugin.py;tests/plugins/my_plugin_2.py
2208c3c68e552d343e6a2872ff6e559fca9d1b38,"Spelling corrections plus CI job for codespell

* Use codespell to check spelling in documentation, refs #1417
* Fixed spelling errors spotted by codespell, closes #1417
* Make codespell a docs dependency

See also this TIL:  https://til.simonwillison.net/python/codespell",54b6e96ee8aa553b6671e341a1944f93f3fb89c3,False,.github/workflows/spellcheck.yml;docs/authentication.rst;docs/changelog.rst;docs/codespell-ignore-words.txt;docs/deploying.rst;docs/internals.rst;docs/performance.rst;docs/plugin_hooks.rst;docs/publish.rst;docs/settings.rst;docs/sql_queries.rst;setup.py
b7037f5ecea40dc5343250d08d741504b6dcb28f,Bit of breathing space on https://latest.datasette.io/fixtures/pragma_cache_size,acc22436622ff8476c30acf45ed60f54b4aaa5d9,False,datasette/static/app.css
a21853c9dade240734abc6b4f750fae09a3e840a,"Fix for rich.console sometimes not being available, refs #1416",66e143c76e90f643dc11b6ced5433130c90a2455,False,datasette/app.py
f3c9edb376a13c09b5ecf97c7390f4e49efaadf2,Fixed some tests I broke in #1425,818b0b76a2d58f7c2d850570efcdc22d345b4059,False,tests/test_csv.py
a390bdf9cef01d8723d025fc3348e81345ff4856,"Stop using firstresult=True on render_cell, refs #1425

See https://github.com/simonw/datasette/issues/1425#issuecomment-894883664",f3c9edb376a13c09b5ecf97c7390f4e49efaadf2,False,datasette/hookspecs.py;datasette/views/database.py;datasette/views/table.py
b1fed48a95516ae84c0f020582303ab50ab817e2,"derive_named_parameters falls back to regex on SQL error, refs #1421",fc4846850fffd54561bc125332dfe97bb41ff42e,False,datasette/utils/__init__.py;tests/test_utils.py
bbc4756f9e8180c7a40c57f8a35e39dee7be7807,"Settings fix, refs #1433",ca4f83dc7b1d573b92a8921fca96d3ed490614c3,False,datasette/app.py
2883098770fc66e50183b2b231edbde20848d4d6,"Fixed config_dir mode, refs #1432",bbc4756f9e8180c7a40c57f8a35e39dee7be7807,False,datasette/app.py
a1a33bb5822214be1cebd98cd858b2058d91a4aa,"Bump black from 21.6b0 to 21.7b0 (#1400)

Bumps [black](https://github.com/psf/black) from 21.6b0 to 21.7b0.
- [Release notes](https://github.com/psf/black/releases)
- [Changelog](https://github.com/psf/black/blob/main/CHANGES.md)
- [Commits](https://github.com/psf/black/commits)

---
updated-dependencies:
- dependency-name: black
  dependency-type: direct:development
...

Signed-off-by: dependabot[bot] <support@github.com>

Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",5161422b7fa249c6b7d6dc47ec6f483d3fdbd170,False,setup.py
1163da89163f357003007b14f458a2c28f2e0a8e,"Update test to handle Python 3.10 error message differenc, refs #1482",98dcabccbbf9c0800efa74df9b7d1fee81c3cd0c,False,tests/test_canned_queries.py
875117c343e454221ef023be6ad977fdaea3ceda,"Fix bug with ?_next=x&_sort=rowid, closes #1470",1163da89163f357003007b14f458a2c28f2e0a8e,False,datasette/views/table.py;tests/test_html.py
6aab0217f07bff4556cc92885a14279d5b295f84,"Update pytest-xdist requirement from <2.4,>=2.2.1 to >=2.2.1,<2.5 (#1476)

Updates the requirements on [pytest-xdist](https://github.com/pytest-dev/pytest-xdist) to permit the latest version.
- [Release notes](https://github.com/pytest-dev/pytest-xdist/releases)
- [Changelog](https://github.com/pytest-dev/pytest-xdist/blob/master/CHANGELOG.rst)
- [Commits](https://github.com/pytest-dev/pytest-xdist/compare/v2.2.1...v2.4.0)

---
updated-dependencies:
- dependency-name: pytest-xdist
  dependency-type: direct:development
...

Signed-off-by: dependabot[bot] <support@github.com>

Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",759fd97a54638c1a5e2cac65bac0ac7c07ce2305,False,setup.py
31352914c427162f785d2610222a54a426d5215f,"Update full_text_search.rst (#1474)

Change ""above"" to ""below"" to correct correspondence of reference to example.",6aab0217f07bff4556cc92885a14279d5b295f84,False,docs/full_text_search.rst
a673a93b57e249f06b2d0265ce33f458258feeb0,"Update pluggy requirement from ~=0.13.0 to >=0.13,<1.1 (#1448)

Updates the requirements on [pluggy](https://github.com/pytest-dev/pluggy) to permit the latest version.
- [Release notes](https://github.com/pytest-dev/pluggy/releases)
- [Changelog](https://github.com/pytest-dev/pluggy/blob/main/CHANGELOG.rst)
- [Commits](https://github.com/pytest-dev/pluggy/compare/0.13.0...1.0.0)

---
updated-dependencies:
- dependency-name: pluggy
  dependency-type: direct:production
...

Signed-off-by: dependabot[bot] <support@github.com>

Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",31352914c427162f785d2610222a54a426d5215f,False,setup.py
763d0a0faabc6b53fa21ea2f0914e83ca12dfb34,"Fix for cog menu default facet bug, closes #1469",a673a93b57e249f06b2d0265ce33f458258feeb0,False,datasette/static/table.js;datasette/templates/table.html
e1012e7098056734d9c90f081493991009253390,"Bump black from 21.7b0 to 21.9b0 (#1471)

Bumps [black](https://github.com/psf/black) from 21.7b0 to 21.9b0.
- [Release notes](https://github.com/psf/black/releases)
- [Changelog](https://github.com/psf/black/blob/main/CHANGES.md)
- [Commits](https://github.com/psf/black/commits)

---
updated-dependencies:
- dependency-name: black
  dependency-type: direct:development
...

Signed-off-by: dependabot[bot] <support@github.com>

Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",763d0a0faabc6b53fa21ea2f0914e83ca12dfb34,False,setup.py
827fa823d1b919c445f3141174ecb7a82717d99c,"Update pyyaml requirement from ~=5.3 to >=5.3,<7.0 (#1489)

Updates the requirements on [pyyaml](https://github.com/yaml/pyyaml) to permit the latest version.
- [Release notes](https://github.com/yaml/pyyaml/releases)
- [Changelog](https://github.com/yaml/pyyaml/blob/master/CHANGES)
- [Commits](https://github.com/yaml/pyyaml/compare/5.3...6.0)

---
updated-dependencies:
- dependency-name: pyyaml
  dependency-type: direct:production
...

Signed-off-by: dependabot[bot] <support@github.com>

Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",b267b5775436577a91a9f9655143908aecff05da,False,setup.py
85849935292e500ab7a99f8fe0f9546e903baad3,"--cors Access-Control-Allow-Headers: Authorization

Refs #1467, refs https://github.com/simonw/datasette-auth-tokens/issues/4",0fdbf004843850f200e077a3c87427fe16c18b85,False,datasette/app.py;datasette/utils/__init__.py;datasette/views/base.py;datasette/views/database.py;datasette/views/index.py;datasette/views/special.py;tests/test_api.py
ff9ccfb0310501a3b4b4ca24d73246a8eb3e7914,Fixed typo in release notes,8934507cdc0029a598cf37cdb3818fd31af5e33c,False,docs/changelog.rst
e5d01ca5831844a02ef5b1ef0d5b9eb8bad3c9a4,Fixed typo in release notes,ff9ccfb0310501a3b4b4ca24d73246a8eb3e7914,False,docs/changelog.rst
96a823f2834a262ae97a90ebfb6847f14763c415,"Fix compatibility with Python 3.10 (#1481)

* Run tests against Python 3.10
* Upgrade to Janus 0.6.2 for Python 3.10
* Add 3.10 to classifiers

Closes #1482",15a9d4abfff0c45dee2a9f851326e1d61b1c678c,False,.github/workflows/test.yml;setup.py
c617e1769ea27e045b0f2907ef49a9a1244e577d,Fixed test I broke with new repr() in ##1519,c76bbd40664f789c45564b7796628e5110cd3b17,False,tests/test_plugins.py
fe687fd0207c4c56c4778d3e92e3505fc4b18172,"Fixed a whole bunch of broken base_url links

Refs #1519, #838",a1ba6cd6bb86d935cdad240de6be6b37aad683f2,False,datasette/facets.py;datasette/templates/_table.html;datasette/views/base.py;datasette/views/database.py;datasette/views/table.py;tests/test_html.py
640031edfd40ba66aee3c4f7008c78c6a78a3e69,Fixed bug introduced in #1519,fe687fd0207c4c56c4778d3e92e3505fc4b18172,False,datasette/views/table.py
08947fa76433d18988aa1ee1d929bd8320c75fe2,"Fix more broken base_url links

Refs #1519, #838",48951e4304cc39b49e26682836d6961e165bddb1,False,datasette/facets.py;datasette/views/table.py;tests/test_html.py
250db8192cb8aba5eb8cd301ccc2a49525bc3d24,"Hopefully last fix relating to #1519, #838",08947fa76433d18988aa1ee1d929bd8320c75fe2,False,datasette/facets.py
cc4c70b3670ce2a85bb883b8d5626574590efe14,"Bump black from 21.9b0 to 21.11b1 (#1516)

Bumps [black](https://github.com/psf/black) from 21.9b0 to 21.11b1.
- [Release notes](https://github.com/psf/black/releases)
- [Changelog](https://github.com/psf/black/blob/main/CHANGES.md)
- [Commits](https://github.com/psf/black/commits)

---
updated-dependencies:
- dependency-name: black
  dependency-type: direct:development
...

Signed-off-by: dependabot[bot] <support@github.com>

Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",3303514a52b7170f2f1e598cd9c5f82c22f26e6c,False,setup.py
83eb29deced2430f40c3374ff9085d65d86d8281,"Update janus requirement from <0.7,>=0.6.2 to >=0.6.2,<0.8 (#1529)

Updates the requirements on [janus](https://github.com/aio-libs/janus) to permit the latest version.
- [Release notes](https://github.com/aio-libs/janus/releases)
- [Changelog](https://github.com/aio-libs/janus/blob/master/CHANGES.rst)
- [Commits](https://github.com/aio-libs/janus/compare/v0.6.2...v0.7.0)

---
updated-dependencies:
- dependency-name: janus
  dependency-type: direct:production
...

Signed-off-by: dependabot[bot] <support@github.com>

Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",cc4c70b3670ce2a85bb883b8d5626574590efe14,False,setup.py
06762776f712526fdb40a18ed26f259be62bb214,"Fix for incorrect hidden for fields for _columns, refs #1527",83eb29deced2430f40c3374ff9085d65d86d8281,False,datasette/views/table.py;tests/test_html.py
69244a617b1118dcbd04a8f102173f04680cf08c,"Rename city_id to _city_id in fixtures, refs #1525",06762776f712526fdb40a18ed26f259be62bb214,False,tests/fixtures.py;tests/test_api.py;tests/test_facets.py;tests/test_html.py;tests/test_internals_database.py;tests/test_plugins.py
a37ee74891f14898d5810127c7ca3355e77ff57d,"Correct link to _ prefix on row page, closes #1525",69244a617b1118dcbd04a8f102173f04680cf08c,False,datasette/templates/row.html;datasette/views/table.py;tests/test_html.py
35b12746ba2bf9f254791bddac03d25b19be9b77,Fixed CSV test I broke in #1525,a37ee74891f14898d5810127c7ca3355e77ff57d,False,tests/test_csv.py
8b411a6b70e93e044820d613a28607ba5d6fe416,"Update pytest-xdist requirement from <2.5,>=2.2.1 to >=2.2.1,<2.6 (#1548)

Updates the requirements on [pytest-xdist](https://github.com/pytest-dev/pytest-xdist) to permit the latest version.
- [Release notes](https://github.com/pytest-dev/pytest-xdist/releases)
- [Changelog](https://github.com/pytest-dev/pytest-xdist/blob/master/CHANGELOG.rst)
- [Commits](https://github.com/pytest-dev/pytest-xdist/compare/v2.2.1...v2.5.0)

---
updated-dependencies:
- dependency-name: pytest-xdist
  dependency-type: direct:development
...

Signed-off-by: dependabot[bot] <support@github.com>

Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",a6ff123de5464806441f6a6f95145c9a83b7f20b,False,setup.py
f5538e7161cce92a4dfaa7c5b71fcb6755d96c05,"Bump black from 21.11b1 to 21.12b0 (#1543)

Bumps [black](https://github.com/psf/black) from 21.11b1 to 21.12b0.
- [Release notes](https://github.com/psf/black/releases)
- [Changelog](https://github.com/psf/black/blob/main/CHANGES.md)
- [Commits](https://github.com/psf/black/commits)

---
updated-dependencies:
- dependency-name: black
  dependency-type: direct:development
...

Signed-off-by: dependabot[bot] <support@github.com>

Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",8b411a6b70e93e044820d613a28607ba5d6fe416,False,setup.py
20a2ed6bec367d2f6759be4a879364a72780b59d,"Fixed bug with metadata config of array/date facets, closes #1552

Thanks @davidbgk for spotting the fix for the bug.",40e5b0a5b5cbbe7ec9b1a525d61f58227061597e,False,datasette/facets.py;docs/facets.rst;tests/test_facets.py
95d0dd7a1cf6be6b7da41e1404184217eb93f64a,"Fix for colliding facet types bug, closes #625

Refs #830",992496f2611a72bd51e94bfd0b17c1d84e732487,False,datasette/facets.py;datasette/views/table.py;docs/plugin_hooks.rst;tests/test_facets.py
aa7f0037a46eb76ae6fe9bf2a1f616c58738ecdf,"filters_from_request plugin hook, now used in TableView

- New `filters_from_request` plugin hook, closes #473
- Used it to extract the logic from TableView that handles `_search` and
`_through` and `_where` - refs #1518

Also needed for this plugin work: https://github.com/simonw/datasette-leaflet-freedraw/issues/7",0663d5525cc41e9260ac7d1f6386d3a6eb5ad2a9,False,datasette/filters.py;datasette/hookspecs.py;datasette/plugins.py;datasette/views/table.py;docs/plugin_hooks.rst;tests/test_filters.py;tests/test_plugins.py
35cba9e85a574cebf2986b64107fa84d02bd86ad,"Update janus requirement from <0.8,>=0.6.2 to >=0.6.2,<1.1 (#1562)

Updates the requirements on [janus](https://github.com/aio-libs/janus) to permit the latest version.
- [Release notes](https://github.com/aio-libs/janus/releases)
- [Changelog](https://github.com/aio-libs/janus/blob/master/CHANGES.rst)
- [Commits](https://github.com/aio-libs/janus/compare/v0.6.2...v1.0.0)

---
updated-dependencies:
- dependency-name: janus
  dependency-type: direct:production
...

Signed-off-by: dependabot[bot] <support@github.com>

Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",f000a7bd75ac512478070f2e2a09c8fb9604c82d,False,setup.py
3a0cae4d7f77b5c2a103ea74ca7fa7a0d9ff2e66,Fix bug introduced by refactor in c35b84a2aabe2f14aeacf6cda4110ae1e94d6059,359140cedaf69242d6356479fb8a9d3aa591e618,False,tests/fixtures.py
4094741c2881c2ada3f3f878b532fdaec7914953,"Fixed bug with custom templates for writable canned queries, closes #1547",5fac26aa221a111d7633f2dd92014641f7c0ade9,False,datasette/views/database.py;tests/test_canned_queries.py
8c401ee0f054de2f568c3a8302c9223555146407,"Fixed remaining code and docs for new block=True default, closes #1579",75153ea9b94d09ec3d61f7c6ebdf378e0c0c7a0b,False,datasette/app.py;datasette/utils/internal_db.py;datasette/views/database.py;docs/plugin_hooks.rst;tests/test_facets.py;tests/test_internals_database.py
3658e57ac2de0bec0ea5de36e3ddd09784ecf65e,"Fixed bug with table title element, closes #1560",5698e2af0182677c0f1f7f5b3bc61415bb6c93f8,False,datasette/templates/table.html;tests/test_table_html.py
3a0f7d64889cd79d5d00d3251e8ab77ff52de60d,Fixed hidden form fields bug #1527,515f8d38ebae203efc15ca79a8b42848276b35e5,False,datasette/views/table.py;tests/test_table_html.py
714b4df1b1b2aeab8cde3a309627c42355439dda,"Fixed reStructuredText warning, refs #1594",76d66d5b2bf10249c0beaac0999b93ac8d757f48,False,docs/cli-reference.rst
ab7d6a7179e9939c2764989e508bfa8eba31f3b1,Updated settings help URL to avoid redirect,714b4df1b1b2aeab8cde3a309627c42355439dda,False,datasette/cli.py;datasette/views/base.py;docs/cli-reference.rst;tests/test_html.py
10659c3f1f82458adfa65c61f4dcc8d9af5467ed,datasette-debug-asgi plugin to help investigate #1590,ab7d6a7179e9939c2764989e508bfa8eba31f3b1,False,demos/apache-proxy/Dockerfile
43c30ce0236ebbc7e9cec98a3822265eb2691430,"Use cog to maintain default plugin list in plugins.rst, closes #1600

Also fixed a bug I spotted where datasette.filters showed the same hook three times.",14e320329f756b7d8e298c4e2251d8a0b194c9c4,False,datasette/app.py;docs/plugins.rst
7c67483f5e61f7c46410a433a55280d62280327f,"Make test_favicon flexible to changing icon sizes, refs #1603",b01c9b68d151e1656fc180815c0d8480e35fc961,False,tests/test_html.py
d194db4204b732af57138e1fb0924ec77354dd58,"Output pip freeze to show installed packages, refs #1609",ffca55dfd7cc9b53522c2e5a2fa1ff67c9beadf2,False,.github/workflows/test.yml
3ef47a0896c7e63404a34e465b7160c80eaa571d,"Link rel=alternate header for tables and rows

Also added Access-Control-Expose-Headers: Link to --cors mode.

Closes #1533

Refs https://github.com/simonw/datasette-notebook/issues/2

LL#	metadata.json.1",2aa686c6554bf6b8230eb5b3019574df6cc99225,False,datasette/templates/base.html;datasette/templates/row.html;datasette/templates/table.html;datasette/utils/__init__.py;datasette/views/base.py;datasette/views/table.py;docs/json_api.rst;tests/test_api.py;tests/test_table_html.py
b5e6b1a9e1332fca3effe45d55dd06ee4249f163,"Bump black from 21.12b0 to 22.1.0 (#1616)

Bumps [black](https://github.com/psf/black) from 21.12b0 to 22.1.0.
- [Release notes](https://github.com/psf/black/releases)
- [Changelog](https://github.com/psf/black/blob/main/CHANGES.md)
- [Commits](https://github.com/psf/black/commits/22.1.0)

---
updated-dependencies:
- dependency-name: black
  dependency-type: direct:development
...

Signed-off-by: dependabot[bot] <support@github.com>

Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",a9d8824617268c4d214dd3be2174ac452044f737,False,setup.py
1c6b297e3ec288cf1f838796df499a9c21c31664,"Link to datasette.tracer from trace_debug docs, refs #1576",da53e0360da4771ffb56a8e3eb3f7476f3168299,False,docs/settings.rst
d25b55ab5e4d7368d374ea752b2232755869d40d,Fixed rST warnings,1c6b297e3ec288cf1f838796df499a9c21c31664,False,docs/internals.rst
9b83ff2ee4d3cb5bfc5cb09a3ec99819ac214434,"Fixed spelling of ""raise""",8a25ea9bcae7ae4c9a4bd99f90c955828ff5676d,False,docs/plugin_hooks.rst
7d24fd405f3c60e4c852c5d746c91aa2ba23cf5b,"datasette-auth-passwords is now an example of register_commands

Refs https://github.com/simonw/datasette-auth-passwords/issues/19",458f03ad3a454d271f47a643f4530bd8b60ddb76,False,docs/plugin_hooks.rst
5010d1359b9e9db90a5a69a3ca22d12862893e00,"Fix for test failure caused by SQLite 3.37.0+, closes #1647",dd94157f8958bdfe9f45575add934ccf1aba6d63,False,datasette/templates/_table.html;tests/test_internals_database.py
b21839dd1a005f6269c4e9a9f763195fe7aa9c86,"Update pytest requirement from <6.3.0,>=5.2.2 to >=5.2.2,<7.1.0 (#1629)

Updates the requirements on [pytest](https://github.com/pytest-dev/pytest) to permit the latest version.
- [Release notes](https://github.com/pytest-dev/pytest/releases)
- [Changelog](https://github.com/pytest-dev/pytest/blob/main/CHANGELOG.rst)
- [Commits](https://github.com/pytest-dev/pytest/compare/5.2.2...7.0.0)

---
updated-dependencies:
- dependency-name: pytest
  dependency-type: direct:development
...

Signed-off-by: dependabot[bot] <support@github.com>

Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",a22ec96c3ac555337eb49121450723a273fb52d1,False,setup.py
73f2d25f70d741c6b53f7312674c91f0aec83e17,"Update asgiref requirement from <3.5.0,>=3.2.10 to >=3.2.10,<3.6.0 (#1610)

Updates the requirements on [asgiref](https://github.com/django/asgiref) to permit the latest version.
- [Release notes](https://github.com/django/asgiref/releases)
- [Changelog](https://github.com/django/asgiref/blob/main/CHANGELOG.txt)
- [Commits](https://github.com/django/asgiref/compare/3.2.10...3.5.0)

---
updated-dependencies:
- dependency-name: asgiref
  dependency-type: direct:production
...

Signed-off-by: dependabot[bot] <support@github.com>

Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",b21839dd1a005f6269c4e9a9f763195fe7aa9c86,False,setup.py
d714c67d656c46e012b24ccca53b59409440334f,asyncio_mode = strict to avoid pytest warnings,644d25d1de78a36b105cca479e7b3e4375a6eadc,False,pytest.ini
c85d669de387b40e667fd6942c6cc1c15b4f5964,"Fix bug with percentage redirects, close #1650",020effe47bf89f35182960a9645f2383a42ebd54,False,datasette/utils/__init__.py;tests/test_html.py
bb499942c15c4e2cfa4b6afab8f8debe5948c009,"Fixed tests for urlsafe_components, refs #1650",c85d669de387b40e667fd6942c6cc1c15b4f5964,False,tests/test_utils.py
5a353a32b9c4d75acbe3193fd72f735a8e78516a,"Revert ""Fixed tests for urlsafe_components, refs #1650""

This reverts commit bb499942c15c4e2cfa4b6afab8f8debe5948c009.

Refs #1658",239aed182053903ed69108776b6864d42bfe1eb4,False,tests/test_utils.py
77e718c3ffb30473759a8b1ed347f73cb2ff5cfe,"Revert ""Fix bug with percentage redirects, close #1650""

This reverts commit c85d669de387b40e667fd6942c6cc1c15b4f5964.

Refs #1658",5a353a32b9c4d75acbe3193fd72f735a8e78516a,False,datasette/utils/__init__.py;tests/test_html.py
77a904fea14f743560af9cc668146339bdbbd0a9,"Update pytest requirement from <7.1.0,>=5.2.2 to >=5.2.2,<7.2.0 (#1656)

Updates the requirements on [pytest](https://github.com/pytest-dev/pytest) to permit the latest version.
- [Release notes](https://github.com/pytest-dev/pytest/releases)
- [Changelog](https://github.com/pytest-dev/pytest/blob/main/CHANGELOG.rst)
- [Commits](https://github.com/pytest-dev/pytest/compare/5.2.2...7.1.0)

---
updated-dependencies:
- dependency-name: pytest
  dependency-type: direct:development
...

Signed-off-by: dependabot[bot] <support@github.com>

Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",a35393b29cfb5b8abdc6a94e577af1c9a5c13652,False,setup.py
8658c66438ec71edc7e9adc495f4692b937a0f57,"Show error if --setting hash_urls 1 used, refs #1661",d4f60c2388c01ddce1b16f95c16d310e037c9912,False,datasette/app.py;datasette/cli.py;tests/test_cli.py
4e47a2d894b96854348343374c8e97c9d7055cf6,"Fixed bug where tables with a column called n caused 500 errors

Closes #1228",32963018e7edfab1233de7c7076c428d0e5c7813,False,datasette/facets.py;tests/fixtures.py;tests/test_api.py;tests/test_csv.py;tests/test_internals_database.py;tests/test_plugins.py;tests/test_table_api.py
cdbae2b93f441653616dd889644c63e4150ceec1,"Fixed internal links to respect db.route, refs #1668",e10da9af3595c0a4e09c6f370103571aa4ea106e,False,datasette/url_builder.py;datasette/views/table.py;tests/test_routes.py
cb4854a435cc1418665edec2a73664ad74a32017,Fixed typo,5471e3c4914837de957e206d8fb80c9ec383bc2e,False,docs/changelog.rst
0159662ab8ccb363c59647861360e0cb7a6f930d,"Fix for bug running ?sql= against databases with a different route, closes #1682",d7c793d7998388d915f8d270079c68a77a785051,False,datasette/views/database.py;tests/test_routes.py
d431a9055e977aefe48689a2e5866ea8d3558a6c,"Release 0.61.1

Refs #1682

Refs https://github.com/simonw/datasette-hashed-urls/issues/13",0159662ab8ccb363c59647861360e0cb7a6f930d,False,datasette/version.py;docs/changelog.rst
bd8a58ae61b2c986ef04ea721897906e0852e33e,"Fix message_type in documentation, closes #1689",6b99e4a66ba0ed8fca8ee41ceb7206928b60d5d1,False,docs/internals.rst
e73fa72917ca28c152208d62d07a490c81cadf52,"Fixed bug in httpx_mock example, closes #1691",bd8a58ae61b2c986ef04ea721897906e0852e33e,False,docs/testing_plugins.rst
138e4d9a53e3982137294ba383303c3a848cfca4,"Update click requirement from <8.1.0,>=7.1.1 to >=7.1.1,<8.2.0 (#1694)

Updates the requirements on [click](https://github.com/pallets/click) to permit the latest version.
- [Release notes](https://github.com/pallets/click/releases)
- [Changelog](https://github.com/pallets/click/blob/main/CHANGES.rst)
- [Commits](https://github.com/pallets/click/compare/7.1.1...8.1.0)

---
updated-dependencies:
- dependency-name: click
  dependency-type: direct:production
...

Signed-off-by: dependabot[bot] <support@github.com>

Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",247e460e08bf823142f7b84058fe44e43626787f,False,setup.py
36573638b0948174ae237d62e6369b7d55220d7f,"Apply Black to code examples in documentation, refs #1718

Uses blacken-docs. This has a deliberate error which I hope will fail CI.",40ef8ebac2d83c34f467fd2d7bf80f0549b6f6c3,False,.github/workflows/test.yml;docs/contributing.rst;docs/spatialite.rst;docs/writing_plugins.rst;setup.py
92b26673d86a663050c9a40a8ffd5b56c25be85f,"Fix blacken-docs errors and warnings, refs #1718",36573638b0948174ae237d62e6369b7d55220d7f,False,docs/authentication.rst;docs/internals.rst;docs/json_api.rst;docs/plugin_hooks.rst
b393e164dc9e962702546d6f1ad9c857b5788dc0,ReST fix,5555bc8aef043f75d2200f66de90c54aeeaa08c3,False,docs/getting_started.rst
7d1e004ff679b3fb4dca36d1d751a1ad16688fe6,Fix test I broke in #1744,b393e164dc9e962702546d6f1ad9c857b5788dc0,False,tests/test_cli.py
9f1eb0d4eac483b953392157bd9fd6cc4df37de7,"Bump black from 22.1.0 to 22.6.0 (#1763)

Bumps [black](https://github.com/psf/black) from 22.1.0 to 22.6.0.
- [Release notes](https://github.com/psf/black/releases)
- [Changelog](https://github.com/psf/black/blob/main/CHANGES.md)
- [Commits](https://github.com/psf/black/compare/22.1.0...22.6.0)

---
updated-dependencies:
- dependency-name: black
  dependency-type: direct:development
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>

Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",00e59ec461dc0150772b999c7cc15fcb9b507d58,False,setup.py
5d76c1f81b2d978f48b85c70d041a2142cf8ee26,"Discord badge

Refs https://github.com/simonw/datasette.io/issues/112",035dc5e7b95142d4a700819a8cc4ff64aefe4efe,False,README.md;docs/index.rst
c133545fe9c7ac2d509e55bf4bf6164bfbe892ad,"Make discord badge lowercase

Refs https://github.com/simonw/datasette.io/issues/112",5d76c1f81b2d978f48b85c70d041a2142cf8ee26,False,README.md;docs/index.rst
950cc7677f65aa2543067b3bbfc2b6acb98b62c8,"Fix missing Discord image

Refs https://github.com/simonw/datasette.io/issues/112",c133545fe9c7ac2d509e55bf4bf6164bfbe892ad,False,docs/index.rst
8188f55efc0fcca1be692b0d0c875f2d1ee99f17,"Rename handle_500 to handle_exception, refs #1770",950cc7677f65aa2543067b3bbfc2b6acb98b62c8,False,datasette/app.py
c09c53f3455a7b9574cf7695478f2b87d20897db,"New handle_exception plugin hook, refs #1770

Also refs:
- https://github.com/simonw/datasette-sentry/issues/1
- https://github.com/simonw/datasette-show-errors/issues/2",8188f55efc0fcca1be692b0d0c875f2d1ee99f17,False,datasette/app.py;datasette/forbidden.py;datasette/handle_exception.py;datasette/hookspecs.py;datasette/plugins.py;docs/plugin_hooks.rst;tests/fixtures.py;tests/plugins/my_plugin_2.py;tests/test_permissions.py;tests/test_plugins.py
ea6161f8475d9fa41c4879049511c58f692cce04,"Bump furo from 2022.4.7 to 2022.6.21 (#1760)

Bumps [furo](https://github.com/pradyunsg/furo) from 2022.4.7 to 2022.6.21.
- [Release notes](https://github.com/pradyunsg/furo/releases)
- [Changelog](https://github.com/pradyunsg/furo/blob/main/docs/changelog.md)
- [Commits](https://github.com/pradyunsg/furo/compare/2022.04.07...2022.06.21)

---
updated-dependencies:
- dependency-name: furo
  dependency-type: direct:development
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>

Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",ed1ebc0f1d4153e3e0934f2af19f82e5fdf137d3,False,setup.py
22354c48ce4d514d7a1b321e5651c7f1340e3f5e,"Update pytest-asyncio requirement from <0.19,>=0.17 to >=0.17,<0.20 (#1769)

Updates the requirements on [pytest-asyncio](https://github.com/pytest-dev/pytest-asyncio) to permit the latest version.
- [Release notes](https://github.com/pytest-dev/pytest-asyncio/releases)
- [Changelog](https://github.com/pytest-dev/pytest-asyncio/blob/master/CHANGELOG.rst)
- [Commits](https://github.com/pytest-dev/pytest-asyncio/compare/v0.17.0...v0.19.0)

---
updated-dependencies:
- dependency-name: pytest-asyncio
  dependency-type: direct:development
...

Signed-off-by: dependabot[bot] <support@github.com>

Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",ea6161f8475d9fa41c4879049511c58f692cce04,False,setup.py
a107e3a028923c1ab3911c0f880011283f93f368,datasette-sentry is an example of handle_exception,815162cf029fab9f1c9308c1d6ecdba7ee369ebe,False,docs/plugin_hooks.rst
09a41662e70b788469157bb58ed9ca4acdf2f904,Fix typo,a3e6f1b16757fb2d39e7ddba4e09eda2362508bf,False,docs/plugin_hooks.rst
aff3df03d4fe0806ce432d1818f6643cdb2a854e,"Ignore ro which stands for read only

Refs #1787 where it caused tests to break",6c0ba7c00c2ae3ecbb5309efa59079cea1c850b3,False,docs/codespell-ignore-words.txt
51030df1869b3b574dd3584d1563415776b9cd4e,"Don't use upper bound dependencies any more

See https://iscinumpy.dev/post/bound-version-constraints/ for the rationale behind this change.

Closes #1800",ba35105eee2d3ba620e4f230028a02b2e2571df2,False,setup.py
294ecd45f7801971dbeef383d0c5456ee95ab839,"Bump black from 22.6.0 to 22.8.0 (#1797)

Bumps [black](https://github.com/psf/black) from 22.6.0 to 22.8.0.
- [Release notes](https://github.com/psf/black/releases)
- [Changelog](https://github.com/psf/black/blob/main/CHANGES.md)
- [Commits](https://github.com/psf/black/compare/22.6.0...22.8.0)

---
updated-dependencies:
- dependency-name: black
  dependency-type: direct:development
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",51030df1869b3b574dd3584d1563415776b9cd4e,False,setup.py
b2b901e8c4b939e50ee1117ffcd2881ed8a8e3bf,"Skip SpatiaLite test if no conn.enable_load_extension()

Ran into this problem while working on #1802",b91e17280c05bbb9cf97432081bdcea8665879f9,False,tests/test_spatialite.py;tests/utils.py
1c29b925d300d1ee17047504473f2517767aa05b,"Run tests in serial again

Because this didn't fix the issue I'm seeing in #1802

Revert ""Run tests in serial, refs #1802""

This reverts commit b91e17280c05bbb9cf97432081bdcea8665879f9.",b2b901e8c4b939e50ee1117ffcd2881ed8a8e3bf,False,.github/workflows/test.yml
64288d827f7ff97f825e10f714da3f781ecf9345,"Workaround for test failure: RuntimeError: There is no current event loop (#1803)

* Remove ensure_eventloop hack
* Hack to recover from intermittent RuntimeError calling asyncio.Lock()",1c29b925d300d1ee17047504473f2517767aa05b,False,datasette/app.py;tests/test_cli.py
c9d1943aede436fa3413fd49bc56335cbda4ad07,"Fix word break in facets by adding ul.tight-bullets li word-break: break-all (#1794)

Thanks, @dmr",64288d827f7ff97f825e10f714da3f781ecf9345,False,datasette/static/app.css
d80775a48d20917633792fdc9525f075d3bc2c7a,"Raise error if it's not about loops, refs #1802",c9d1943aede436fa3413fd49bc56335cbda4ad07,False,datasette/app.py
303c6c733d95a6133558ec1b468f5bea5827d0d2,"Fix for incorrectly handled _facet_size=max, refs #1804",8430c3bc7dd22b173c1a8c6cd7180e3b31240cd1,False,datasette/facets.py
d0476897e10249bb4867473722270d02491c2c1f,Fixed Sphinx warning about language = None,0a7815d2038255a0834c955066a2a16c01f707b2,False,docs/conf.py
ff9c87197dde8b09f9787ee878804cb6842ea5dc,Fixed Sphinx warnings on cli-reference page,d0476897e10249bb4867473722270d02491c2c1f,False,docs/cli-reference.rst
fb7e70d5e72a951efe4b29ad999d8915c032d021,"Database(is_mutable=) now defaults to True, closes #1808

Refs https://github.com/simonw/datasette-upload-dbs/issues/6",bf8d84af5422606597be893cedd375020cb2b369,False,datasette/database.py;docs/internals.rst;tests/test_internals_database.py;tests/test_internals_datasette.py
2ebcffe2226ece2a5a86722790d486a480338632,"Bump furo from 2022.6.21 to 2022.9.15 (#1812)

Bumps [furo](https://github.com/pradyunsg/furo) from 2022.6.21 to 2022.9.15.
- [Release notes](https://github.com/pradyunsg/furo/releases)
- [Changelog](https://github.com/pradyunsg/furo/blob/main/docs/changelog.md)
- [Commits](https://github.com/pradyunsg/furo/compare/2022.06.21...2022.09.15)

---
updated-dependencies:
- dependency-name: furo
  dependency-type: direct:development
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",b40872f5e5ae5dad331c58f75451e2d206565196,False,setup.py
cb1e093fd361b758120aefc1a444df02462389a3,"Fixed error message, closes #1816",df851c117db031dec50dd4ef1ca34745920ac77a,False,datasette/app.py;tests/test_config_dir.py
5f9f567acbc58c9fcd88af440e68034510fb5d2b,"Show SQL query when reporting time limit error, closes #1819",212137a90b4291db9605e039f198564dae59c5d0,False,datasette/database.py;datasette/views/base.py;tests/test_api.py;tests/test_html.py
c92c4318e9892101f75fa158410c0a12c1d80b6e,"Bump furo from 2022.9.15 to 2022.9.29 (#1827)

Bumps [furo](https://github.com/pradyunsg/furo) from 2022.9.15 to 2022.9.29.
- [Release notes](https://github.com/pradyunsg/furo/releases)
- [Changelog](https://github.com/pradyunsg/furo/blob/main/docs/changelog.md)
- [Commits](https://github.com/pradyunsg/furo/compare/2022.09.15...2022.09.29)

---
updated-dependencies:
- dependency-name: furo
  dependency-type: direct:development
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",34defdc10aa293294ca01cfab70780755447e1d7,False,setup.py
4218c9cd742b79b1e3cb80878e42b7e39d16ded2,reST markup fix,883e326dd6ef95f854f7750ef2d4b0e17082fa96,False,docs/plugin_hooks.rst
6887c12ea30598e7d06d20cd6b2a2ef8256a9fa1,"Workaround for 'too many open files' error, refs #1843",fdf9891c3f0313af9244778574c7ebaac9c3a438,False,tests/fixtures.py
5be86d48b2e31565faca208fc4aeb0ddfaca71f9,"Fix display of padlocks on database page, closes #1848",78dad236df730212aa7172f885fd8ec575f0d3ad,False,datasette/views/database.py;tests/test_permissions.py
a0dd5fa02fb1e6d5477b962a2062f1a4be3354a5,Fixed typo in release notes,602c0888ce633000cfae42be00de474ef681bda7,False,docs/changelog.rst
68ccb7578b5d3bf68b86fb2f5cf8753098dfe075,"dstoke_ prefix for tokens

Refs https://github.com/simonw/datasette/issues/1852#issuecomment-1291290451",42f8b402e6aa56af4bbe921e346af8df42acd50f,False,datasette/views/special.py
c556fad65d8a45ce85027678796a12ac9107d9ed,"Try to address too many files error again, refs #1843",c36a74ece1e475291af326d493d8db9ff3afdd30,False,tests/fixtures.py
df7bf0b2fc262f0b025b3cdd283ff8ce60653175,"Fix bug with breadcrumbs and request=None, closes #1849",c7dd76c26257ded5bcdfd0570e12412531b8b88f,False,datasette/app.py;tests/test_internals_datasette.py
55f860c304aea813cb7ed740cc5625560a0722a0,"Fix bug with breadcrumbs and request=None, closes #1849",c7956eed7777c62653b4d508570c5d77cfead7d9,False,datasette/app.py;tests/test_internals_datasette.py
a51608090b5ee37593078f71d18b33767ef3af79,"Slight tweak to insert row API design, refs #1851

https://github.com/simonw/datasette/issues/1851#issuecomment-1292997608",6958e21b5c2012adf5655d2512cb4106490d10f2,False,datasette/views/table.py;docs/json_api.rst
2c36e45447494cd7505440943367e29ec57c8e72,"Bump black from 22.8.0 to 22.10.0 (#1839)

Bumps [black](https://github.com/psf/black) from 22.8.0 to 22.10.0.
- [Release notes](https://github.com/psf/black/releases)
- [Changelog](https://github.com/psf/black/blob/main/CHANGES.md)
- [Commits](https://github.com/psf/black/compare/22.8.0...22.10.0)

---
updated-dependencies:
- dependency-name: black
  dependency-type: direct:development
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",b912d92b651c4f0b5137da924d135654511f0fe0,False,setup.py
641bc4453b5ef1dff0b2fc7dfad0b692be7aa61c,"Bump black from 22.8.0 to 22.10.0 (#1839)

Bumps [black](https://github.com/psf/black) from 22.8.0 to 22.10.0.
- [Release notes](https://github.com/psf/black/releases)
- [Changelog](https://github.com/psf/black/blob/main/CHANGES.md)
- [Commits](https://github.com/psf/black/compare/22.8.0...22.10.0)

---
updated-dependencies:
- dependency-name: black
  dependency-type: direct:development
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",2ea60e12d90b7cec03ebab728854d3ec4d553f54,False,setup.py
fedbfcc36873366143195d8fe124e1859bf88346,"Neater display of output and errors in API explorer, refs #1871",9eb9ffae3ddd4e8ff0b713bf6fd6a0afed3368d7,False,datasette/templates/api_explorer.html
497290beaf32e6b779f9683ef15f1c5bc142a41a,"Handle database errors in /-/insert, refs #1866, #1873

Also improved API explorer to show HTTP status of response, refs #1871",9bec7c38eb93cde5afb16df9bdd96aea2a5b0459,False,datasette/templates/api_explorer.html;datasette/views/table.py;tests/test_api_write.py
719e75725240f75b994cf22bf3f6d1a502bb3d07,"Return method not allowed error in JSON in some situations

Added this while playing with the new API explorer, refs #1871",000eeb44640517cdb1fbe125a1ede3857bc01003,False,datasette/views/base.py
bb030ba46f3b4981c33d673c9aa8e1e8bd7d7896,More margin on /-/allow-debug page,c51d9246b996a2831c9bd6a1e205f6cb48b9a5f3,False,datasette/templates/allow_debug.html
fb8b6b2311674c71ae12294cec5d9e6b30dc4258,Refactor _error helper function,2355067ef568b4011ad3202ce26a46647c2419c3,False,datasette/views/base.py;datasette/views/row.py;datasette/views/table.py
bcc781f4c50a8870e3389c4e60acb625c34b0317,"Implementation and tests for _r field on actor, refs #1855

New mechanism for restricting permissions further for a given actor.

This still needs documentation. It will eventually be used by the mechanism to issue
signed API tokens that are only able to perform a subset of actions.

This also adds tests that exercise the POST /-/permissions tool, refs #1881",fb8b6b2311674c71ae12294cec5d9e6b30dc4258,False,datasette/default_permissions.py;datasette/views/special.py;tests/test_permissions.py
bbaab3b38ec2ce5944239ffbe2dd53328df40fff,"Test form actions use prefix, refs #1883",867e0abd3429f837d5f15e6843a38f848ee562f0,False,tests/test_html.py
8d9a957c6329d26cc1e417b5d6911640d74765eb,"Fix for redirects ignoring base_url, refs #1883",bbaab3b38ec2ce5944239ffbe2dd53328df40fff,False,datasette/views/table.py;tests/test_html.py
26262d08f3ed727ddbb8c8d32b3887603a74cdb0,"Test form actions use prefix, refs #1883",aacf25cf19858a30a9253f681851400206318631,False,tests/test_html.py
fa9cc9efaf442be9d1399be1cefcc37c7b29ff72,"Fix for redirects ignoring base_url, refs #1883",26262d08f3ed727ddbb8c8d32b3887603a74cdb0,False,datasette/views/table.py;tests/test_html.py
51d60d7ddf8fcbe1cf12d8f158f99971a8df6697,"details-menu class to avoid accidential details closure

Refs https://github.com/simonw/datasette/issues/1871#issuecomment-1312821031",f832435b882def6e0bbcd24006053521f8b96351,False,datasette/templates/_close_open_menus.html;datasette/templates/base.html;datasette/templates/database.html;datasette/templates/patterns.html;datasette/templates/table.html
65521f03db62085d49557c3dc4e0c5005648daad,"Error for drop against immutable database, closes #1874",612da8eae6d20cccbeb25e2bf7689960517bcb8c,False,datasette/views/table.py;docs/json_api.rst;tests/test_api_write.py
264d0ab4714980b630face9157fc05611095e33e,"Renamed return_rows to return in insert API

Refs https://github.com/simonw/datasette/issues/1866#issuecomment-1313128913",65521f03db62085d49557c3dc4e0c5005648daad,False,datasette/views/table.py;docs/json_api.rst;tests/test_api_write.py
518fc63224860d2ac7bcd23cfda7df3a2799556f,"API explorer: no error if you format JSON on empty string

Refs #1871",575a29c424893b82b1b3c7472e1b8e4622c05c95,False,datasette/templates/api_explorer.html
eac028d3f77aa5473a5fcf59240635a1bca80f7d,"Fix for datalist against foreign key facets

Refs https://github.com/simonw/datasette/issues/1890#issuecomment-1314850524",3652b7472aaa963a8f28d5e6bb1ca21df067b0e1,False,datasette/static/table.js;datasette/templates/_facet_results.html
ae11fa5887e03376704c22e5d0969c1e0642d8d8,"Upgrade to CodeMirror 6, add SQL autocomplete (#1893)

* Upgrade to CodeMirror 6
* Update contributing docs
* Change how resizing works
* Define a custom SQLite autocomplete dialect
* Add meta-enter to submit
* Add fixture schema for testing",6f610e1d94b7b8ec605b5b7fcb01537f6adf9c5b,False,datasette/static/cm-editor-6.0.1.bundle.js;datasette/static/cm-editor-6.0.1.js;datasette/static/cm-resize-1.0.1.min.js;datasette/static/codemirror-5.57.0-sql.min.js;datasette/static/codemirror-5.57.0.min.css;datasette/static/codemirror-5.57.0.min.js;datasette/templates/_codemirror.html;datasette/templates/_codemirror_foot.html;docs/contributing.rst;package-lock.json;package.json
b470ab5c4131bd8c10417316ae93bc361115725a,"Fix for datalist against foreign key facets

Refs https://github.com/simonw/datasette/issues/1890#issuecomment-1314850524",df2cc923c6329ec07cd7bb98fedb76c6e7b60567,False,datasette/static/table.js;datasette/templates/_facet_results.html
710be684b8802095474772894a8de0c1a147feb0,"Upgrade to CodeMirror 6, add SQL autocomplete (#1893)

* Upgrade to CodeMirror 6
* Update contributing docs
* Change how resizing works
* Define a custom SQLite autocomplete dialect
* Add meta-enter to submit
* Add fixture schema for testing",b35522c6dd8a1609b0159772a81db3b6a1e6be63,False,datasette/static/cm-editor-6.0.1.bundle.js;datasette/static/cm-editor-6.0.1.js;datasette/static/cm-resize-1.0.1.min.js;datasette/static/codemirror-5.57.0-sql.min.js;datasette/static/codemirror-5.57.0.min.css;datasette/static/codemirror-5.57.0.min.js;datasette/templates/_codemirror.html;datasette/templates/_codemirror_foot.html;docs/contributing.rst;package-lock.json;package.json
4a0bd960e9763623dae6a13c8af3810c4ce9fb0a,Pin pkginfo==1.8.3 as workaround for #1913,07aad511769da9242260c850e8d975cbd8c29552,False,.github/workflows/publish.yml
7588d27f4a5a8325587f47c01d5f154c6a582a1a,"latest.datasette.io uses datasette-ephemeral-tables>=0.2

To show the countdown timer from:
https://github.com/simonw/datasette-ephemeral-tables/issues/3

Refs #1915",53a8e5bae5421da80c6ab15b7fa139645297adca,False,.github/workflows/deploy-latest.yml
9f5321ff1eca58c469a45cc406d7eb5ad05accbd,"latest now uses datasette-ephemeral-tables>=0.2.1

Fix for https://github.com/simonw/datasette-ephemeral-tables/issues/4",7588d27f4a5a8325587f47c01d5f154c6a582a1a,False,.github/workflows/deploy-latest.yml
4ddd77e51254bda3bac990ea662bac2e6b29c5e0,"No need for pkginfo pin any more

The upstream issue was fixed. Refs #1913",8404b21556d133c89eda4bd1bf5335ed9a0785d6,False,.github/workflows/publish.yml
7fde34cfcbcdcfbb5706ec4875340e0d26c5793f,"Documentation and test for UNIQUE constraint failed, refs #1924",9a1536b52a07e32da5900652da1bd7894c58fa9f,False,docs/json_api.rst;tests/test_api_write.py
03f247845e108ab05436c8edeb558f2389ec7995,"datasette-ephemeral-tables>=0.2.2

Refs https://github.com/simonw/datasette-ephemeral-tables/issues/5",e2f71c6f81024354c2d41a4c04108582f2ea5a21,False,.github/workflows/deploy-latest.yml
27efa8c381bc1c9b8b3e6056e7e544ce6bedaedc,"todomvc permissions and fixed DATASETTE_SECRET for new demo

Refs https://github.com/simonw/todomvc-datasette/issues/2",03f247845e108ab05436c8edeb558f2389ec7995,False,.github/workflows/deploy-latest.yml;tests/plugins/my_plugin.py
d7e5e3c9f98d194fdfb12f1ecc60ed5b3afbc464,"Fix for todomvc permission check

Refs https://github.com/simonw/todomvc-datasette/issues/2",27efa8c381bc1c9b8b3e6056e7e544ce6bedaedc,False,tests/plugins/my_plugin.py
9342b60f148e01a6eee491e32d4a946693b49a3d,"test_create_table_error_if_pk_changed, refs #1927",6b27537988ed849682afb9fa3b713dbf33174651,False,datasette/views/database.py;tests/test_api_write.py
dee18ed8ce7af2ab8699bcb5a51a99f48301bc42,"test_create_table_error_rows_twice_with_duplicates, refs #1927",9342b60f148e01a6eee491e32d4a946693b49a3d,False,datasette/views/database.py;tests/test_api_write.py
bffefc7db0c25acb03e3b44ff357d50bb7f04dd7,"Bump furo from 2022.9.29 to 2022.12.7 (#1935)

Bumps [furo](https://github.com/pradyunsg/furo) from 2022.9.29 to 2022.12.7.
- [Release notes](https://github.com/pradyunsg/furo/releases)
- [Changelog](https://github.com/pradyunsg/furo/blob/main/docs/changelog.md)
- [Commits](https://github.com/pradyunsg/furo/compare/2022.09.29...2022.12.07)

---
updated-dependencies:
- dependency-name: furo
  dependency-type: direct:development
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",05daa15aac27bdfb86bd04e97f7544347d398598,False,setup.py
8bf06a76b51bc9ace7cf72cf0cca8f1da7704ea7,"register_permissions() plugin hook (#1940)

* Docs for permissions: in metadata, refs #1636
* Refactor default_permissions.py to help with implementation of #1636
* register_permissions() plugin hook, closes #1939 - also refs #1938
* Tests for register_permissions() hook, refs #1939
* Documentation for datasette.permissions, refs #1939
* permission_allowed() falls back on Permission.default, refs #1939
* Raise StartupError on duplicate permissions
* Allow dupe permisisons if exact matches",e539c1c024bc62d88df91d9107cbe37e7f0fe55f,False,datasette/__init__.py;datasette/app.py;datasette/default_permissions.py;datasette/hookspecs.py;datasette/permissions.py;datasette/views/database.py;datasette/views/index.py;datasette/views/special.py;datasette/views/table.py;docs/authentication.rst;docs/internals.rst;docs/plugin_hooks.rst;docs/plugins.rst;tests/conftest.py;tests/fixtures.py;tests/plugins/my_plugin.py;tests/test_filters.py;tests/test_internals_datasette.py;tests/test_permissions.py;tests/test_plugins.py
260fbb598ed6936131fbcbb8e869439c09e90843,"Fix some failing tests, refs #1855",2aa2adaa8beaa89c9508b0709b8ebf15e0c7f3c5,False,tests/test_cli.py;tests/test_permissions.py
d4b98d3924dec625a99236e65b1b169ff957381f,"Bump black from 22.10.0 to 22.12.0 (#1944)

Bumps [black](https://github.com/psf/black) from 22.10.0 to 22.12.0.
- [Release notes](https://github.com/psf/black/releases)
- [Changelog](https://github.com/psf/black/blob/main/CHANGES.md)
- [Commits](https://github.com/psf/black/compare/22.10.0...22.12.0)

---
updated-dependencies:
- dependency-name: black
  dependency-type: direct:development
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",45979eb7239842aba512fc798ff0e772ef42b3da,False,setup.py
f84acae98ed99c3045d6a00e04cc72984cfa68dd,"Return 400 errors for ?_sort errors, closes #1950",d4b98d3924dec625a99236e65b1b169ff957381f,False,datasette/views/table.py;tests/test_table_html.py
d98a8effb10ce8fe04a03eae42baa8a9cb0ca3f7,"UI for restricting permissions on /-/create-token, refs #1947

Also fixes test failures I introduced in #1951",fdf7c27b5438f02153c3a7f8ad1b320e4b29e4f4,False,datasette/app.py;datasette/templates/create_token.html;datasette/views/special.py;tests/test_auth.py
8b9d7fdbd8de7e74414cc29e3005382669a812dc,"Fixed typo in release notes, refs #1953",8cac6ff3017b86ea1e9dd3b06962302a6ce74f4d,False,docs/changelog.rst
d94d363ec079e2b5f18631a075bffdd5c68eb4da,"Don't use pytest_asyncio.fixture(scope=""session"") any more, refs #1959

Also got rid of the weird memory=False hack:

https://github.com/simonw/datasette/pull/1960#issuecomment-1354053151",95900b9d02c01de46dc510693ab3b316988bf64c,False,datasette/app.py;tests/conftest.py;tests/plugins/my_plugin_2.py
1335bcb8939e903a4a7680493624055faecc3da4,"Use my own global variable instead of scope=session

Refs https://github.com/simonw/datasette/pull/1960#issuecomment-1354148139",ebd3358e4901b07bf66727cb69e46672133ac6eb,False,tests/conftest.py
0e42444866fc6e2d45b77471badda2524e95d412,"invoke_startup() inside ds_client fixture, refs #1959",e70974a4f1d397be7c39c46ba710caa731e8e354,False,tests/conftest.py
9c43b4164db4f60a0be912cfdb07ef8c58b36b22,"Removed @pytest.mark.ds_client mark - refs #1959

I don't need it - can run 'pytest -k ds_client' instead.

See https://github.com/simonw/datasette/pull/1960#issuecomment-1355685828",0e42444866fc6e2d45b77471badda2524e95d412,False,pytest.ini;tests/test_api.py;tests/test_auth.py;tests/test_canned_queries.py;tests/test_csv.py;tests/test_facets.py;tests/test_filters.py;tests/test_html.py;tests/test_internal_db.py;tests/test_messages.py;tests/test_permissions.py;tests/test_plugins.py;tests/test_table_api.py;tests/test_table_html.py
89cffcf14cda830871c8ee81742eaa1e2dff017b,"Reset _metadata_local in a couple of tests

Refs https://github.com/simonw/datasette/pull/1960#issuecomment-1356476886",9c43b4164db4f60a0be912cfdb07ef8c58b36b22,False,tests/test_facets.py;tests/test_plugins.py
d1d369456a7319b9de39175605568cbc9b852478,"Move HTTPS test to a bash script

See https://github.com/simonw/datasette/issues/1955#issuecomment-1356627931",8b73fc6b47dffd8836f5c58aae1e57c1f66a5754,False,tests/conftest.py;tests/test_cli_serve_server.py;tests/test_datasette_https_server.sh
a27c0a01240c5857626eff21e79b9b38e7a3ac99,"Deploy docs on publish using Python 3.9

A workaround for gcloud setup, see:

https://til.simonwillison.net/googlecloud/gcloud-error-workaround

Refs #1963",0ea139dfe59b5c02a119c2d16ad5784b1644c42f,False,.github/workflows/publish.yml
e03aed00026cc2e59c09ca41f69a247e1a85cc89,"Detect server start/stop more reliably.

This is useful, especially in testing, since your test
hosts might not reliabliy start the server within two
seconds, so we do a definite check before progressing.

By the same token, after `kill $server_pid` wait for
the pid to be gone from the process list.

Since now the script can end prematurely, I also added
a cleanup function to make sure the temporary certs are
removed in any case.

n.b. this could also be done with the use of `trap 'fn'
ERR` but that felt like a bit too much magic for this
short a script.",a21c00b54dd6e0ecb17c60024fb1b55729c5d21e,False,tests/test_datasette_https_server.sh
677ba9ddddc8ca1c2f79e9697b8d500e002c6ea5,Fix rST warning in changelog,e03aed00026cc2e59c09ca41f69a247e1a85cc89,False,docs/changelog.rst
8059c8a27c9a5dd18e29e8cb54bb9290ffd77d67,Fixed typo,8aa9cf629c888a8c117216fd243166981d7b4e06,False,docs/json_api.rst
3af313e165215696af899e772f47bf7c27873ae3,"Fix for Sphinx extlinks warning, closes #1972",994ce46ed4a5d680bee58242efd95181946c25e9,False,docs/conf.py
a2dca62360ad4a961d4c46f68eae41b7d5c7b2c9,"Fix for extension tests I broke, refs #782",ca07fff3e253e4ee4c7f05df4c05046243c489e3,False,tests/test_load_extensions.py
deb5fcbed473df82fca86d3a112192091599d2e3,Fixed table_action example in docs,572bdb5b8095bbdc5ec2aa95400055e49ea028cb,False,docs/plugin_hooks.rst
adfcec51d6ad4bb3c8f7f0592f481f3ab5d4e663,Fixed broken example links in _where= docs,deb5fcbed473df82fca86d3a112192091599d2e3,False,docs/json_api.rst
7b48664d751e59222c01c97a2739d53d6363bdda,"Better error for --load-extensions, refs #1979",0f7c71a86f8963740eb3cf51efa0c521e62cb591,False,datasette/cli.py
7dd671310a4358e74663325336583746413f0993,"Release notes for 0.64, with a warning against arbitrary SQL with SpatiaLite

Refs #1409, #1771, #1979

Refs https://github.com/simonw/datasette.io/issues/132",5e672df168ea583160225754667fa06fc76f2fc3,False,docs/changelog.rst;docs/spatialite.rst
4880638f13c3a1abc53f395cde39ac848daf416d,"setup-gcloud 318.0.0

Refs https://til.simonwillison.net/googlecloud/gcloud-error-workaround",7dd671310a4358e74663325336583746413f0993,False,.github/workflows/publish.yml
50fd94e04fea12e9b3e415e4652f7aafe1c74cc1,"Raise ValueError if Datasette(files=) is a string, refs #1985",2c86774179765771a8d982974b64408143cd264b,False,datasette/app.py;tests/test_internals_datasette.py
e4ebef082de90db4e1b8527abc0d582b7ae0bc9d,Fixed link text,6a352e99ab988dbf8fd22a100049caa6ad33f1ec,False,docs/authentication.rst
848a9a420de9b50a7c862db7fb34d930835bee89,"Bump furo from 2022.12.7 to 2023.3.27 (#2046)

Bumps [furo](https://github.com/pradyunsg/furo) from 2022.12.7 to 2023.3.27.
- [Release notes](https://github.com/pradyunsg/furo/releases)
- [Changelog](https://github.com/pradyunsg/furo/blob/main/docs/changelog.md)
- [Commits](https://github.com/pradyunsg/furo/compare/2022.12.07...2023.03.27)

---
updated-dependencies:
- dependency-name: furo
  dependency-type: direct:development
  update-type: version-update:semver-major
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",651b78d8e6e0183a29e8cef0862b286ee6b048b7,False,setup.py
d52402447ea5eb5a3f084e4f85a45675d34eb4da,"Bump sphinx from 6.1.2 to 6.1.3 (#1986)

Bumps [sphinx](https://github.com/sphinx-doc/sphinx) from 6.1.2 to 6.1.3.
- [Release notes](https://github.com/sphinx-doc/sphinx/releases)
- [Changelog](https://github.com/sphinx-doc/sphinx/blob/master/CHANGES)
- [Commits](https://github.com/sphinx-doc/sphinx/compare/v6.1.2...v6.1.3)

---
updated-dependencies:
- dependency-name: sphinx
  dependency-type: direct:development
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",848a9a420de9b50a7c862db7fb34d930835bee89,False,setup.py
bbd5489dbc440c67c69396e7f752584a32d2cfbe,"Bump blacken-docs from 1.12.1 to 1.13.0 (#1992)

Bumps [blacken-docs](https://github.com/asottile/blacken-docs) from 1.12.1 to 1.13.0.
- [Release notes](https://github.com/asottile/blacken-docs/releases)
- [Changelog](https://github.com/adamchainz/blacken-docs/blob/main/HISTORY.rst)
- [Commits](https://github.com/asottile/blacken-docs/compare/v1.12.1...1.13.0)

---
updated-dependencies:
- dependency-name: blacken-docs
  dependency-type: direct:development
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",d52402447ea5eb5a3f084e4f85a45675d34eb4da,False,setup.py
30c88e3570ba3febf232c7ad429d7045ea8a9915,"Bump black from 22.12.0 to 23.3.0 (#2047)

Bumps [black](https://github.com/psf/black) from 22.12.0 to 23.3.0.
- [Release notes](https://github.com/psf/black/releases)
- [Changelog](https://github.com/psf/black/blob/main/CHANGES.md)
- [Commits](https://github.com/psf/black/compare/22.12.0...23.3.0)

---
updated-dependencies:
- dependency-name: black
  dependency-type: direct:development
  update-type: version-update:semver-major
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: Simon Willison <swillison@gmail.com>",bbd5489dbc440c67c69396e7f752584a32d2cfbe,False,setup.py
0b0c5cd7a94fe3f151a3e10261b5c84ee64f2f18,"Hopeful fix for Python 3.7 httpx failure, refs #2066",249fcf8e3e2a90e763f41b080c1b9ec8017f5005,False,tests/test_csv.py
d3d16b5ccfe59e069113699838c8bf0956d90661,"Build docs with 3.11 on ReadTheDocs

Inspired by https://github.com/simonw/sqlite-utils/issues/540",55c526a5373aa41c76a3f052624f92e7add59cc8,False,.readthedocs.yaml
ede62036180993dbd9d4e5d280fc21c183cda1c3,"Bump blacken-docs from 1.13.0 to 1.14.0 (#2083)

Bumps [blacken-docs](https://github.com/asottile/blacken-docs) from 1.13.0 to 1.14.0.
- [Changelog](https://github.com/adamchainz/blacken-docs/blob/main/CHANGELOG.rst)
- [Commits](https://github.com/asottile/blacken-docs/compare/1.13.0...1.14.0)

---
updated-dependencies:
- dependency-name: blacken-docs
  dependency-type: direct:development
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",d1d78ec0ebe34463eb643ac1eae1dee4c62a2031,False,setup.py
99ba05118891db9dc30f1dca22ad6709775560de,"Fixed spelling error, refs #2089

Also ensure codespell runs as part of just lint",84b32b447ae93d4d9cc589f568af16fa519b8863,False,Justfile;docs/metadata.rst
c39d600aef5c085e891917db04fc97511d2e2259,"Fix all E741 Ambiguous variable name warnings, refs #2090",99ba05118891db9dc30f1dca22ad6709775560de,False,tests/test_plugins.py;tests/test_table_html.py
50a6355c081a79c63625d96d3d350603298da42b,"Workaround to get sphinx-build working again, refs 1153",c076fb65e07a7957b8a45804dc8d8cb92020f0ec,False,.github/workflows/deploy-latest.yml;.github/workflows/publish.yml;docs/conf.py
0f7192b6154edb576c41b55bd3f2a3f53e5f436a,"One last YAML/JSON change, closes #1153",42ca574720cca4c1451a3cbf0e1aa85df174153f,False,docs/writing_plugins.rst
3a51ca901427ac93b0ed0638fd1f82fb647a299a,"Bump black from 23.3.0 to 23.7.0 (#2099)

Bumps [black](https://github.com/psf/black) from 23.3.0 to 23.7.0.
- [Release notes](https://github.com/psf/black/releases)
- [Changelog](https://github.com/psf/black/blob/main/CHANGES.md)
- [Commits](https://github.com/psf/black/compare/23.3.0...23.7.0)

---
updated-dependencies:
- dependency-name: black
  dependency-type: direct:development
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",0f7192b6154edb576c41b55bd3f2a3f53e5f436a,False,setup.py
08181823990a71ffa5a1b57b37259198eaa43e06,"Update cli-reference for editable change, refs #2106",18dd88ee4d78fe9d760e9da96028ae06d938a85c,False,docs/cli-reference.rst
5139c0886a7f6bb94d317ba0665aa6e728716028,"Bump the python-packages group with 3 updates (#2128)

Bumps the python-packages group with 3 updates: [sphinx](https://github.com/sphinx-doc/sphinx), [furo](https://github.com/pradyunsg/furo) and [blacken-docs](https://github.com/asottile/blacken-docs).

Updates `sphinx` from 6.1.3 to 7.1.2
- [Release notes](https://github.com/sphinx-doc/sphinx/releases)
- [Changelog](https://github.com/sphinx-doc/sphinx/blob/master/CHANGES)
- [Commits](https://github.com/sphinx-doc/sphinx/compare/v6.1.3...v7.1.2)

Updates `furo` from 2023.3.27 to 2023.7.26
- [Release notes](https://github.com/pradyunsg/furo/releases)
- [Changelog](https://github.com/pradyunsg/furo/blob/main/docs/changelog.md)
- [Commits](https://github.com/pradyunsg/furo/compare/2023.03.27...2023.07.26)

Updates `blacken-docs` from 1.14.0 to 1.15.0
- [Changelog](https://github.com/adamchainz/blacken-docs/blob/main/CHANGELOG.rst)
- [Commits](https://github.com/asottile/blacken-docs/compare/1.14.0...1.15.0)

---
updated-dependencies:
- dependency-name: sphinx
  dependency-type: direct:development
  update-type: version-update:semver-major
  dependency-group: python-packages
- dependency-name: furo
  dependency-type: direct:development
  update-type: version-update:semver-minor
  dependency-group: python-packages
- dependency-name: blacken-docs
  dependency-type: direct:development
  update-type: version-update:semver-minor
  dependency-group: python-packages
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",adf54f5c808c16e9ad812c3a4376f35cf829a93c,False,setup.py
1377a290cd85ba8d3338b1da47c4665ed4c6c625,"New JSON design for query views (#2118)

* Refs #2111, closes #2110
* New Context dataclass/subclass mechanism, refs #2127
* Define QueryContext and extract get_tables() method, refs #2127
* Fix OPTIONS bug by porting DaatbaseView to be a View subclass
* Expose async_view_for_class.view_class for test_routes test
* Error/truncated aruments for renderers, closes #2130",5139c0886a7f6bb94d317ba0665aa6e728716028,False,datasette/__init__.py;datasette/app.py;datasette/renderer.py;datasette/views/__init__.py;datasette/views/base.py;datasette/views/database.py;datasette/views/table.py;docs/plugin_hooks.rst;tests/test_api.py;tests/test_cli_serve_get.py;tests/test_html.py;tests/test_internals_datasette.py;tests/test_messages.py;tests/test_plugins.py;tests/test_table_api.py
8920d425f4d417cfd998b61016c5ff3530cd34e1,"1.0a3 release notes, smaller changes section - refs #2135",26be9f0445b753fb84c802c356b0791a72269f25,False,docs/changelog.rst
90cb9ca58d910f49e8f117bbdd94df6f0855cf99,"JSON changes in release notes, refs #2135",856ca68d94708c6e94673cb6bc28bf3e3ca17845,False,docs/changelog.rst
4535568f2ce907af646304d0ebce2500ebd55677,"Fixed display of database color

Closes #2139, closes #2119",33251d04e78d575cca62bb59069bb43a7d924746,False,datasette/database.py;datasette/templates/database.html;datasette/templates/query.html;datasette/templates/row.html;datasette/templates/table.html;datasette/views/base.py;datasette/views/database.py;datasette/views/index.py;datasette/views/row.py;datasette/views/table.py;tests/test_html.py
943df09dcca93c3b9861b8c96277a01320db8662,"Remove all remaining ""$ "" prefixes from docs, closes #2140

Also document sqlite-utils create-view",4535568f2ce907af646304d0ebce2500ebd55677,False,docs/authentication.rst;docs/changelog.rst;docs/cli-reference.rst;docs/contributing.rst;docs/custom_templates.rst;docs/deploying.rst;docs/facets.rst;docs/full_text_search.rst;docs/installation.rst;docs/plugin_hooks.rst;docs/publish.rst;docs/settings.rst;docs/spatialite.rst;docs/sql_queries.rst
d9aad1fd042a25d226f2ace1f7827b4602761038,"-s/--setting x y gets merged into datasette.yml, refs #2143, #2156

This change updates the `-s/--setting` option to `datasette serve` to allow it to be used to set arbitrarily complex nested settings in a way that is compatible with the new `-c datasette.yml` work happening in:
- #2143

It will enable things like this:
```
datasette data.db --setting plugins.datasette-ripgrep.path ""/home/simon/code""
```
For the moment though it just affects [settings](https://docs.datasette.io/en/1.0a4/settings.html) - so you can do this:
```
datasette data.db --setting settings.sql_time_limit_ms 3500
```
I've also implemented a backwards compatibility mechanism, so if you use it this way (the old way):
```
datasette data.db --setting sql_time_limit_ms 3500
```
It will notice that the setting you passed is one of Datasette's core settings, and will treat that as if you said `settings.sql_time_limit_ms` instead.",527cec66b0403e689c8fb71fc8b381a1d7a46516,False,datasette/cli.py;docs/cli-reference.rst;tests/test_cli.py
d28f12092dd795f35e9500154711d542f8931676,"Bump sphinx, furo, blacken-docs dependencies (#2160)

* Bump the python-packages group with 3 updates

Bumps the python-packages group with 3 updates: [sphinx](https://github.com/sphinx-doc/sphinx), [furo](https://github.com/pradyunsg/furo) and [blacken-docs](https://github.com/asottile/blacken-docs).


Updates `sphinx` from 7.1.2 to 7.2.4
- [Release notes](https://github.com/sphinx-doc/sphinx/releases)
- [Changelog](https://github.com/sphinx-doc/sphinx/blob/master/CHANGES)
- [Commits](https://github.com/sphinx-doc/sphinx/compare/v7.1.2...v7.2.4)

Updates `furo` from 2023.7.26 to 2023.8.19
- [Release notes](https://github.com/pradyunsg/furo/releases)
- [Changelog](https://github.com/pradyunsg/furo/blob/main/docs/changelog.md)
- [Commits](https://github.com/pradyunsg/furo/compare/2023.07.26...2023.08.19)

Updates `blacken-docs` from 1.15.0 to 1.16.0
- [Changelog](https://github.com/adamchainz/blacken-docs/blob/main/CHANGELOG.rst)
- [Commits](https://github.com/asottile/blacken-docs/compare/1.15.0...1.16.0)

---
updated-dependencies:
- dependency-name: sphinx
  dependency-type: direct:development
  update-type: version-update:semver-minor
  dependency-group: python-packages
- dependency-name: furo
  dependency-type: direct:development
  update-type: version-update:semver-minor
  dependency-group: python-packages
- dependency-name: blacken-docs
  dependency-type: direct:development
  update-type: version-update:semver-minor
  dependency-group: python-packages
...

Signed-off-by: dependabot[bot] <support@github.com>

---------

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: Simon Willison <swillison@gmail.com>",2e2825869fc2655b5fcadc743f6f9dec7a49bc65,False,.github/workflows/deploy-latest.yml;.github/workflows/spellcheck.yml;.github/workflows/test.yml;setup.py
2caa53a52a37e53f83e3a854fc721c7e26c5e9ff,ReST fix,6bfe104d47b888c70bfb7781f8f48ff11452b2b5,False,docs/internals.rst
4c3ef033110407f3b3dbce501659d523724985e0,Another ReST fix,2caa53a52a37e53f83e3a854fc721c7e26c5e9ff,False,docs/internals.rst
9cead33fb9c8704996181f1ab67c7376dee97f15,"OperationalError: database table is locked fix

See also:
- https://til.simonwillison.net/datasette/remember-to-commit",4c3ef033110407f3b3dbce501659d523724985e0,False,docs/internals.rst
05707aa16b5c6c39fbe48b3176b85a8ffe493938,"click-default-group>=1.2.3 (#2173)

* click-default-group>=1.2.3

Now available as a wheel:
- https://github.com/click-contrib/click-default-group/issues/21

* Fix for blacken-docs",31d5c4ec05e27165283f0f0004c32227d8b78df8,False,docs/writing_plugins.rst;setup.py
e4abae3fd7a828625d00c35c316852ffbaa5ef2f,"Bump Sphinx (#2166)

Bumps the python-packages group with 1 update: [sphinx](https://github.com/sphinx-doc/sphinx).

- [Release notes](https://github.com/sphinx-doc/sphinx/releases)
- [Changelog](https://github.com/sphinx-doc/sphinx/blob/master/CHANGES)
- [Commits](https://github.com/sphinx-doc/sphinx/compare/v7.2.4...v7.2.5)

---
updated-dependencies:
- dependency-name: sphinx
  dependency-type: direct:development
  update-type: version-update:semver-patch
  dependency-group: python-packages
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",e86eaaa4f371512689e973c18879298dab51f80a,False,setup.py
2200abfa17f72b1cb741a36b44dc40a04b8ea001,"Fix for flaky test_hidden_sqlite_stat1_table, closes #2179",fbcb103c0cb6668018ace539a01a6a1f156e8d6a,False,tests/test_api.py
f56e043747bde4faa1d78588636df6c0dadebc65,"test_facet_against_in_memory_database, refs #2189

This is meant to illustrate a crashing bug but it does not trigger it.",852f5014853943fa27f43ddaa2d442545b3259fb,False,tests/test_facets.py
6ed7908580fa2ba9297c3225d85c56f8b08b9937,"Simplified test for #2189

This now executes two facets, in the hope that parallel facet execution
would illustrate the bug - but it did not illustrate the bug.",f56e043747bde4faa1d78588636df6c0dadebc65,False,tests/test_facets.py
b0e5d8afa308759f4ee9f3ecdf61101dffc4a037,"Stop using parallel SQL queries for tables

Refs:
- #2189",6ed7908580fa2ba9297c3225d85c56f8b08b9937,False,datasette/views/table.py;docs/internals.rst
6763572948ffd047a89a3bbf7c300e91f51ae98f,"Bump sphinx, furo, black

Bumps the python-packages group with 3 updates: [sphinx](https://github.com/sphinx-doc/sphinx), [furo](https://github.com/pradyunsg/furo) and [black](https://github.com/psf/black).


Updates `sphinx` from 7.2.5 to 7.2.6
- [Release notes](https://github.com/sphinx-doc/sphinx/releases)
- [Changelog](https://github.com/sphinx-doc/sphinx/blob/master/CHANGES.rst)
- [Commits](https://github.com/sphinx-doc/sphinx/compare/v7.2.5...v7.2.6)

Updates `furo` from 2023.8.19 to 2023.9.10
- [Release notes](https://github.com/pradyunsg/furo/releases)
- [Changelog](https://github.com/pradyunsg/furo/blob/main/docs/changelog.md)
- [Commits](https://github.com/pradyunsg/furo/compare/2023.08.19...2023.09.10)

Updates `black` from 23.7.0 to 23.9.1
- [Release notes](https://github.com/psf/black/releases)
- [Changelog](https://github.com/psf/black/blob/main/CHANGES.md)
- [Commits](https://github.com/psf/black/compare/23.7.0...23.9.1)

---
updated-dependencies:
- dependency-name: sphinx
  dependency-type: direct:development
  update-type: version-update:semver-patch
  dependency-group: python-packages
- dependency-name: furo
  dependency-type: direct:development
  update-type: version-update:semver-minor
  dependency-group: python-packages
- dependency-name: black
  dependency-type: direct:development
  update-type: version-update:semver-minor
  dependency-group: python-packages
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",b0e5d8afa308759f4ee9f3ecdf61101dffc4a037,False,setup.py
80a9cd9620fddf2695d12d8386a91e7c6b145ef2,"test-datasette-load-plugins now fails correctly, refs #2193",b0d0a0e5de8bb5b9b6c253e8af451a532266bcf1,False,tests/test-datasette-load-plugins.sh
f130c7c0a88e50cea4121ea18d1f6db2431b6fab,"Deploy with fixtures-metadata.json, refs #2194, #2195",2da1a6acec915b81a16127008fd739c7d6075681,False,.github/workflows/deploy-latest.yml
85a41987c7753c3af92ba6b8b6007211eb46602f,Fixed typo acepts -> accepts,d51e63d3bb3e32f80d1c0f04adff7c1dd5a7b0c0,False,docs/plugin_hooks.rst
3d6d1e3050b8e50fac40ec090672d8a95fa8e06c,"Raise an exception if a ""plugins"" block exists in metadata.json",35deaabcb105903790d18710a26e77545f6852ce,False,datasette/app.py;datasette/cli.py;datasette/utils/__init__.py;tests/test_plugins.py
a4b401f470b8dd261e73ceb35970f39dd60a3947,"Updated Discord link, refs #2196

This issue reminded me to use the datasette.io/discord redirect URL.",3d6d1e3050b8e50fac40ec090672d8a95fa8e06c,False,README.md;docs/changelog.rst;docs/index.rst
11f7fd38a4aea01c8c75b85105b4a52989ea488a,Fixed some rST header warnings,a4b401f470b8dd261e73ceb35970f39dd60a3947,False,docs/configuration.rst;docs/metadata.rst
067cc75dfa01612f9a47815b33804361e18bf5c3,Fixed broken example links in row page documentation,452a587e236ef642cbc6ae345b58767ea8420cb5,False,docs/pages.rst
89c8ca0f3ff51fcbf5f710c529bc7a3552da0731,"Fix for round_trip_load() YAML error, refs #2219",067cc75dfa01612f9a47815b33804361e18bf5c3,False,docs/metadata_doc.py
872dae1e1a1511e2edfb9d7ddf6ea5096c11d5c3,"Fix for CSV labels=on missing foreign key bug, closes #2214",978249beda1a3e7185f61000b0dd57018541c511,False,datasette/views/base.py;tests/test_csv.py
0b2c6a7ebd4fd540d9bdfb169c621452d280e608,"Fix for ?_extra=columns bug, closes #2230

Also refs #262 - started a test suite for extras.",1fc76fee6268c21003c0fe730cc8e93210ce6bb8,False,datasette/renderer.py;tests/test_table_api.py
0f63cb83ed31753a9bd9ec5cc71de16906767337,Typo fix,7506a89be0d1c97632bed47635eb90f92815d6c7,False,docs/testing_plugins.rst
a25bf6bea789c409580386f77b7440ff525d09b2,"fmt: off to fix problem with Black, closes #2231",0f63cb83ed31753a9bd9ec5cc71de16906767337,False,tests/test_docs.py
7a5adb592ae6674a2058639c66e85eb1b49448fb,"Docs on temporary plugins in fixtures, closes #2234",a25bf6bea789c409580386f77b7440ff525d09b2,False,docs/testing_plugins.rst;tests/test_docs_plugins.py
890615b3f29dcf82a792f1a145b02dba784a5b63,"Bump the python-packages group with 1 update (#2241)

Bumps the python-packages group with 1 update: [furo](https://github.com/pradyunsg/furo).


Updates `furo` from 2023.9.10 to 2024.1.29
- [Release notes](https://github.com/pradyunsg/furo/releases)
- [Changelog](https://github.com/pradyunsg/furo/blob/main/docs/changelog.md)
- [Commits](https://github.com/pradyunsg/furo/compare/2023.09.10...2024.01.29)

---
updated-dependencies:
- dependency-name: furo
  dependency-type: direct:development
  update-type: version-update:semver-major
  dependency-group: python-packages
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",959e0202972f4d95088c4c1a9df6274108af8bfb,False,setup.py
d4bc2b2dfc728017c8f669c1714f20b89655557c,"Remove fail_if_plugins_in_metadata, part of #2248",4da581d09bbed2377682630c147e05d78c48f7e0,False,datasette/app.py;datasette/cli.py;datasette/utils/__init__.py;tests/test_plugins.py
5ea7098e4da5fe8576f6452dbfac86e6aedba397,Fixed an unnecessary f-string,4ea109ac4dd17392c85ca7d5934009f9a9488a9d,False,demos/plugins/example_js_manager_plugins.py
69c6e953231078ab18ba0807e5fe2a4e20e84093,Fixed a bunch of unused imports spotted with ruff,5d21057cf1e4171bc2741d3d8d9da83aee1165b5,False,datasette/cli.py;datasette/forbidden.py;datasette/handle_exception.py;datasette/permissions.py;datasette/url_builder.py;datasette/views/base.py;datasette/views/index.py;ruff.toml;tests/conftest.py;tests/test_black.py;tests/test_cli.py;tests/test_cli_serve_get.py;tests/test_config_dir.py;tests/test_internals_datasette.py;tests/test_plugins.py;tests/test_table_html.py
ad01f9d3217f2447b0a321ee7731900dac7e3e6d,"1.0a8 release notes

Closes #2243

* Changelog for jinja2_environment_from_request and plugin_hook_slots
* track_event() in changelog
* Remove Using YAML for metadata section - no longer necessary now we show YAML and JSON examples everywhere.
* Configuration via the command-line section - #2252
* JavaScript plugins in release notes, refs #2052
* /-/config in changelog, refs #2254

Refs #2052, #2156, #2243, #2247, #2249, #2252, #2254",9ac9f0152f1d3396d01ceddfcaf07fd1cf3f7168,False,docs/changelog.rst
c64453a4a137ea815f4d94a99cdc4c7709734839,"Fix the date on the 1.0a8 release (due to go tomorrow)

Refs #2258",ad01f9d3217f2447b0a321ee7731900dac7e3e6d,False,docs/changelog.rst
d0089ba7769d58b97c5dc1e07969246502d97544,"Note in changelog about datasette publish, refs #2195",c64453a4a137ea815f4d94a99cdc4c7709734839,False,docs/changelog.rst
1e31821d9ff2bc81c62bcd442214e9098cf785a4,Link to events docs from changelog,df8d1c055a48a36693d9caec3915eb93c1acefc0,False,docs/changelog.rst
569aacd39bcc5529b2f463c89c616e3ada21c560,Link to /en/latest/ changelog,9989f257094daaf26e0cb0cebe31f17f19d4cad2,False,README.md
c62cfa6de836667834b5b9a7fef2b861307ac998,Fix upsert test to detect new alter-table event,c954795f9af9007e7c04d9b472bfd2faef647a87,False,tests/test_api_write.py
244f3ff83aac19e96fab85a95ddde349079a9827,Test demonstrating fix for permisisons bug in #2262,8bfa3a51c222d653f45fb48ebcb6957a85f9ea6c,False,tests/test_api_write.py
10f9ba1a0050724ba47a089861606bef58a4087f,"Take advantage of execute_write_fn(transaction=True)

A bunch of places no longer need to do manual transaction handling
thanks to this change. Refs #2277",5e0e440f2c8a0771b761b02801456e55e95e2a04,False,datasette/database.py;datasette/utils/internal_db.py;tests/test_internals_database.py
27409a78929b4baa017cce2cc0ca636603ed6d37,"Fix for hook position in wide column names, refs #2263",392ca2e24cc93a3918d07718f40524857d626d14,False,datasette/static/table.js
26300738e3c6e7ad515bd513063f57249a05000a,"Fixes for permissions debug page, closes #2278",27409a78929b4baa017cce2cc0ca636603ed6d37,False,datasette/templates/permissions_debug.html;datasette/views/special.py;tests/test_permissions.py
158d5d96e9fcc5f15b57a012f4e6afe2e89ee05b,"Bump the python-packages group with 1 update (#2269)

Bumps the python-packages group with 1 update: [black](https://github.com/psf/black).


Updates `black` from 24.1.1 to 24.2.0
- [Release notes](https://github.com/psf/black/releases)
- [Changelog](https://github.com/psf/black/blob/main/CHANGES.md)
- [Commits](https://github.com/psf/black/compare/24.1.1...24.2.0)

---
updated-dependencies:
- dependency-name: black
  dependency-type: direct:development
  update-type: version-update:semver-minor
  dependency-group: python-packages
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",28bf3a933f6cc2ba95f95f83cddf37d2bdaeb1af,False,setup.py
103b4decbd2350a74da09b61bc3b26159b9159a2,"fix (typo): Corrected spelling of 'environments' (#2268)

* fix (typo): Corrected spelling of 'environments'

* ci: add test folder to codespell workflow",158d5d96e9fcc5f15b57a012f4e6afe2e89ee05b,False,.github/workflows/spellcheck.yml;Justfile;docs/codespell-ignore-words.txt;tests/test-datasette-load-plugins.sh
c863443ea11ea9b9f0e264ab38f103691509fab9,"Documentation for derive_named_parameters()

Closes #2284

Refs https://github.com/simonw/datasette-write/issues/7#issuecomment-1967593883",dfd4ad558b74defbe23b01196260b087f9a56813,False,datasette/utils/__init__.py;docs/internals.rst
a395256c8c10f19bb006e0fce8f5eddd2b645757,"Allow-list select * from pragma_table_list()

Refs https://github.com/simonw/datasette/issues/2104#issuecomment-1982352475",090dff542bee7f716088835b3cc633e9e04b985d,False,datasette/utils/__init__.py
8d456aae45914d8ee135cf5cc139948e9092e633,"Fix spelling of displayed, refs #2299",b8711988b903cafaeb0d8b07a7f98d75084f1c2b,False,docs/plugin_hooks.rst
feddd61789983dc75f127956176cac493d877be8,Fix tests I broke in #2302,9cc6f1908f844f683cc946e52671da60b15a1bba,False,datasette/templates/patterns.html;tests/test_auth.py
5af68377256a4aafebef7da98600f0bfd1546644,"Fix httpx warning about app=self.app, refs #2307",8b6f155b45b360a1c649efb24f985d926bb76991,False,datasette/app.py
54f5604cafb4a08ea9e94e12de69e5adae51c42b,"Fixed cookies= httpx warning, refs #2307",5af68377256a4aafebef7da98600f0bfd1546644,False,datasette/app.py
261fc8d875c43d5421a6ee1096992fd636c2c278,Fix datetime.utcnow deprecation warning,eb8545c172b4b12e89dcc08a976f037d881346c4,False,datasette/app.py;datasette/default_magic_parameters.py
67e66f36c1a0e9534d3bc3ea7f5469e886f48e4d,"Add ETag header for static responses (#2306)

* add etag to static responses

* fix RuntimeError related to static headers

* Remove unnecessary import

---------

Co-authored-by: Simon Willison <swillison@gmail.com>",261fc8d875c43d5421a6ee1096992fd636c2c278,False,datasette/utils/__init__.py;datasette/utils/asgi.py;tests/test_html.py;tests/test_utils.py
da686627677b6819264bd787ba7d520edb069d12,"datasette-enrichments is example of row_actions

Refs:
- https://github.com/simonw/datasette/issues/2299
- https://github.com/datasette/datasette-enrichments/issues/41",67e66f36c1a0e9534d3bc3ea7f5469e886f48e4d,False,docs/plugin_hooks.rst
d32176c5b8283fbcc5c8a1f8e6d39339d73013c4,Typo fix triggera -> triggers,19b6a3733664403d944925a6887b38ff313a5570,False,docs/internals.rst
63714cb2b7b15dfa8e10bf017efda03b9b25558d,"Fixed some typos spotted by Gemini Pro 1.5, closes #2318",d32176c5b8283fbcc5c8a1f8e6d39339d73013c4,False,docs/authentication.rst;docs/internals.rst;docs/plugin_hooks.rst
e1bfab3fca22e4f8d06dcf419e945f13fc20aef1,"Move Metadata to `--internal` database

Refs:
- https://github.com/simonw/datasette/pull/2343
- https://github.com/simonw/datasette/issues/2341",8f9509f00cceea8dc87403c28b2056db7b246ed4,False,datasette/app.py;datasette/default_menu_links.py;datasette/facets.py;datasette/hookspecs.py;datasette/renderer.py;datasette/utils/internal_db.py;datasette/views/base.py;datasette/views/database.py;datasette/views/index.py;datasette/views/row.py;datasette/views/table.py;docs/codespell-ignore-words.txt;docs/plugin_hooks.rst;tests/test_api.py;tests/test_cli.py;tests/test_config_dir.py;tests/test_facets.py;tests/test_html.py;tests/test_permissions.py;tests/test_plugins.py;tests/test_routes.py;tests/test_table_html.py
c698d008e08396ca0d288febbb9f656d96db83a9,"Only test first wheel, fixes surprise bug

https://github.com/simonw/datasette/issues/2351#issuecomment-2161211173",e1bfab3fca22e4f8d06dcf419e945f13fc20aef1,False,test-in-pyodide-with-shot-scraper.sh
9a3c3bfcc7d30d65514421bd315f1b8b5b735b86,"Fix for pyodide test failure, refs #2351",c698d008e08396ca0d288febbb9f656d96db83a9,False,test-in-pyodide-with-shot-scraper.sh
2b6bfddafc1f3ad95bbb334e34a026964db4a813,Workaround for #2353,7437d40e5dd4d614bb769e16c0c1b96c6c19647f,False,datasette/utils/__init__.py
45c27603d2b1f3536eccee7bdf20b9626a128bb3,"xfail two flaky tests, #2355, #2356",8f86d2af6a5b90bd0bf12812b4f37c0fbfc1bceb,False,tests/test_api_write.py;tests/test_csv.py
93534fd3d0c34aac9ff5f8677f1a8d8bddf886f9,"Show response.text on test_upsert failure, refs #2356",45c27603d2b1f3536eccee7bdf20b9626a128bb3,False,tests/test_api_write.py
62686114eee429d6f5e6badc4f11076b35c987df,"Do not show database name in Database Not Found error, refs #2359",93534fd3d0c34aac9ff5f8677f1a8d8bddf886f9,False,datasette/app.py;datasette/utils/asgi.py;tests/test_api_write.py
7316dd4ac629d3b0e93a92b07cd6e565e2a66a07,"Fix for TableNotFound, refs #2359",62686114eee429d6f5e6badc4f11076b35c987df,False,datasette/app.py;datasette/utils/asgi.py;tests/test_api_write.py;tests/test_table_api.py;tests/test_table_html.py
263788906aad8d53cb29369983f72a3b861bb4da,"Fix for RowNotFound, refs #2359",7316dd4ac629d3b0e93a92b07cd6e565e2a66a07,False,datasette/app.py;datasette/utils/asgi.py
56adfff8d2112c5890888af4da65d842ba7f6f86,"Bump the python-packages group across 1 directory with 4 updates (#2362)

Bumps the python-packages group with 4 updates in the / directory: [sphinx](https://github.com/sphinx-doc/sphinx), [furo](https://github.com/pradyunsg/furo), [blacken-docs](https://github.com/adamchainz/blacken-docs) and [black](https://github.com/psf/black).


Updates `sphinx` from 7.2.6 to 7.3.7
- [Release notes](https://github.com/sphinx-doc/sphinx/releases)
- [Changelog](https://github.com/sphinx-doc/sphinx/blob/master/CHANGES.rst)
- [Commits](https://github.com/sphinx-doc/sphinx/compare/v7.2.6...v7.3.7)

Updates `furo` from 2024.1.29 to 2024.5.6
- [Release notes](https://github.com/pradyunsg/furo/releases)
- [Changelog](https://github.com/pradyunsg/furo/blob/main/docs/changelog.md)
- [Commits](https://github.com/pradyunsg/furo/compare/2024.01.29...2024.05.06)

Updates `blacken-docs` from 1.16.0 to 1.18.0
- [Changelog](https://github.com/adamchainz/blacken-docs/blob/main/CHANGELOG.rst)
- [Commits](https://github.com/adamchainz/blacken-docs/compare/1.16.0...1.18.0)

Updates `black` from 24.2.0 to 24.4.2
- [Release notes](https://github.com/psf/black/releases)
- [Changelog](https://github.com/psf/black/blob/main/CHANGES.md)
- [Commits](https://github.com/psf/black/compare/24.2.0...24.4.2)

---
updated-dependencies:
- dependency-name: sphinx
  dependency-type: direct:development
  update-type: version-update:semver-minor
  dependency-group: python-packages
- dependency-name: furo
  dependency-type: direct:development
  update-type: version-update:semver-minor
  dependency-group: python-packages
- dependency-name: blacken-docs
  dependency-type: direct:development
  update-type: version-update:semver-minor
  dependency-group: python-packages
- dependency-name: black
  dependency-type: direct:development
  update-type: version-update:semver-minor
  dependency-group: python-packages
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",c2e8e5085b5ccc49121feaf11b57eb7d5af53bd9,False,setup.py
a23c2aee006bea5f50c13e687dac77c66df1888b,"Introduce new `/$DB/-/query` endpoint, soft replaces `/$DB?sql=...` (#2363)

* Introduce new default /$DB/-/query endpoint
* Fix a lot of tests
* Update pyodide test to use query endpoint
* Link to /fixtures/-/query in a few places
* Documentation for QueryView

---------

Co-authored-by: Simon Willison <swillison@gmail.com>",56adfff8d2112c5890888af4da65d842ba7f6f86,False,datasette/app.py;datasette/templates/database.html;datasette/views/database.py;docs/pages.rst;test-in-pyodide-with-shot-scraper.sh;tests/plugins/my_plugin.py;tests/test_api.py;tests/test_api_write.py;tests/test_canned_queries.py;tests/test_cli.py;tests/test_cli_serve_get.py;tests/test_crossdb.py;tests/test_csv.py;tests/test_html.py;tests/test_load_extensions.py;tests/test_messages.py;tests/test_permissions.py;tests/test_plugins.py;tests/test_routes.py;tests/test_table_api.py;tests/test_table_html.py
feccfa2a4dc77e073416090004ed14da61352558,"Bump the python-packages group across 1 directory with 2 updates (#2371)

Bumps the python-packages group with 2 updates in the / directory: [sphinx](https://github.com/sphinx-doc/sphinx) and [furo](https://github.com/pradyunsg/furo).


Updates `sphinx` from 7.3.7 to 7.4.7
- [Release notes](https://github.com/sphinx-doc/sphinx/releases)
- [Changelog](https://github.com/sphinx-doc/sphinx/blob/master/CHANGES.rst)
- [Commits](https://github.com/sphinx-doc/sphinx/compare/v7.3.7...v7.4.7)

Updates `furo` from 2024.5.6 to 2024.7.18
- [Release notes](https://github.com/pradyunsg/furo/releases)
- [Changelog](https://github.com/pradyunsg/furo/blob/main/docs/changelog.md)
- [Commits](https://github.com/pradyunsg/furo/compare/2024.05.06...2024.07.18)

---
updated-dependencies:
- dependency-name: sphinx
  dependency-type: direct:development
  update-type: version-update:semver-minor
  dependency-group: python-packages
- dependency-name: furo
  dependency-type: direct:development
  update-type: version-update:semver-minor
  dependency-group: python-packages
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",2edf45b1b6d521f0d34e7fb9f0a2b85792c707a0,False,setup.py
2ad51baa31bfba7940c739e99d4270f563a77290,"Move /db?sql= redirect to top of changes

Refs #2381",bd7d3bb70f28804e66b487fa5d04cc476ddb650c,False,docs/upgrade_guide.rst
78ce105413b36f43c3a2dc8589444d814196740a,Markup fix,2b0a61ee192c8c0b85a4ddbf9c76b1b6e61e9fc0,False,docs/upgrade_guide.rst
ff710ed7ebb3de1660c68d667a46095771c00548,"Typo fix, refs #2381",5bd6853bf489b32c49d9c610182de603604c4ffd,False,docs/changelog.rst
e9f598609bc0c22c296e62f52041d6032e8e8046,Fix for codespell recipe,ff710ed7ebb3de1660c68d667a46095771c00548,False,Justfile
bf953628bb629d0c287ecb6c93407b29d0239e27,"Fix bug where -s could reset settings to defaults, closes #2389",f6bd2bf8b025dcee49248ae7224e242b448f558c,False,datasette/cli.py;datasette/utils/__init__.py;tests/test_cli.py;tests/test_utils.py
06d4ffb92e768fe7b088bb18281718dd5e42ad18,"Custom error on CSRF failures, closes #2390

Uses https://github.com/simonw/asgi-csrf/issues/28",93067668fe3cba5576fe430c1e547635989ebb9a,False,datasette/app.py;setup.py;tests/test_html.py
160d82f06e670c4d3f780a382faf1e8e7b6263a8,"Bump furo and black (#2385)

Updates `furo` from 2024.7.18 to 2024.8.6
- [Release notes](https://github.com/pradyunsg/furo/releases)
- [Changelog](https://github.com/pradyunsg/furo/blob/main/docs/changelog.md)
- [Commits](https://github.com/pradyunsg/furo/compare/2024.07.18...2024.08.06)

Updates `black` from 24.4.2 to 24.8.0
- [Release notes](https://github.com/psf/black/releases)
- [Changelog](https://github.com/psf/black/blob/main/CHANGES.md)
- [Commits](https://github.com/psf/black/compare/24.4.2...24.8.0)

---
updated-dependencies:

  dependency-group: python-packages
- dependency-name: furo
  dependency-type: direct:development
  update-type: version-update:semver-minor
  dependency-group: python-packages
- dependency-name: black
  dependency-type: direct:development
  update-type: version-update:semver-minor
  dependency-group: python-packages
...

Signed-off-by: dependabot[bot] <support@github.com>

* Pin Sphinx==7.4.7

---------

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>
Co-authored-by: Simon Willison <swillison@gmail.com>",492378c2a081fedabc1e2fd26bcc0b4ed50f2f83,False,setup.py
05dfd34fd0dff34b64fb47e0dd1716c8bdbddfac,"Use text/html for CSRF error page, refs #2390",160d82f06e670c4d3f780a382faf1e8e7b6263a8,False,datasette/app.py;tests/test_html.py
9cb5700d605b8c72930c8bce8b3eaa8a0763cca6,"bugfix: correctly detect json1 in versions.json (#2327)

Fixes #2326",6d91d082e0a7b1a275fe72549c7e132382986342,False,datasette/app.py;tests/test_api.py
d444b6aad568e3743199b44d4ae978f5a9ce36a4,"Fix for spacing on index page, closes #2399",7d8dd2ac7fbbc53f484e8d383ac7f3656b28aa86,False,datasette/templates/index.html
1f3fb5f96b3f6e773b8c1b8ec5d8f7516c6860b0,"debugger: load 'ipdb' if present

* debugger: load 'ipdb' if present

Transparently chooses between the IPython-enhanced 'ipdb' or the
standard 'pdb'.

* datasette install ipdb

---------

Co-authored-by: Simon Willison <swillison@gmail.com>",4efcc29d02d594106e8e9f5206aa5a740b45eccb,False,datasette/handle_exception.py;docs/contributing.rst
34a6b2ac844a0784fae1f36e0243336a48413594,"Fixed bug with ?_trace=1 and large responses, closes #2404",9028d7f80527b696330805ef7921de14ab40b129,False,datasette/tracer.py;datasette/utils/testing.py;tests/test_tracer.py
8a63cdccc7744e6c6969edf47f7c519bf4c25fa6,"Tracer now catches errors, closes #2405",34a6b2ac844a0784fae1f36e0243336a48413594,False,datasette/database.py;datasette/tracer.py;tests/test_tracer.py
bc46066f9d96550286ac7694f18f44c8169a83a7,"Fix huge performance bug in DateFacet, refs #2407",f28ff8e4f0eb89bb67a6d8336e4a3e2655f3b983,False,datasette/facets.py
dc1d15247647c350ac73ad520229467180b8433c,"Stop counting at 10,000 rows when listing tables, refs #2398",bc46066f9d96550286ac7694f18f44c8169a83a7,False,datasette/database.py;datasette/templates/database.html;datasette/views/database.py
dc288056b81a3635bdb02a6d0121887db2720e5e,"Better handling of errors for count all button, refs #2408",9ecce07b083824f56bd96966a1f63e18d44489b1,False,datasette/templates/table.html
7077b8b1ba3bb137d6975f16c27b15846ac7db8a,"Changelog for 0.65.1, refs #2443",e85517dab3172b82e385e2a366f97a7cd8787e30,False,docs/changelog.rst
1902735c631c4ad1bc6aca9031b1be2b603cfee3,docs: fix time travel bug via `changelog.rst` (#2449),72f8ac680aab220efbc10fc7cc24d9040869e1a1,False,docs/changelog.rst
34390bbed8b31d2e47c806d75ed070d333ec281a,"Fix for params metadata error, closes #2455",1902735c631c4ad1bc6aca9031b1be2b603cfee3,False,datasette/app.py
d48e5ae0ce33d44f2b574cab38acac2393bfdf9f,"Bump rollup from 3.3.0 to 3.29.5 (#2432)

Bumps [rollup](https://github.com/rollup/rollup) from 3.3.0 to 3.29.5.
- [Release notes](https://github.com/rollup/rollup/releases)
- [Changelog](https://github.com/rollup/rollup/blob/master/CHANGELOG.md)
- [Commits](https://github.com/rollup/rollup/compare/v3.3.0...v3.29.5)

---
updated-dependencies:
- dependency-name: rollup
  dependency-type: direct:production
...

Signed-off-by: dependabot[bot] <support@github.com>
Co-authored-by: dependabot[bot] <49699333+dependabot[bot]@users.noreply.github.com>",b190b87ec6897872ad3111ec694219cb9de98579,False,package-lock.json;package.json
b9047d812a5107490d85b91e6c329c48074a57c8,"Skip the serial marked tests in pytest coverage

Refs https://github.com/simonw/datasette/issues/2461#issuecomment-2634896235",9e41d19f7382aea3cf2abc3ac1ee6ae57599c6f4,False,.github/workflows/test-coverage.yml
962da77d616f82da6c6077a348246883cc51ad11,"Try the event_loop fixture (#2463)

Refs https://github.com/simonw/datasette/issues/2461#issuecomment-2634920351",b9047d812a5107490d85b91e6c329c48074a57c8,False,tests/test_auth.py;tests/test_permissions.py
53a3b3c80e64fa3733196b1478e4a4fc60b08fd4,"Test improvements and fixed deprecation warnings (#2464)

* `asyncio_default_fixture_loop_scope = function`
* Fix a bunch of BeautifulSoup deprecation warnings
* Fix for PytestUnraisableExceptionWarning: Exception ignored in: <_io.FileIO [closed]>
* xfail for sql_time_limit tests (these can be flaky in CI)

Refs #2461",962da77d616f82da6c6077a348246883cc51ad11,False,.github/workflows/test-coverage.yml;datasette/utils/__init__.py;pytest.ini;tests/test_api.py;tests/test_black.py;tests/test_cli.py;tests/test_html.py;tests/test_permissions.py;tests/test_plugins.py;tests/test_table_html.py;tests/utils.py
f95ac19e7116335b8c87a2d75fde63f6cfdc7c3a,"Fix to support replacing a database, closes #2465",53a3b3c80e64fa3733196b1478e4a4fc60b08fd4,False,datasette/database.py;tests/test_internals_database.py
7f23411002b3d94e8adfec794c922fcc8830fa5b,"Call db.close() in ds.remove_database()

https://github.com/simonw/datasette/issues/2465#issuecomment-2640712713",f95ac19e7116335b8c87a2d75fde63f6cfdc7c3a,False,datasette/app.py
e59fd0175708f2b14d4e3c08ea16631bda0aaed3,"Fix for incorrect REFERENCES in internal DB

Refs #2466",cd9182a5511d2a2433d519784c77c5711d1fd58a,False,datasette/utils/internal_db.py;docs/internals.rst;tests/test_internal_db.py
d021ce97aa60c48441bad7a976112b2bb11f6ccd,"Note that only first actor_from_request value is respected

https://github.com/datasette/datasette-profiles/issues/4#issuecomment-2758588167",7945f4fbf2fac201f6aac8f5a84c10e0777fea82,False,docs/plugin_hooks.rst
d5c6e502fbdaacd9143ce160c319066488b5d6be,"fix: tilde encode database name in expanded foreign key links (#2476)

* Tilde encode database for expanded foreign key links
* Test for foreign key fix in #2476

---------

Co-authored-by: Simon Willison <swillison@gmail.com>",f2485dce9cf5644d8c35cb697257d055a2b32bc2,False,datasette/views/table.py;tests/test_table_html.py
f4274e7a2e22660c02b205aae3a812a9bc281bf2,"CSS fix for table headings on mobile, closes #2479",271aa09056eb4f7cbfafb8c5f2e8df4c103ff413,False,datasette/static/app.css
1c77a7e33f7902d3115ace6fbd6297391b9bc640,"Fix global-power-points references

Refs https://github.com/simonw/datasette.io/issues/167",6f7f4c7d89b37187667441ce9df583f6dbbe2977,False,README.md;docs/getting_started.rst;docs/pages.rst
7a602140df3646820adc45963daf7fc5dcd2a009,"catalog_views table, closes #2495

Refs https://github.com/datasette/datasette-queries/issues/1#issuecomment-3074491003",e2497fdb595055a63f2c9b7b522e76d501be224c,False,datasette/utils/internal_db.py;docs/internals.rst;tests/test_internal_db.py
